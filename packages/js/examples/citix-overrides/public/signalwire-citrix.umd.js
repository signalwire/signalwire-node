(function(fe){typeof define=="function"&&define.amd?define(fe):fe()})(function(){"use strict";var fe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_e={exports:{}},me=_e.exports,he;function ge(){return he||(he=1,function(ve,Re){var P={scope:{},getGlobal:function(M){return typeof window<"u"&&window===M?M:typeof fe<"u"?fe:M}};P.global=P.getGlobal(me),P.initSymbol=function(){P.global.Symbol||(P.global.Symbol=P.Symbol),P.initSymbol=function(){}},P.symbolCounter_=0,P.Symbol=function(M){return"jscomp_symbol_"+M+P.symbolCounter_++},P.initSymbolIterator=function(){P.initSymbol(),P.global.Symbol.iterator||(P.global.Symbol.iterator=P.global.Symbol("iterator")),P.initSymbolIterator=function(){}},P.makeIterator=function(M){if(P.initSymbolIterator(),M[P.global.Symbol.iterator])return M[P.global.Symbol.iterator]();var W=0;return{next:function(){return W==M.length?{done:!0}:{done:!1,value:M[W++]}}}},P.arrayFromIterator=function(M){for(var W,J=[];!(W=M.next()).done;)J.push(W.value);return J},P.arrayFromIterable=function(M){return M instanceof Array?M:P.arrayFromIterator(P.makeIterator(M))},P.inherits=function(M,W){function J(){}J.prototype=W.prototype,M.prototype=new J,M.prototype.constructor=M;for(var f in W)if(P.global.Object.defineProperties){var e=P.global.Object.getOwnPropertyDescriptor(W,f);e&&P.global.Object.defineProperty(M,f,e)}else M[f]=W[f]},P.array=P.array||{},P.array.done_=function(){return{done:!0,value:void 0}},P.array.arrayIterator_=function(M,W){M instanceof String&&(M=String(M));var J=0;P.initSymbol(),P.initSymbolIterator();var f={},e=(f.next=function(){if(J<M.length){var p=J++;return{value:W(p,M[p]),done:!1}}return e.next=P.array.done_,P.array.done_()},f[Symbol.iterator]=function(){return e},f);return e},P.array.findInternal_=function(M,W,J){M instanceof String&&(M=String(M));for(var f=M.length,e=0;e<f;e++){var p=M[e];if(W.call(J,p,e,M))return{i:e,v:p}}return{i:-1,v:void 0}},P.array.from=function(M,W,J){W=W===void 0?function(V){return V}:W;var f=[];if(P.initSymbol(),P.initSymbolIterator(),M[Symbol.iterator]){P.initSymbol(),P.initSymbolIterator(),M=M[Symbol.iterator]();for(var e;!(e=M.next()).done;)f.push(W.call(J,e.value))}else{e=M.length;for(var p=0;p<e;p++)f.push(W.call(J,M[p]))}return f},P.array.of=function(M){for(var W=[],J=0;J<arguments.length;++J)W[J-0]=arguments[J];return P.array.from(W)},P.array.entries=function(){return P.array.arrayIterator_(this,function(M,W){return[M,W]})},P.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=P.array.entries)},P.array.keys=function(){return P.array.arrayIterator_(this,function(M){return M})},P.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=P.array.keys)},P.array.values=function(){return P.array.arrayIterator_(this,function(M,W){return W})},P.array.values$install=function(){Array.prototype.values||(Array.prototype.values=P.array.values)},P.array.copyWithin=function(M,W,J){var f=this.length;if(M=Number(M),W=Number(W),J=Number(J??f),M<W)for(J=Math.min(J,f);W<J;)W in this?this[M++]=this[W++]:(delete this[M++],W++);else for(J=Math.min(J,f+W-M),M+=J-W;J>W;)--J in this?this[--M]=this[J]:delete this[M];return this},P.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=P.array.copyWithin)},P.array.fill=function(M,W,J){for(J!=null&&M.length||(J=this.length||0),J=Number(J),W=Number((W===void 0?0:W)||0);W<J;W++)this[W]=M;return this},P.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=P.array.fill)},P.array.find=function(M,W){return P.array.findInternal_(this,M,W).v},P.array.find$install=function(){Array.prototype.find||(Array.prototype.find=P.array.find)},P.array.findIndex=function(M,W){return P.array.findInternal_(this,M,W).i},P.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=P.array.findIndex)},P.Map=function(M){if(M=M===void 0?[]:M,this.data_={},this.head_=P.Map.createHead_(),this.size=0,M){M=P.makeIterator(M);for(var W=M.next();!W.done;W=M.next())W=W.value,this.set(W[0],W[1])}},P.Map.checkBrowserConformance_=function(){var M=P.global.Map;if(!M||!M.prototype.entries||!Object.seal)return!1;try{var W=Object.seal({x:4}),J=new M(P.makeIterator([[W,"s"]]));if(J.get(W)!="s"||J.size!=1||J.get({x:4})||J.set({x:4},"t")!=J||J.size!=2)return!1;var f=J.entries(),e=f.next();return e.done||e.value[0]!=W||e.value[1]!="s"?!1:(e=f.next(),!(e.done||e.value[0].x!=4||e.value[1]!="t"||!f.next().done))}catch{return!1}},P.Map.createHead_=function(){var M={};return M.previous=M.next=M.head=M},P.Map.getId_=function(M){return M instanceof Object?(P.Map.key_ in M||M instanceof Object&&Object.isExtensible&&Object.isExtensible(M)&&P.Map.defineProperty_(M,P.Map.key_,++P.Map.index_),P.Map.key_ in M?M[P.Map.key_]:" "+M):String(M)},P.Map.prototype.set=function(M,W){var e=this.maybeGetEntry_(M),J=e.id,f=e.list,e=e.entry;return f||(f=this.data_[J]=[]),e?e.value=W:(e={next:this.head_,previous:this.head_.previous,head:this.head_,key:M,value:W},f.push(e),this.head_.previous.next=e,this.head_.previous=e,this.size++),this},P.Map.prototype.delete=function(M){var W=this.maybeGetEntry_(M);M=W.id;var J=W.list,f=W.index;return(W=W.entry)&&J?(J.splice(f,1),J.length||delete this.data_[M],W.previous.next=W.next,W.next.previous=W.previous,W.head=null,this.size--,!0):!1},P.Map.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=P.Map.createHead_(),this.size=0},P.Map.prototype.has=function(M){return!!this.maybeGetEntry_(M).entry},P.Map.prototype.get=function(M){return(M=this.maybeGetEntry_(M).entry)&&M.value},P.Map.prototype.maybeGetEntry_=function(M){var W=P.Map.getId_(M),J=this.data_[W];if(J)for(var f=0;f<J.length;f++){var e=J[f];if(M!==M&&e.key!==e.key||M===e.key)return{id:W,list:J,index:f,entry:e}}return{id:W,list:J,index:-1,entry:void 0}},P.Map.prototype.entries=function(){return this.iter_(function(M){return[M.key,M.value]})},P.Map.prototype.keys=function(){return this.iter_(function(M){return M.key})},P.Map.prototype.values=function(){return this.iter_(function(M){return M.value})},P.Map.prototype.forEach=function(M,W){for(var J=P.makeIterator(this.entries()),f=J.next();!f.done;f=J.next())f=f.value,M.call(W,f[1],f[0],this)},P.Map.prototype.iter_=function(M){var W=this,J=this.head_;P.initSymbol(),P.initSymbolIterator();var f={};return f.next=function(){if(J){for(;J.head!=W.head_;)J=J.previous;for(;J.next!=J.head;)return J=J.next,{done:!1,value:M(J)};J=null}return{done:!0,value:void 0}},f[Symbol.iterator]=function(){return this},f},P.Map.index_=0,P.Map.defineProperty_=Object.defineProperty?function(M,W,J){Object.defineProperty(M,W,{value:String(J)})}:function(M,W,J){M[W]=String(J)},P.Map.Entry_=function(){},P.Map.ASSUME_NO_NATIVE=!1,P.Map$install=function(){P.initSymbol(),P.initSymbolIterator(),!P.Map.ASSUME_NO_NATIVE&&P.Map.checkBrowserConformance_()?P.Map=P.global.Map:(P.initSymbol(),P.initSymbolIterator(),P.Map.prototype[Symbol.iterator]=P.Map.prototype.entries,P.initSymbol(),P.Map.key_=Symbol("map-id-key")),P.Map$install=function(){}},P.math=P.math||{},P.math.clz32=function(M){if(M=Number(M)>>>0,M===0)return 32;var W=0;return(M&4294901760)===0&&(M<<=16,W+=16),(M&4278190080)===0&&(M<<=8,W+=8),(M&4026531840)===0&&(M<<=4,W+=4),(M&3221225472)===0&&(M<<=2,W+=2),(M&2147483648)===0&&W++,W},P.math.imul=function(M,W){M=Number(M),W=Number(W);var J=M&65535,f=W&65535;return J*f+((M>>>16&65535)*f+J*(W>>>16&65535)<<16>>>0)|0},P.math.sign=function(M){return M=Number(M),M===0||isNaN(M)?M:0<M?1:-1},P.math.log10=function(M){return Math.log(M)/Math.LN10},P.math.log2=function(M){return Math.log(M)/Math.LN2},P.math.log1p=function(M){if(M=Number(M),.25>M&&-.25<M){for(var W=M,J=1,f=M,e=0,p=1;e!=f;)W*=M,p*=-1,f=(e=f)+p*W/++J;return f}return Math.log(1+M)},P.math.expm1=function(M){if(M=Number(M),.25>M&&-.25<M){for(var W=M,J=1,f=M,e=0;e!=f;)W*=M/++J,f=(e=f)+W;return f}return Math.exp(M)-1},P.math.cosh=function(M){return M=Number(M),(Math.exp(M)+Math.exp(-M))/2},P.math.sinh=function(M){return M=Number(M),M===0?M:(Math.exp(M)-Math.exp(-M))/2},P.math.tanh=function(M){if(M=Number(M),M===0)return M;var W=Math.exp(2*-Math.abs(M)),W=(1-W)/(1+W);return 0>M?-W:W},P.math.acosh=function(M){return M=Number(M),Math.log(M+Math.sqrt(M*M-1))},P.math.asinh=function(M){if(M=Number(M),M===0)return M;var W=Math.log(Math.abs(M)+Math.sqrt(M*M+1));return 0>M?-W:W},P.math.atanh=function(M){return M=Number(M),(P.math.log1p(M)-P.math.log1p(-M))/2},P.math.hypot=function(M,W,J){for(var f=[],e=2;e<arguments.length;++e)f[e-2]=arguments[e];M=Number(M),W=Number(W);for(var p=Math.max(Math.abs(M),Math.abs(W)),V=P.makeIterator(f),e=V.next();!e.done;e=V.next())p=Math.max(p,Math.abs(e.value));if(1e100<p||1e-100>p){for(M/=p,W/=p,V=M*M+W*W,f=P.makeIterator(f),e=f.next();!e.done;e=f.next())e=e.value,e=Number(e)/p,V+=e*e;return Math.sqrt(V)*p}for(p=M*M+W*W,f=P.makeIterator(f),e=f.next();!e.done;e=f.next())e=e.value,e=Number(e),p+=e*e;return Math.sqrt(p)},P.math.trunc=function(M){if(M=Number(M),isNaN(M)||M===1/0||M===-1/0||M===0)return M;var W=Math.floor(Math.abs(M));return 0>M?-W:W},P.math.cbrt=function(M){if(M===0)return M;M=Number(M);var W=Math.pow(Math.abs(M),1/3);return 0>M?-W:W},P.number=P.number||{},P.number.isFinite=function(M){return typeof M!="number"?!1:!isNaN(M)&&M!==1/0&&M!==-1/0},P.number.isInteger=function(M){return P.number.isFinite(M)?M===Math.floor(M):!1},P.number.isNaN=function(M){return typeof M=="number"&&isNaN(M)},P.number.isSafeInteger=function(M){return P.number.isInteger(M)&&Math.abs(M)<=P.number.MAX_SAFE_INTEGER},P.number.EPSILON=Math.pow(2,-52),P.number.MAX_SAFE_INTEGER=9007199254740991,P.number.MIN_SAFE_INTEGER=-9007199254740991,P.object=P.object||{},P.object.assign=function(M,W){for(var J=[],f=1;f<arguments.length;++f)J[f-1]=arguments[f];for(J=P.makeIterator(J),f=J.next();!f.done;f=J.next())if(f=f.value)for(var e in f)Object.prototype.hasOwnProperty.call(f,e)&&(M[e]=f[e]);return M},P.object.is=function(M,W){return M===W?M!==0||1/M===1/W:M!==M&&W!==W},P.Set=function(M){if(M=M===void 0?[]:M,this.map_=new P.Map,M){M=P.makeIterator(M);for(var W=M.next();!W.done;W=M.next())this.add(W.value)}this.size=this.map_.size},P.Set.checkBrowserConformance_=function(){var W=P.global.Set;if(!W||!W.prototype.entries||!Object.seal)return!1;var M=Object.seal({x:4}),W=new W(P.makeIterator([M]));if(W.has(M)||W.size!=1||W.add(M)!=W||W.size!=1||W.add({x:4})!=W||W.size!=2)return!1;var W=W.entries(),J=W.next();return J.done||J.value[0]!=M||J.value[1]!=M?!1:(J=W.next(),J.done||J.value[0]==M||J.value[0].x!=4||J.value[1]!=J.value[0]?!1:W.next().done)},P.Set.prototype.add=function(M){return this.map_.set(M,M),this.size=this.map_.size,this},P.Set.prototype.delete=function(M){return M=this.map_.delete(M),this.size=this.map_.size,M},P.Set.prototype.clear=function(){this.map_.clear(),this.size=0},P.Set.prototype.has=function(M){return this.map_.has(M)},P.Set.prototype.entries=function(){return this.map_.entries()},P.Set.prototype.values=function(){return this.map_.values()},P.Set.prototype.forEach=function(M,W){var J=this;this.map_.forEach(function(f){return M.call(W,f,f,J)})},P.Set.ASSUME_NO_NATIVE=!1,P.Set$install=function(){!P.Set.ASSUME_NO_NATIVE&&P.Set.checkBrowserConformance_()?P.Set=P.global.Set:(P.Map$install(),P.initSymbol(),P.initSymbolIterator(),P.Set.prototype[Symbol.iterator]=P.Set.prototype.values),P.Set$install=function(){}},P.string=P.string||{},P.string.noRegExp_=function(M,W){if(M instanceof RegExp)throw new TypeError("First argument to String.prototype."+W+" must not be a regular expression")},P.string.fromCodePoint=function(M){for(var W=[],J=0;J<arguments.length;++J)W[J-0]=arguments[J];for(var J="",W=P.makeIterator(W),f=W.next();!f.done;f=W.next()){if(f=f.value,f=+f,0>f||1114111<f||f!==Math.floor(f))throw new RangeError("invalid_code_point "+f);65535>=f?J+=String.fromCharCode(f):(f-=65536,J+=String.fromCharCode(f>>>10&1023|55296),J+=String.fromCharCode(f&1023|56320))}return J},P.string.repeat=function(M){var W=this.toString();if(0>M||1342177279<M)throw new RangeError("Invalid count value");M|=0;for(var J="";M;)M&1&&(J+=W),(M>>>=1)&&(W+=W);return J},P.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=P.string.repeat)},P.string.codePointAt=function(M){var W=this.toString(),J=W.length;if(M=Number(M)||0,0<=M&&M<J){M|=0;var f=W.charCodeAt(M);return 55296>f||56319<f||M+1===J?f:(M=W.charCodeAt(M+1),56320>M||57343<M?f:1024*(f-55296)+M+9216)}},P.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=P.string.codePointAt)},P.string.includes=function(M,W){return W=W===void 0?0:W,P.string.noRegExp_(M,"includes"),this.toString().indexOf(M,W)!==-1},P.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=P.string.includes)},P.string.startsWith=function(M,W){W=W===void 0?0:W,P.string.noRegExp_(M,"startsWith");var J=this.toString();M+="";for(var f=J.length,e=M.length,p=Math.max(0,Math.min(W|0,J.length)),V=0;V<e&&p<f;)if(J[p++]!=M[V++])return!1;return V>=e},P.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=P.string.startsWith)},P.string.endsWith=function(M,W){P.string.noRegExp_(M,"endsWith");var J=this.toString();M+="",W===void 0&&(W=J.length);for(var f=Math.max(0,Math.min(W|0,J.length)),e=M.length;0<e&&0<f;)if(J[--f]!=M[--e])return!1;return 0>=e},P.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=P.string.endsWith)},function(M,W){ve.exports=W()}(self,function(){return function(){function M(f){var e=J[f];return e!==void 0||(e=J[f]={exports:{}},W[f].call(e.exports,e,e.exports,M)),e.exports}var W={945:function(f,e,p){var V=this&&this.__extends||function(){var E=function(R,_){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,l){m.__proto__=l}||function(m,l){for(var t in l)l.hasOwnProperty(t)&&(m[t]=l[t])},E(R,_)};return function(R,_){function m(){this.constructor=R}E(R,_),R.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AudioElement=void 0;var j=p(658),A=p(550),S=p(851),c=p(946),w;(function(E){E.Init="Init",E.PlayStarted="PlayStarted",E.PauseCalled="PauseCalled"})(w||(w={})),f=function(E){function R(){var _=E.call(this,null,A.class_id_t.AudioElement,0,j.ProxyMode.Local)||this;return _.sinkId_="",_.srcObject_=null,_.loop_=!1,_.notiState=w.Init,_}return V(R,E),R.prototype.setSinkId=function(_){var m=this;return S.logger.info(this.user_friendly_id()+".setSinkId: set sinkId to "+_),new Promise(function(l,t){m.waitUntilConnected("AudioElement.sinkId").then(function(){var u=m.remoteInvoke(!0,A.method_id_AudioElement_t.sinkId,_);return c.getRedirector().getFeatureValue(A.FEATURE_ms_teams_pstn)||(m.sinkId_=_,l()),u}).then(function(){S.logger.info(m.user_friendly_id()+".setSinkId: success! resolving..."),m.sinkId_=_,l()}).catch(function(u){u=m.logRemoteInvokeError(u,".sinkId setter: failed to connect!"),t(u)})})},Object.defineProperty(R.prototype,"sinkId",{get:function(){return this.sinkId_},set:function(_){this.setSinkId(_)},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(_){var m=this;S.logger.info(this.user_friendly_id()+".srcObject: set srcObject to "+JSON.stringify(_)),_!==this.srcObject_&&(this.srcObject_=_,this.waitUntilConnected("AudioElement.srcObject").then(function(){return _.syncBarrier()}).then(function(l){return S.logger.info(m.user_friendly_id()+".srcObject: set srcObject to s "+JSON.stringify(l)),m.remoteInvoke(!0,A.method_id_AudioElement_t.srcObject,l!=null?l.id:"null")}).then(function(){S.logger.info(m.user_friendly_id()+".srcObject setter: remote success!")}).catch(function(l){m.logRemoteInvokeError(l,".srcObject setter: failed to connect!")}))},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"src",{get:function(){return this.src_},set:function(_){var m=this;S.logger.info(this.user_friendly_id()+".src: set src to "+_),this.src_=_,this.waitUntilConnected("AudioElement.src").then(function(){m.remoteInvoke(!0,A.method_id_AudioElement_t.src,_)}).catch(function(l){m.logRemoteInvokeError(l,".src setter: failed to connect!")})},enumerable:!1,configurable:!0}),R.prototype.play=function(){var _=this;return S.logger.info(this.user_friendly_id()+".play() called."),this.toggleAudio(!0),new Promise(function(m,l){_.waitUntilConnected("AudioElement.play").then(function(){return _.remoteInvoke(!1,A.method_id_AudioElement_t.play)}).then(function(){m()}).catch(function(t){_.logRemoteInvokeError(t,".play: failed to connect!"),l(t)})})},R.prototype.playEx=function(_,m,l){var t=this;S.logger.info(this.user_friendly_id()+".playEx() src:"+_+" sinkId:"+m+" loop:"+l),this.notiState=w.PlayStarted,this.waitUntilConnected("AudioElement.playEx").then(function(){var u=[];return m&&u.push(t.setSinkId(m)),l!=null&&(t.loop_=l,u.push(t.remoteInvoke(!0,A.method_id_AudioElement_t.loop,l))),Promise.all(u)}).then(function(){return t.src_=_,t.remoteInvoke(!0,A.method_id_AudioElement_t.src,_)}).then(function(){return t.play()}).then(function(){if(t.notiState==w.PauseCalled)return S.logger.info(t.user_friendly_id()+".playEx() run deferred pause"),t.doPauseAndDispose()}).then(function(){t.notiState=w.Init,S.logger.info(t.user_friendly_id()+".playEx() done")}).catch(function(u){t.notiState=w.Init,t.logRemoteInvokeError(u,".playEx() failed!")})},R.prototype.pause=function(){var _=this;return S.logger.info(this.user_friendly_id()+".pause() called."),this.toggleAudio(!1),new Promise(function(m,l){_.waitUntilConnected("AudioElement.pause").then(function(){return _.remoteInvoke(!1,A.method_id_AudioElement_t.pause)}).then(function(){m()}).catch(function(t){_.logRemoteInvokeError(t,".pause: failed!"),l()})})},R.prototype.doPauseAndDispose=function(){var _=this;return S.logger.info(this.user_friendly_id()+".doPauseAndDispose() called."),this.toggleAudio(!1),new Promise(function(m,l){_.waitUntilConnected("AudioElement.doPauseAndDispose").then(function(){return _.remoteInvoke(!1,A.method_id_AudioElement_t.pause,[])}).then(function(){S.logger.info(_.user_friendly_id()+".doPauseAndDispose() resolving..."),m(),_.dispose()}).catch(function(t){_.logRemoteInvokeError(t,".doPauseAndDispose: failed to connect!")})})},R.prototype.pauseAndDispose=function(){S.logger.info(this.user_friendly_id()+".pauseAndDispose() notiState: "+this.notiState),this.notiState==w.PlayStarted?this.notiState=w.PauseCalled:this.doPauseAndDispose()},R.prototype.toggleAudio=function(_){this.srcObject_&&(S.logger.info(this.user_friendly_id()+".toggleAudio() toggle audio tracks:"+_),this.srcObject_.toggleAudio(_))},Object.defineProperty(R.prototype,"loop",{get:function(){return this.loop_},set:function(_){var m=this;S.logger.info(this.user_friendly_id()+".loop: set loop to "+_),this.loop_=_,this.waitUntilConnected("AudioElement.loop").then(function(){m.remoteInvoke(!0,A.method_id_AudioElement_t.loop,_)}).catch(function(l){m.logRemoteInvokeError(l,".loop setter: failed to connect!")})},enumerable:!1,configurable:!0}),R.prototype.dispose=function(){S.logger.info(this.user_friendly_id()+".dispose()"),this.src_=this.sinkId_="",this.srcObject_=null,this.loop_=!1,this.release()},R}(j.ProxyObject),e.AudioElement=f},239:function(f,e,p){e.E=void 0;var V=p(945),j=p(851),A=function(){function S(){this.sinkId=void 0,this.src="",this.loop=void 0,this.element=null}return S.prototype.getSrc=function(){return this.src},S.prototype.setSinkId=function(c){this.sinkId=c},S.prototype.getLoop=function(){return this.loop===!0},S.prototype.setLoop=function(c){this.loop=c},S.prototype.play=function(c){this.element=new V.AudioElement,this.src=c,this.element.playEx(this.src,this.sinkId,this.loop)},S.prototype.pause=function(){this.element&&(this.element.pauseAndDispose(),this.element=null)},S.prototype.release=function(){this.element&&(this.element.dispose(),this.element=null)},S}();f=function(){function S(){this.audioIdMap=null,this.audioIdMap=new Map}return S.prototype.getNotificationInfo=function(c){if(this.audioIdMap.has(c))return this.audioIdMap.get(c);var w=new A;return this.audioIdMap.set(c,w),w},S.prototype.playNotifyAudio=function(c,w){w&&(j.logger.info("AudioNotification.playNotifyAudio, Remote to Thin Client audioId:"+c+" src:"+w),this.getNotificationInfo(c).play(w))},S.prototype.pauseNotifyAudio=function(c,w){if(this.audioIdMap.has(c)){var E=this.audioIdMap.get(c);w&&w!=E.getSrc()&&j.logger.warning("AudioNotification.pauseNotifyAudio warning: for audioId:"+c+", different param src:"+w+" from org src:"+E.getSrc()),E.pause()}else j.logger.warning("AudioNotification.pauseNotifyAudio no audioId:"+c+" src:"+w)},S.prototype.setSinkId=function(c,w){if(w!=null&&w.startsWith("speaker:")){j.logger.info("AudioNotification.setSinkId before parsing audioId:"+c+" sinkId:"+w);var E=w.slice(8);j.logger.info("AudioNotification.setSinkId after parsing audioId:"+c+" speakersinkId:"+E),w=E}this.getNotificationInfo(c).setSinkId(w)},S.prototype.getLoop=function(c){return this.getNotificationInfo(c).getLoop()},S.prototype.setLoop=function(c,w){this.getNotificationInfo(c).setLoop(w)},S.prototype.release=function(){this.audioIdMap.forEach(function(c,w,E){c.release()}),this.audioIdMap.clear()},S}(),e.E=f},610:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.deferred_action=void 0;var V=p(851);f=function(){function j(A,S,c){this.resolve=A,this.reject=S,this.name_=c}return Object.defineProperty(j.prototype,"name",{get:function(){return this.name_},enumerable:!1,configurable:!0}),j.prototype.post=function(A){A==1?(V.logger.info('deferred_action.post(): resolving "'+this.name_+'"'),this.resolve()):(V.logger.info('deferred_action.post(): rejecting "'+this.name_+'"'),this.reject())},j.prototype.postWithResult=function(A,S){A==1?(V.logger.info('deferred_action.post(): resolving "'+this.name_+'"'),this.resolve(S)):(V.logger.info('deferred_action.post(): rejecting "'+this.name_+'"'),this.reject())},j.prototype.postResolve=function(A){this.resolve(A)},j.prototype.postReject=function(A){A==null?this.reject():this.reject(A)},j}(),e.deferred_action=f},613:function(f,e,p){var V=this&&this.__extends||function(){var w=function(E,R){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,m){_.__proto__=m}||function(_,m){for(var l in m)m.hasOwnProperty(l)&&(_[l]=m[l])},w(E,R)};return function(E,R){function _(){this.constructor=E}w(E,R),E.prototype=R===null?Object.create(R):(_.prototype=R.prototype,new _)}}(),j=this&&this.__read||function(w,E){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var R=typeof Symbol=="function"&&w[Symbol.iterator];if(!R)return w;var _=R.call(w),m,l=[],t;try{for(;(E===void 0||0<E--)&&!(m=_.next()).done;)l.push(m.value)}catch(u){t={error:u}}finally{try{m&&!m.done&&(R=_.return)&&R.call(_)}finally{if(t)throw t.error}}return l};Object.defineProperty(e,"__esModule",{value:!0}),e.E911Service=void 0;var A=p(550),S=p(658),c=p(851);f=function(w){function E(){var R=w.call(this,null,A.class_id_t.E911Service,0,S.ProxyMode.Local)||this;return R.preE911Info_=null,R}return V(E,w),E.prototype.isSameInfo=function(R){if(this.preE911Info_==null&&R!=null||this.preE911Info_!=null&&R==null||this.preE911Info_.bssid!=R.bssid||this.preE911Info_.ipv4!=R.ipv4||this.preE911Info_.subnetLengthIpv4!=R.subnetLengthIpv4||this.preE911Info_.ipv6!=R.ipv6||this.preE911Info_.subnetLengthIpv6!=R.subnetLengthIpv6||this.preE911Info_.mac!=R.mac||1e-4<=Math.abs(this.preE911Info_.latitude-R.latitude)||1e-4<=Math.abs(this.preE911Info_.longitude-R.longitude)||!Array.isArray(this.preE911Info_.e911)||!Array.isArray(R.e911)||this.preE911Info_.e911.length!=R.e911.length)return!1;for(var _=0;_<R.e911.length;_++)if(this.preE911Info_.e911[_].chassisId!=R.e911[_].chassisId||this.preE911Info_.e911[_].portId!=R.e911[_].portId)return!1;return!0},Object.defineProperty(E.prototype,"onupdate",{get:function(){return this.onupdate_},set:function(R){var _=this;this.onupdate_=R,this.waitUntilConnected(this.user_friendly_id()+".onupdate").then(function(){var m=_.registerCallbacks(!1,_.isNullCallback(_.onupdate_),A.method_id_E911Service_t.onupdate);return m.then(function(l){l=j(l.params);var t=l[0];l.slice(1),_.preE911Info_!==null&&_.isSameInfo(t)||(c.logger.info(_.user_friendly_id()+".onupdate",JSON.stringify(t)),_.onupdate_&&_.onupdate_(t),_.preE911Info_=t)}),_.remoteInvoke(!0,A.method_id_E911Service_t.onupdate,m.success)}).catch(function(){return c.logger.error(_.user_friendly_id()+".onupdate, could not set listener")})},enumerable:!1,configurable:!0}),E.prototype.getE911Info=function(){var R=this;return new Promise(function(_,m){R.waitUntilConnected(R.user_friendly_id()+".getE911Info").then(function(){return R.remoteInvoke(!1,A.method_id_E911Service_t.getE911Info)}).then(function(l){c.logger.info(R.user_friendly_id()+".getE911Info",JSON.stringify(R.param0(l))),_(R.param0(l))}).catch(function(){c.logger.error(R.user_friendly_id()+".getE911Info promise rejected"),m()})})},E.prototype.updateE911Info=function(){var R=this;this.getE911Info().then(function(_){return R.onupdate&&R.onupdate(_)}).catch(function(){return c.logger.error("Fail to get e911 information!")})},E}(S.ProxyObject),e.E911Service=f},9:function(f,e,p){var V=this&&this.__extends||function(){var R=function(_,m){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,t){l.__proto__=t}||function(l,t){for(var u in t)t.hasOwnProperty(u)&&(l[u]=t[u])},R(_,m)};return function(_,m){function l(){this.constructor=_}R(_,m),_.prototype=m===null?Object.create(m):(l.prototype=m.prototype,new l)}}(),j=this&&this.__read||function(R,_){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var m=typeof Symbol=="function"&&R[Symbol.iterator];if(!m)return R;var l=m.call(R),t,u=[],h;try{for(;(_===void 0||0<_--)&&!(t=l.next()).done;)u.push(t.value)}catch(g){h={error:g}}finally{try{t&&!t.done&&(m=l.return)&&m.call(l)}finally{if(h)throw h.error}}return u},A=this&&this.__values||function(R){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var _=typeof Symbol=="function"&&Symbol.iterator,m=_&&R[_],l=0;if(m)return m.call(R);if(R&&typeof R.length=="number")return{next:function(){return R&&l>=R.length&&(R=void 0),{value:R&&R[l++],done:!R}}};throw new TypeError(_?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.EngineControl=e.VersionType=void 0;var S=p(550),c=p(946),w=p(658),E=p(851);(function(R){R[R.Webrpc=0]="Webrpc",R[R.WebrtcCodecs=1]="WebrtcCodecs",R[R.Receiver=2]="Receiver",R[R.Vda=3]="Vda",R[R.Endpoint=4]="Endpoint",R[R.TypeScript=5]="TypeScript",R[R.HdxRtcEngine=6]="HdxRtcEngine",R[R.Max=7]="Max"})(e.VersionType||(e.VersionType={})),f=function(R){function _(m){var l=R.call(this,null,S.class_id_t.EngineControl,0,w.ProxyMode.Local)||this;return l.clientInfo_="",l.clientInfo_=m,l}return V(_,R),_.prototype.bind=function(){E.logger.info(this.user_friendly_id()+".bind() called."),this.reconstructor(null,S.class_id_t.EngineControl,0)},_.prototype.syncBarrier=function(){var m=this;return E.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(l,t){m.syncBarrierDeep(l,t)&&m.waitUntilConnected("EngineControl.syncBarrier").then(function(){return Promise.all([m.remoteInvoke(!1,S.method_id_EngineControl_t.version,{major:0,minor:0,revision:0,build:0}),m.remoteInvoke(!1,S.method_id_EngineControl_t.feature_flags,[])])}).then(function(u){var h,g;u=j(u.map(function(d){return m.param0(d)}),2),m.version_=u[0],m.features_=u[1],E.logger.info(m.user_friendly_id()+" features: "+JSON.stringify(m.features_)),c.getRedirector().setFeatures(m.features_),m.remoteInvoke(!1,S.method_id_EngineControl_t.set_client_info,(m.clientInfo_||"Unknown")+"; vdiShim/"+S.HDXMS_VERSION,c.getRedirector().sessionClientId).catch(function(){return E.logger.error(m.user_friendly_id()+" could not set client info")}),u=[];try{for(var y=A(m.features_),a=y.next();!a.done;a=y.next()){var v=a.value;v.name==="ms_teams_desktop_sharing"&&v.value?u.push(m.remoteInvoke(!1,S.method_id_EngineControl_t.version_info,[])):v.name==="ms_teams_osinfo"&&v.value?u.push(m.remoteInvoke(!1,S.method_id_EngineControl_t.osinfo,{family:"",version:"",architecture:"",distro:"",edition:""})):v.name==="ms_teams_endpoint_id"&&v.value?u.push(m.remoteInvoke(!1,S.method_id_EngineControl_t.endpoint_id,{machine_id:"",user_id:""})):v.name==="ms_teams_hardware_info"&&v.value&&u.push(m.remoteInvoke(!1,S.method_id_EngineControl_t.hardware_info))}}catch(d){h={error:d}}finally{try{a&&!a.done&&(g=y.return)&&g.call(y)}finally{if(h)throw h.error}}if(0<u.length)return Promise.all(u)}).then(function(u){var h,g;if(u===void 0)E.logger.info(m.user_friendly_id()+"release-1905 client.");else{E.logger.info(m.user_friendly_id()+"release-1906 or later client: received detailed client version list.");try{for(var y=A(u),a=y.next();!a.done;a=y.next()){var v=a.value;v.hdr.proc.iid==S.class_id_t.EngineControl&&v.hdr.proc.methodid==S.method_id_EngineControl_t.version_info?m.versions_=m.param0(v):v.hdr.proc.iid==S.class_id_t.EngineControl&&v.hdr.proc.methodid==S.method_id_EngineControl_t.osinfo?m.osinfo_=m.param0(v):v.hdr.proc.iid==S.class_id_t.EngineControl&&v.hdr.proc.methodid==S.method_id_EngineControl_t.endpoint_id?m.endpointid_=m.param0(v):v.hdr.proc.iid==S.class_id_t.EngineControl&&v.hdr.proc.methodid==S.method_id_EngineControl_t.hardware_info&&(m.hardwareinfo_=m.param0(v))}}catch(d){h={error:d}}finally{try{a&&!a.done&&(g=y.return)&&g.call(y)}finally{if(h)throw h.error}}}m.syncBarrierResolve(m)}).catch(function(u){u=m.logRemoteInvokeError(u,"failure to retrieve version/feature related client info."),m.syncBarrierReject(u)})})},_}(w.ProxyObject),e.EngineControl=f},368:function(f,e,p){var V=this&&this.__extends||function(){var l=function(t,u){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var y in g)g.hasOwnProperty(y)&&(h[y]=g[y])},l(t,u)};return function(t,u){function h(){this.constructor=t}l(t,u),t.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)}}(),j=this&&this.__values||function(l){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var t=typeof Symbol=="function"&&Symbol.iterator,u=t&&l[t],h=0;if(u)return u.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&h>=l.length&&(l=void 0),{value:l&&l[h++],done:!l}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Frames=e.FrameTracker=void 0;var A=p(851),S=p(946),c=p(121),w=p(679),E=function(){return function(l,t){this.handle=l,this.color=t}}(),R;(function(l){l[l.unknown=0]="unknown",l[l.capable=1]="capable",l[l.configured=2]="configured"})(R||(R={}));var _=function(l){function t(){var u=l.call(this)||this;return u.name="overlay",u.color_clipping_=R.unknown,c.protocol_handler_manager.addProtocolHandler(u),u}return V(t,l),t.prototype.is_color_clipping_enabled=function(){return this.color_clipping_==R.configured},t.prototype.disable_color_clipping=function(){this.color_clipping_=R.unknown,A.logger.info(this.user_friendly_id()+": disabled color clipping!")},t.prototype.init=function(u){},t.prototype.deinit=function(){this.clearRequests(),this.clearCallbacks()},t.prototype.on_message=function(u){var h,g,y=this;if(A.logger.trace("HDXMS: Overlay <<< "+JSON.stringify(u)),u.command=="capabilities"){u=u.caps;try{for(var a=j(u),v=a.next();!v.done;v=a.next())v.value=="clipping"&&(this.color_clipping_=R.capable,A.logger.info(this.user_friendly_id()+": agent is capable to do color clipping!"))}catch(d){h={error:d}}finally{try{v&&!v.done&&(g=a.return)&&g.call(a)}finally{if(h)throw h.error}}new Promise(function(d,I){y.processRequest(d,I);var k=[];y.color_clipping_==R.capable?(k.push("clipping"),A.logger.info(y.user_friendly_id()+": sending config request with clipping!")):A.logger.info(y.user_friendly_id()+": sending config request without clipping!"),S.getRedirector().WSSendObject({v:"overlay",command:"configure",caps:k})})}else u.command=="clipping"?(u=new E(u.windowHandle,u.color),(h=this.getCallback(u.handle))?h.resolve(u):A.logger.info("didn't find callback: ignore clipping event for windowHandle:"+u.handle)):(h=this.processResponse(),h!=null?(A.logger.info(this.user_friendly_id()+" msg:"+JSON.stringify(u)),u.status==1?u.command=="track_window"?h.resolve(u.windowId):u.command=="untrack_window"?h.resolve(u.windowHandle):u.command=="configure"?(this.color_clipping_==R.capable&&(this.color_clipping_=R.configured,A.logger.info(this.user_friendly_id()+": color clipping is fully configured!")),h.resolve({})):h.reject({}):(u.status==0&&u.command=="configure"&&this.color_clipping_==R.capable&&(this.color_clipping_=R.unknown,A.logger.info(this.user_friendly_id()+": failed to configure color clipping, falling back to legacy clipping!")),A.logger.info(this.user_friendly_id()+"failure/unknown response for message: "+u.command),h.reject({}))):A.logger.info("spurious response for message: "+u.command))},t.prototype.registerWindowWithServiceLegacy=function(){var u=this;return new Promise(function(h,g){var y=S.getRedirector();A.logger.info(u.user_friendly_id()+".registerWindowWithService: legacy case");var a=window.getWindowHandleAsHex.bind(window);a==null&&(A.logger.error(u.user_friendly_id()+".registerWindowWithService: getWindowHandle method is undefined or null"),g({})),Promise.all([a(),y.startRedirection(!1,"registerWindowWithService")]).then(function(v){A.logger.info(u.user_friendly_id()+".registerWindowWithService: set window handle: "+v[0]),y.WSSendObject({v:"overlay",command:"window",windowHandle:v[0]}),h(v[0])})})},t.prototype.registerWindowWithService=function(u){var h=this;return new Promise(function(g,y){var a=S.getRedirector();A.logger.info(h.user_friendly_id()+".registerWindowWithService: new MW case"),a.startRedirection(!1,"registerWindowWithService").then(function(){h.processRequest(g,y),a.WSSendObject({v:"overlay",command:"track_window",windowHandle:u})})})},t.prototype.unregisterWindowWithService=function(u){var h=this;return A.logger.info(this.user_friendly_id()+".unregisterWindowWithService(handle: "+u+")"),new Promise(function(g,y){u==null?y({}):(h.processRequest(g,y),S.getRedirector().WSSendObject({v:"overlay",command:"untrack_window",windowHandle:u}))})},t.prototype.replyClippingStatus=function(u,h,g){var y=this;return A.logger.info(this.user_friendly_id()+".replyClippingStatus(handle: "+u+", color:"+h+", status:"+g+")"),new Promise(function(a,v){u==null?v():S.getRedirector().WSSendObject({v:"overlay",command:"clipping",windowHandle:u,color:h,status:g}).then(function(){A.logger.info(y.user_friendly_id()+".replyClippingStatus(): status sent success!"),a()}).catch(function(){A.logger.info(y.user_friendly_id()+".replyClippingStatus(): status sent failure!"),v()})})},t}(c.protocol_base),m=function(){function l(t){var u=this;this.running_=!1,this.elements_=[],this.clipRects=new Set,this.legacy_=!1,this.videos_=[],this.connected_=!1,this.yClientAreaOffset_=this.xClientAreaOffset_=0,this.wheelEventHandler=function(h){setTimeout(function(){u.updateAll()},10)},this.scrollEventHandler=function(h){u.updateAll()},this.keyupEventHandler=function(h){h.code!="Tab"&&h.code!="ArrowUp"&&h.code!="ArrowDown"&&h.code!="ArrowLeft"&&h.code!="ArrowRight"&&h.code!="PageUp"&&h.code!="PageDown"&&h.code!="Home"&&h.code!="End"||u.updateAll()},this.resizeEventHandler=function(h){A.logger.info("onWindowResize... update video elements position"),u.updateAll()},A.logger.info("FrameTracker.constructor: (handle: "+t+")"),this.handle_=t,this.handle_||(this.legacy_=!0),this.connectToService(),this.observer_=new MutationObserver(function(h){u.updateAll()})}return l.prototype.user_friendly_id=function(){return this.constructor.name},l.prototype.is_color_clipping_enabled=function(){return l.Protocol.is_color_clipping_enabled()},l.prototype.connectToService=function(){var t=this;(this.legacy_?l.Protocol.registerWindowWithServiceLegacy():l.Protocol.registerWindowWithService(this.handle_)).then(function(u){A.logger.info("FrameTracker: connected to service. (windowId="+u+")"),t.connected_=!0,typeof u=="number"?t.windowId_=u:typeof u=="string"&&(t.handle_=u),t.is_color_clipping_enabled()&&(t.oncolorclipping=function(){A.logger.debug("FrameTracker: .onclipping event received! handle_:"+t.handle_+" legacy_:"+t.legacy_)}),t.videos_.forEach(function(h){h.sinkId=JSON.stringify(t.windowId_)}),t.videos_=[]}).catch(function(u){A.logger.error("registerWindowWithService failed! "+u)})},Object.defineProperty(l.prototype,"oncolorclipping",{set:function(t){var u=this;this.oncolorclipping_=t,l.Protocol.registerCallback(this.handle_).then(function(h){A.logger.info(u.user_friendly_id()+".oncolorclipping_ callback received!"),u.handle_==h.handle?(h.color.toUpperCase()=="FFFFFFFF"?(l.Protocol.disable_color_clipping(),A.logger.info(u.user_friendly_id()+".oncolorclipping_ replying with failure!"),l.Protocol.replyClippingStatus(h.handle,h.color,!1)):(u.color_="#"+h.color,u.elements_.forEach(function(g,y){g.target.style.backgroundColor=u.color_}),A.logger.info(u.user_friendly_id()+".oncolorclipping_ replying with success!"),l.Protocol.replyClippingStatus(h.handle,h.color,!0)),u.oncolorclipping_&&u.oncolorclipping_()):(A.logger.warning(u.user_friendly_id()+".oncolorclipping_ handle mismatch, replying with failure!"),l.Protocol.replyClippingStatus(h.handle,h.color,!1))})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"handle",{get:function(){return this.handle_},enumerable:!1,configurable:!0}),l.prototype.getWindowFromElement=function(t){return t.ownerDocument.defaultView},l.prototype.rectanglesIntersect=function(t,u){return t.x<u.x+u.width&&t.x+t.width>u.x&&t.y<u.y+u.height&&t.y+t.height>u.y},l.prototype.intersectingRect=function(t,u){var h=Math.max(t.left,u.left),g=Math.max(t.top,u.top);return new DOMRect(h,g,Math.min(t.right,u.right)-h,Math.min(t.bottom,u.bottom)-g)},l.prototype.pedigreeCount=function(t,u){for(var h=0,g=t.parentElement;g!=null&&g!=u;)h++,g=g.parentElement;return{isAncestor:g!=null,pedigree:h}},l.prototype.selectTopmost=function(t,u){var h=this.getBoundingClientRect(t),g=this.getBoundingClientRect(u),h=this.intersectingRect(h,g),g=t.ownerDocument.elementFromPoint(h.left+h.width/2,h.top+h.height/2);if(g==t)return t;if(g==u)return u;if(h=this.pedigreeCount(t,g),g=this.pedigreeCount(u,g),h.isAncestor&&g.isAncestor){if(h.pedigree<g.pedigree)return t;if(g.pedigree<h.pedigree)return u}else{if(h.isAncestor)return t;if(g.isAncestor)return u}},l.prototype.checkOverlappingVideos=function(t){var u=this;if(this.is_color_clipping_enabled())A.logger.debug("color based clipping is active!");else{var h=this.getBoundingClientRect(t.target);t.overlaps.forEach(function(g){t.target.remoteVideoElement.removeClipRect(g.rect)}),t.overlaps=[],this.elements_.forEach(function(g){if(g!=t){var y=g.overlaps.map(function(v){return v.element}).indexOf(t.target);if(y!=-1&&(y=g.overlaps.splice(y,1)[0],g.target.remoteVideoElement.removeClipRect(y.rect)),y=u.getBoundingClientRect(g.target),u.rectanglesIntersect(h,y)){var a=u.selectTopmost(t.target,g.target);a==t.target?(g.overlaps.push({element:t.target,rect:h}),g.target.remoteVideoElement.addClipRect(h)):a==g.target&&(t.overlaps.push({element:g.target,rect:y}),t.target.remoteVideoElement.addClipRect(y))}}})}},l.prototype.updateAll=function(){var t=this;this.elements_.forEach(function(u){var h=t.getBoundingClientRect(u.target);if(h!==void 0){var g=u.clientRect;(g===void 0||g.x!==h.x||g.y!==h.y||g.width!==h.width||g.height!==h.height)&&(u.clientRect=h,u.callback(h),t.checkOverlappingVideos(u))}})},l.prototype.track=function(t,u){var h=this,g=this.getBoundingClientRect(t);if(A.logger.info("Track (handle: "+this.handle_+") element frame",t,JSON.stringify(g)),this.elements_.push({target:t,clientRect:void 0,callback:u,overlaps:[]}),this.is_color_clipping_enabled())t.style.backgroundColor=this.color_,A.logger.info("color based clipping is active!");else try{A.logger.info("Initializing occlusion for new videoElement"),this.clipRects.forEach(function(y){h.applyOcclusion(t,JSON.parse(y))})}catch(y){A.logger.error("addOcclusionInit failed! "+y)}this.running_||(A.logger.info("Start FrameTracker observer..."),this.observer_.observe(t.ownerDocument.body,{attributes:!0,childList:!0,subtree:!0}),g=this.getWindowFromElement(t),g.addEventListener("wheel",this.wheelEventHandler),g.addEventListener("scroll",this.scrollEventHandler),g.addEventListener("keyup",this.keyupEventHandler),g.addEventListener("resize",this.resizeEventHandler),this.running_=!0),this.updateAll()},l.prototype.untrack=function(t){A.logger.info("Untrack (handle: "+this.handle_+") element frame:"+t);var u=-1;if(this.elements_.forEach(function(g,y){g.target===t&&(u=y)}),0<=u&&(this.elements_.splice(u,1),this.elements_.length===0)){A.logger.info("Stop FrameTracker observer..."),this.observer_.disconnect();var h=this.getWindowFromElement(t);h.removeEventListener("wheel",this.wheelEventHandler),h.removeEventListener("scroll",this.scrollEventHandler),h.removeEventListener("keyup",this.keyupEventHandler),h.removeEventListener("resize",this.resizeEventHandler),this.running_=!1}},l.prototype.applyOcclusion=function(t,u){if(this.is_color_clipping_enabled())A.logger.debug("color based clipping is active!");else{var h=this.getBoundingClientRect(t);this.rectanglesIntersect(u,h)&&t.remoteVideoElement!==void 0&&t.remoteVideoElement.addClipRect(u)}},l.prototype.addOcclusion=function(t){var u=this;this.is_color_clipping_enabled()?A.logger.debug("color based clipping is active!"):(A.logger.info("Adding occlusion "+JSON.stringify(t)+`
Tracking '`+this.elements_.length+"' elements."),this.clipRects.add(JSON.stringify(t)),this.elements_.forEach(function(h){u.applyOcclusion(h.target,t)}))},l.prototype.removeOcclusion=function(t){this.is_color_clipping_enabled()?A.logger.debug("color based clipping is active!"):(A.logger.info("Removing occlusion "+JSON.stringify(t)+`
Tracking '`+this.elements_.length+"' elements."),this.clipRects.delete(JSON.stringify(t)),this.elements_.forEach(function(u){u.target.remoteVideoElement!==void 0&&u.target.remoteVideoElement.removeClipRect(t)}))},l.prototype.setClientAreaOffset=function(t,u){this.xClientAreaOffset_=t,this.yClientAreaOffset_=u},l.prototype.getBoundingClientRect=function(t){return t=t.getBoundingClientRect(),t.x+=this.xClientAreaOffset_,t.y+=this.yClientAreaOffset_,t},l.prototype.newVideoElement=function(t){var u=this;if(A.logger.info("FrameTracker.newVideoElement: (id: "+t.id+")"),t.remoteVideoElement!==void 0)A.logger.warning("Video element is already configured!!!");else{t.id||(t.id="ctx-vid-"+l.videoElementIDs++);var h=new w.VideoElement(t.id,this.getWindowFromElement(t));h.style=t.style,this.connected_?(A.logger.info("FrameTracker.newVideoElement: initializing video element with sink id "+this.windowId_),h.sinkId=JSON.stringify(this.windowId_)):(A.logger.info("FrameTracker.newVideoElement: video element awaiting stable window state"),this.videos_.push(h)),h.onloadedmetadata=function(){t.dispatchEvent(new Event("loadedmetadata"))},h.ontimeupdate=function(){t.dispatchEvent(new Event("timeupdate"))},h.onconnectionstatechange=function(){h.connectionState=="connected"?u.track(t,function(g){h.setFrame(g)}):u.untrack(t)},delete t.remoteVideoElement,Object.defineProperty(t,"remoteVideoElement",{writable:!0,configurable:!0,value:null}),t.remoteVideoElement=h,delete t.srcObject,Object.defineProperty(t,"srcObject",{configurable:!0,get:function(){return h.srcObject},set:function(g){A.logger.info("VDI Shim set video element srcObject "+g),h.srcObject=g}}),delete t.videoWidth,Object.defineProperty(t,"videoWidth",{configurable:!0,get:function(){return h.videoWidth}}),delete t.videoHeight,Object.defineProperty(t,"videoHeight",{configurable:!0,get:function(){return h.videoHeight}})}},l.prototype.disposeVideoElement=function(t){A.logger.info("FrameTracker.disposeVideoElement: (id: "+t.id+")");var u=t.remoteVideoElement;if(u!=null){var h=this.videos_.findIndex(function(g){return g.Id==u.Id});-1<h&&this.videos_.splice(h,1),u.dispose(),t.remoteVideoElement=void 0}},l.videoElementIDs=0,l.Protocol=new _,l}();e.FrameTracker=m,f=function(){function l(t){this.frames_=[],t&&this.frames_.push(new m(void 0))}return l.prototype.newFrame=function(t){A.logger.info("Frames.newFrame: (handle: "+t+")");var u=this.findFrame(t);return u==null&&(u=new m(t),this.frames_.push(u)),u},l.prototype.disposeFrame=function(t){A.logger.info("Frames.disposeFrame: (handle: "+t+")");var u=this.frames_.findIndex(function(h){return h.handle==t});-1<u&&(m.Protocol.unregisterWindowWithService(t).then(function(h){A.logger.info("Untrack window (handle: "+h+") successful")}),this.frames_.splice(u,1))},l.prototype.findFrame=function(t){return A.logger.debug("Frames.findFrame: (handle: "+t+")"),t!=null?this.frames_.find(function(u){return u.handle==t}):this.frames_[0]},l.prototype.reconnect=function(){A.logger.info("Frames.reconnect()"),this.frames_.forEach(function(t){t.connectToService()})},l}(),e.Frames=f},247:function(f,e){var p=this&&this.__values||function(S){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var c=typeof Symbol=="function"&&Symbol.iterator,w=c&&S[c],E=0;if(w)return w.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&E>=S.length&&(S=void 0),{value:S&&S[E++],done:!S}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.getGC=e.GC=void 0;var V=function(){function S(c){this.parent_=this.object_=null,this.children_=[],this.object_=c}return S.prototype.addChild=function(c){c.parent_!=this&&(c.parent_=this,this.children_.push(c))},S.prototype.removeChild=function(c){var w=this.children_.indexOf(c);this.children_.splice(w,1),c.parent_=null},S}(),j=function(){function S(){this.root_=new V(null)}return S.prototype.trackObject=function(c,w){if(w===void 0&&(w=null),this.findNode(c,this.root_)===null){var E=this.findNode(w,this.root_),R=new V(c);E?E.addChild(R):this.root_.addChild(R)}},S.prototype.releaseObject=function(c){return c=this.findNode(c,this.root_),c===null||c===this.root_?!1:(this.destroyNodeObjectRecurse(c),c.parent_.removeChild(c),!0)},S.prototype.destroyNodeObjectRecurse=function(c){var w,E;try{for(var R=p(c.children_),_=R.next();!_.done;_=R.next())this.destroyNodeObjectRecurse(_.value)}catch(m){w={error:m}}finally{try{_&&!_.done&&(E=R.return)&&E.call(R)}finally{if(w)throw w.error}}c.object_.destroy()},S.prototype.setParent=function(c,w){var E=this.findNode(c,this.root_);if(E===null)return!1;var R=this.findNode(w,this.root_);return R===null?!1:(E.parent_===R||(E.parent_.removeChild(E),R.addChild(E)),!0)},S.prototype.reset=function(){this.root_.children_=[]},S.prototype.findNode=function(c,w){var E,R;if(w.object_===c)return w;var _=null;try{for(var m=p(w.children_),l=m.next();!l.done&&(_=this.findNode(c,l.value),_===null);l=m.next());}catch(t){E={error:t}}finally{try{l&&!l.done&&(R=m.return)&&R.call(m)}finally{if(E)throw E.error}}return _},S}();e.GC=j;var A=new j;e.getGC=function(){return A}},946:function(f,e,p){var V=this&&this.__extends||function(){var h=function(g,y){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,v){a.__proto__=v}||function(a,v){for(var d in v)v.hasOwnProperty(d)&&(a[d]=v[d])},h(g,y)};return function(g,y){function a(){this.constructor=g}h(g,y),g.prototype=y===null?Object.create(y):(a.prototype=y.prototype,new a)}}(),j=this&&this.__values||function(h){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var g=typeof Symbol=="function"&&Symbol.iterator,y=g&&h[g],a=0;if(y)return y.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&a>=h.length&&(h=void 0),{value:h&&h[a++],done:!h}}};throw new TypeError(g?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.getRedirector=e.HdxMediaStream=e.RedirectionStatus=e.WebrpcStatusCode=void 0;var A=p(610),S=p(851),c=p(550),w=p(545),E=p(394),R=p(691),_=p(121),m=function(h){function g(y,a,v,d,I,k,D,F){return F===void 0&&(F=void 0),y=h.call(this,y,a,I,F)||this,y.iid=v,y.oid=d,y.oneShot=k,y.mid=D,y}return V(g,h),g}(_.completion_base),l;(function(h){h[h.rpc_status_success=0]="rpc_status_success",h[h.rpc_status_unspecified_error=1]="rpc_status_unspecified_error",h[h.rpc_status_unexpected=2]="rpc_status_unexpected",h[h.rpc_status_index_out_of_bounds=3]="rpc_status_index_out_of_bounds",h[h.rpc_status_missing_parameter=4]="rpc_status_missing_parameter",h[h.rpc_status_missing_return_value=5]="rpc_status_missing_return_value",h[h.rpc_status_invalid_object=6]="rpc_status_invalid_object",h[h.rpc_status_user_exception=7]="rpc_status_user_exception",h[h.rpc_status_system_error=8]="rpc_status_system_error"})(l=e.WebrpcStatusCode||(e.WebrpcStatusCode={}));var t;(function(h){h[h.NotRedirected=0]="NotRedirected",h[h.Connecting=1]="Connecting",h[h.Binding=2]="Binding",h[h.Redirected=3]="Redirected"})(t=e.RedirectionStatus||(e.RedirectionStatus={})),f=function(){function h(){this.sessionId_="",this.pingactive=this.deiniting_=!1,this.status=t.NotRedirected,this.reqs=[],this.cbs=[],this.deferredActions=[],this.telemetry_=new E.Telemetry,this.screenshare_=new R.ScreenShareUtil,this.stateChangeNotifcations=[],this.vdafeatures_=[]}return Object.defineProperty(h.prototype,"telemetry",{get:function(){return this.telemetry_},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"screenshare",{get:function(){return this.screenshare_},enumerable:!1,configurable:!0}),h.prototype.setRemoteSessionInfoCb=function(g){this.remoteSessionInfoCb=g},h.prototype.setFeatures=function(g){this.features=g,this.screenshare.onInitComplete(),_.protocol_handler_manager.oninit(g,this.vdafeatures_)},h.prototype.getFeatureValue=function(g){if(this.features){var y=this.features.find(function(a){return a.name===g});return y!==void 0?y.value:!1}return!1},h.prototype.getVDAFeatureValue=function(g){return this.vdafeatures_.find(function(y){return y===g})!==void 0},h.prototype.onRedirectionComplete=function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.status==t.Redirected)},h.prototype.connectToService=function(){return S.logger.info("Redirection status: Connecting..."),this.status=t.Connecting,new Promise(function(g,y){var a=new WebSocket("wss://127.0.0.1:9002");a.onopen=function(){g(a)},a.onerror=function(v){S.logger.error("websocket connection error: "+v.type),y(v)}})},h.prototype.waitUntilRedirected=function(g){var y=this;return new Promise(function(a,v){y.status==t.Redirected?a():0>=g?(S.logger.error("waitUntilRedirected() timed out!"),v()):setTimeout(function(){S.logger.info("waitUntilRedirected() timeout. count="+g),y.status!=t.Redirected?y.waitUntilRedirected(--g).then(function(){a()}).catch(function(){S.logger.error("waitUntilRedirected() failure!"),v()}):a()},2e3)})},h.prototype.handleRemoteSessionInfo=function(){var g=this;S.logger.debug("handleRemoteSessionInfo called.");var y=this;y.remoteSessionInfoCb?y.remoteSessionInfoCb().then(function(a){S.logger.info("remoteSessionInfo success! info:"+JSON.stringify(a)),S.logger.info("Redirection status: Redirected"),y.status=t.Redirected,y.pingConnectionEnd(),(a=window.onVdiClientConnected)&&a(),g.telemetry.SendTelemetryInit(),y.onRedirectionComplete()}).catch(function(){S.logger.error("remoteSessionInfo failure!"),y.suspendRedirection(!0),y.onRedirectionComplete()}):(S.logger.error("remoteSessionInfoCb is invalid!"),y.suspendRedirection(!0),y.onRedirectionComplete())},h.prototype.startRedirection=function(g,y){var a=this,v=window.onVdiClientDisconnected;return new Promise(function(d,I){a.status!=t.Redirected?(S.logger.info("Attempting to start redirection: "+y),g===!1?a.deferredActions.push(new A.deferred_action(d,I,y)):a.connectToService().then(function(k){S.logger.info("Redirection status: Binding..."),a.status=t.Binding,a.websocket=k,a.websocket.onmessage=function(D){a.onWSMessage(D)},a.websocket.onclose=function(D){a.onWSClose(D)},d(),a.handleRemoteSessionInfo()}).catch(function(k){S.logger.error("Unable to connect to websocket service! "+k),I(),a.suspendRedirection(!0),a.onRedirectionComplete(),v&&v(!0)})):(S.logger.info("Redirection already started."),d())})},h.prototype.terminateOptimization=function(){this.websocket&&this.websocket.close(1e3,"normal disconnecting!")},h.prototype.suspendRedirection=function(g){var y=this;S.logger.info("Suspending redirection."),_.protocol_handler_manager.ondeinit();var d=window.onVdiClientDisconnected;try{d&&d(!1)}catch(D){S.logger.error("suspendRedirection(): exception during vdiClientDisconnect: "+D.message)}S.logger.info("Redirection status: NotRedirected");var a=this.status;this.status=t.NotRedirected;var v=!1,d=window.getCitrixMSTeamsRedir,I=window.getCitrixWebrtcRedir,k;d?k=d:I&&(k=I,this.deiniting_&&(window.onVdiClientDisconnected=void 0,this.deiniting_=!1)),k&&k().then(function(D){D=="1"&&(v=!0,S.logger.info("Reg key exists while disconnecting")),g&&a===t.Redirected&&v==1&&(S.logger.warning("Calling ping not normal disconnect"),y.pingConnectionBegin(!1))}).catch(function(){S.logger.error("Failure to Read MS Teams redir Reg Key, not retrying...")}),this.dispatchStateChangeNotifications()},h.prototype.onWSOpen=function(){},h.prototype.onWSClose=function(g){S.logger.info("disconnected from websocket service. "+JSON.stringify(g));try{g&&g.code==1e3?this.suspendRedirection(!1):this.suspendRedirection(!0)}catch(y){S.logger.error("suspendRedirection(): exception closing WebSocket: "+y.message)}},h.prototype.onWSError=function(){try{this.suspendRedirection(!0)}catch(g){S.logger.error("suspendRedirection(): exception on WebSocket error: "+g.message)}},h.prototype.WSSendObjectWrapper=function(g,y,a,v){var d,I,k=!0;y!=c.class_id_t.EngineControl||a!=c.method_id_EngineControl_t.ctor&&a!=c.method_id_EngineControl_t.version&&a!=c.method_id_EngineControl_t.feature_flags||(k=!1);var D=!0;if(k&&(D=!1,this.features!=null))try{for(var F=j(this.features),H=F.next();!H.done;H=F.next()){var L=H.value;if(L.value===!0&&L.name==g){D=!0;break}}}catch(z){d={error:z}}finally{try{H&&!H.done&&(I=F.return)&&I.call(F)}finally{if(d)throw d.error}}return D==1?this.WSSendObject(v):(g="Cannot invoke method that is not supported by webrpc: iid("+y+") mid("+a+")",S.logger.error(g),Promise.reject(g))},h.prototype.WSSendObject=function(g){var y=this;return new Promise(function(a,v){if(g.v=="webrtc"){var d=g.hdr.proc.iid,I=g.hdr.proc.methodid,k=g.objref.oid;g.hdr.destroy||(d=new m(a,v,d,k,0,!0,I),y.reqs.push(d)),d=JSON.stringify(g),S.logger.trace("WSSendObject: >>> "+c.WebrpcClassLibInfoUtil.composeClassInfoData(g)+" "+d);try{y.websocket.readyState==WebSocket.OPEN?y.websocket.send(d):(S.logger.info("WSSendObject(): warning: web socket is not open, dropping the message!"),a({}))}catch(D){S.logger.error("WSSendObject(): exception: "+D.message),v(D.message)}}else if(g.v=="overlay"){d=JSON.stringify(g),S.logger.trace("HDXMS: SendOverlayData: >>> "+d+"'");try{y.websocket.readyState==WebSocket.OPEN?y.websocket.send(d):S.logger.info("WSSendObject(): warning: web socket is not open, dropping the message!"),a({})}catch(D){S.logger.error("WSSendObject(): exception: "+D.message),v(D.message)}}else if(g.v=="telemetry"){d=JSON.stringify(g),S.logger.trace("HDXMS: SendTelemetryData: >>> "+d+"'");try{y.websocket.readyState==WebSocket.OPEN?y.websocket.send(d):S.logger.info("WSSendObject(): warning: web socket is not open, dropping the message!"),a({})}catch(D){S.logger.error("WSSendObject(): exception: "+D.message),v(D.message)}}else if(g.v=="appsharing"){d=JSON.stringify(g),S.logger.trace("HDXMS: SendScreenSharingData: >>> "+d+"'");try{y.websocket.readyState==WebSocket.OPEN?y.websocket.send(d):S.logger.info("WSSendObject(): warning: web socket is not open, dropping the message!"),a({})}catch(D){S.logger.error("WSSendObject(): exception: "+D.message),v(D.message)}}else if(g.v=="logging"){d=JSON.stringify(g);try{y.websocket&&y.websocket.readyState==WebSocket.OPEN&&y.websocket.send(d),a({})}catch(D){v(D.message)}}else S.logger.error("HDXMS: WSSendObject: Unknown protocol: '"+JSON.stringify(g)+"'")})},h.prototype.webrpcStatusCodeToName=function(g){switch(g){case l.rpc_status_success:g="rpc_status_success";break;case l.rpc_status_unspecified_error:g="rpc_status_unspecified_error";break;case l.rpc_status_unexpected:g="rpc_status_unexpected";break;case l.rpc_status_index_out_of_bounds:g="rpc_status_index_out_of_bounds";break;case l.rpc_status_missing_parameter:g="rpc_status_missing_parameter";break;case l.rpc_status_missing_return_value:g="rpc_status_missing_return_value";break;case l.rpc_status_invalid_object:g="rpc_status_invalid_object";break;case l.rpc_status_user_exception:g="rpc_status_user_exception";break;case l.rpc_status_system_error:g="rpc_status_system_error";break;default:g="unknown"}return g},h.prototype.parceWebrpcError=function(g,y){g===void 0&&(g=y&&0<y.length?y[0].category||y[0].code||y[0].message?l.rpc_status_system_error:l.rpc_status_user_exception:l.rpc_status_unspecified_error);var a;switch(g){case l.rpc_status_unspecified_error:case l.rpc_status_unexpected:case l.rpc_status_index_out_of_bounds:case l.rpc_status_missing_parameter:case l.rpc_status_missing_return_value:case l.rpc_status_invalid_object:a=new DOMException(this.webrpcStatusCodeToName(g),this.webrpcStatusCodeToName(g));break;case l.rpc_status_user_exception:a=y&&0<y.length?new DOMException(y[0],this.webrpcStatusCodeToName(g)):new DOMException(this.webrpcStatusCodeToName(g),this.webrpcStatusCodeToName(g));break;case l.rpc_status_system_error:if(y&&0<y.length){a=Object.create(DOMException);var v={value:null,writable:!0,enumerable:!1,Configurable:!0};v.value=y[0].category,Object.defineProperty(a,"name",v),v.value=y[0].code,Object.defineProperty(a,"code",v),v.value=y[0].message,Object.defineProperty(a,"message",v)}else a=new DOMException(this.webrpcStatusCodeToName(g),this.webrpcStatusCodeToName(g))}return a},h.prototype.onWSMessage=function(g){var y,a;g=g.data;var v;try{v=JSON.parse(g)}catch(L){S.logger.error("onWSMessage: invalid JSON! err: "+L+", data: "+g);return}if(v.v=="webrtc"){S.logger.trace("onWSMessage: <<< "+c.WebrpcClassLibInfoUtil.composeClassInfoData(v)+" "+g);var d=v.hdr.proc.iid,I=v.hdr.proc.methodid,k=v.objref.oid;if(y=v.status,v.hdr.msg_type==w.WsJsonUtil.getMsgType(w.ws_msg_type_t.reply))a=this.reqs.findIndex(function(L){return L.iid==d&&L.oid==k&&L.mid==I}),0<=a?y==0?this.reqs.splice(a,1).shift().resolve(v):(v=this.parceWebrpcError(y,v.params),this.reqs.splice(a,1).shift().reject(v)):S.logger.warning("HDXMS didnt find this one. (reqs)"+JSON.stringify(this.reqs));else if(v.hdr.msg_type==w.WsJsonUtil.getMsgType(w.ws_msg_type_t.event_req)){var D=v.func.id;a=this.cbs.findIndex(function(L){return L.iid==d&&L.oid==k&&L.cbid==D>>16}),0<=a?((D&65535)==0?this.cbs[a].resolve(v):(v=this.parceWebrpcError(y,v.params),this.cbs[a].reject(v)),this.cbs[a].oneShot==1&&(this.cbs[a].completion_cb?this.cbs[a].completion_cb(this.cbs[a].cbid,this.cbs[a].mid):S.logger.warning("HDXMS didnt find completion_cb for oneShot callback, something went wrong!!!! cbid="+this.cbs[a].cbid+" (iid, mid)=("+this.cbs[a].iid,","+this.cbs[a].mid+")"))):S.logger.warning("HDXMS didnt find this one. (cbs)"+JSON.stringify(this.cbs))}else S.logger.warning("HDXMS Received bogus message: '"+g+"'")}else if(v.v=="telemetry")v.status==0&&(a=v.hdr.command,(a&2147483647)==2&&(y=v.hdr.id,this.telemetry.onInitialized(y),S.logger.info("Telemetry init response received")));else if(v.v=="features"){if(g=v.features,v.command=="feature-support"){S.logger.info("features capabilities received, features:"+g),this.vdafeatures_=g;try{for(var F=j(g),H=F.next();!H.done;H=F.next())H.value===c.FEATURE_vda_app_sharing&&this.screenshare.onInitialized(!0)}catch(L){y={error:L}}finally{try{H&&!H.done&&(a=F.return)&&a.call(F)}finally{if(y)throw y.error}}}this.clientViewportMode_=v.client_viewport_mode,S.logger.info("features client_viewport_mode value: "+this.clientViewportMode_),this.sessionId_=v.client_session_id}else v.v=="appsharing"?(y=v.status,y==0?(a=v.hdr.command,y=v.hdr.id,(a&2147483647)==R.sshare_cmd.GetSources?(S.logger.info("appsharing GetSources response received"),v=v.data,this.screenshare.onGetSources(y,v)):(a&2147483647)==R.sshare_cmd.SetActive?(S.logger.info("appsharing SetActive response received"),v=v.data,this.screenshare.onSetActive(y,v)):(a&2147483647)==R.sshare_cmd.TopologyChanged?(S.logger.info("appsharing Window topology changed cmd received"),this.screenshare.onToplogyChanged()):(S.logger.error("appsharing invalid command reply:"+a),this.screenshare.onError(y))):(S.logger.error("invalid status reply:"+y),y=v.hdr.id,this.screenshare.onError(y))):(y=_.protocol_handler_manager.findHandler(v.v),y!=null?y.on_message(v):S.logger.warning("HDXMS: onWSMessage: Unknown protocol: "+g+"'"))},h.prototype.clearReqs=function(){S.logger.info("clearReqs()"),this.reqs.forEach(function(g,y){g.reject()}),this.reqs=[]},h.prototype.registerHandler=function(g,y,a,v){g=new m(v.resolve.bind(v),v.reject.bind(v),g,y,v.id,v.oneShot,a,v.completion_cb),this.cbs.push(g)},h.prototype.unregisterHandler=function(g,y,a){var v=this.cbs.findIndex(function(d){return d.iid==g&&d.oid==y&&d.cbid==a});0<=v?this.cbs.splice(v,1):S.logger.warning("HDXMS Didnt find this callback in the list! list: "+JSON.stringify(this.cbs))},h.prototype.isRedirected=function(){return this.status===t.Redirected||this.status===t.Binding||this.status===t.Connecting},h.prototype.isConnected=function(){return this.status==t.Redirected},h.prototype.isPingActive=function(){return this.pingactive},h.prototype.pingConnectionBegin=function(g){S.logger.info("Started timer"),this.pingactive=!0;var y=window.onVdiClientDisconnectedTimer;g==1?(S.logger.info("checking if we are connected..."),y()):this.conntimer=setTimeout(function(){S.logger.info("checking if we are connected..."),y&&y()},15e3)},h.prototype.pingConnectionEnd=function(){this.pingactive=!1,clearTimeout(this.conntimer)},h.prototype.SendTelemetryData_Speaker=function(g){this.telemetry.SendTelemetryData(E.tel_cmd.Data,E.tel_key_SpeakerDeviceUsed,g,0)},h.prototype.registerStateChangeNotification=function(g){this.stateChangeNotifcations.push(g)},h.prototype.unregisterStateChangeNotification=function(g){this.stateChangeNotifcations=this.stateChangeNotifcations.filter(function(y){return y!=g})},h.prototype.dispatchStateChangeNotifications=function(){this.stateChangeNotifcations.forEach(function(g){g()})},h.prototype.vdabufferNoLimit=function(){var g,y,a=!1;try{for(var v=j(this.vdafeatures_),d=v.next();!d.done;d=v.next())if(d.value===c.FEATURE_vda_service_no_buffer_limit){a=!0;break}}catch(I){g={error:I}}finally{try{d&&!d.done&&(y=v.return)&&y.call(v)}finally{if(g)throw g.error}}return a},Object.defineProperty(h.prototype,"clientViewportMode",{get:function(){return this.clientViewportMode_||"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"sessionClientId",{get:function(){return this.sessionId_||""},enumerable:!1,configurable:!0}),h.prototype.setDeiniting=function(){this.deiniting_=!0},h}(),e.HdxMediaStream=f;var u=new f;e.getRedirector=function(){return u}},985:function(f,e,p){var V=this&&this.__extends||function(){var E=function(R,_){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,l){m.__proto__=l}||function(m,l){for(var t in l)l.hasOwnProperty(t)&&(m[t]=l[t])},E(R,_)};return function(R,_){function m(){this.constructor=R}E(R,_),R.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)}}(),j=this&&this.__read||function(E,R){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var _=typeof Symbol=="function"&&E[Symbol.iterator];if(!_)return E;var m=_.call(E),l,t=[],u;try{for(;(R===void 0||0<R--)&&!(l=m.next()).done;)t.push(l.value)}catch(h){u={error:h}}finally{try{l&&!l.done&&(_=m.return)&&_.call(m)}finally{if(u)throw u.error}}return t},A=this&&this.__spread||function(){for(var E=[],R=0;R<arguments.length;R++)E=E.concat(j(arguments[R]));return E};Object.defineProperty(e,"__esModule",{value:!0}),e.IceCandidatePair=e.IceCandidate=void 0;var S=p(658),c=p(550),w=p(851);f=function(E){function R(_,m,l){for(var t=[],u=3;u<arguments.length;u++)t[u-3]=arguments[u];return E.apply(this,A([_,c.class_id_t.RTCIceCandidate,m,l,null,[]],t))||this}return V(R,E),Object.defineProperty(R.prototype,"candidate",{get:function(){return this.candidate_},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"sdpMid",{get:function(){return this.sdpMid_},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"sdpMLineIndex",{get:function(){return this.sdpMLineIndex_},enumerable:!1,configurable:!0}),R.prototype.syncBarrier=function(){var _=this;return w.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(m,l){_.syncBarrierDeep(m,l)&&_.waitUntilConnected("IceCandidate.syncBarrier").then(function(){return Promise.all([_.remoteInvoke(!1,c.method_id_RTCIceCandidate_t.candidate,""),_.remoteInvoke(!1,c.method_id_RTCIceCandidate_t.sdpMid,""),_.remoteInvoke(!1,c.method_id_RTCIceCandidate_t.sdpMLineIndex,0)])}).then(function(t){t=j(t.map(function(u){return _.param0(u)}),3),_.candidate_=t[0],_.sdpMid_=t[1],_.sdpMLineIndex_=t[2],_.syncBarrierResolve(_)}).catch(function(t){t=_.logRemoteInvokeError(t,".syncBarrier failed!"),_.syncBarrierReject(t)})})},R}(S.ProxyObject),e.IceCandidate=f,f=function(E){function R(_,m){return E.call(this,_,c.class_id_t.RTCIceCandidatePair,m,S.ProxyMode.Remote)||this}return V(R,E),Object.defineProperty(R.prototype,"local",{get:function(){return this.local_},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"remote",{get:function(){return this.remote_},enumerable:!1,configurable:!0}),R.prototype.syncBarrier=function(){var _=this;return w.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(m,l){_.syncBarrierDeep(m,l)&&_.waitUntilConnected("IceCandidatePair.syncBarrier").then(function(){return Promise.all([_.remoteInvoke(!1,c.method_id_RTCIceCandidatePair_t.local,{}),_.remoteInvoke(!1,c.method_id_RTCIceCandidatePair_t.remote,{})])}).then(function(t){t=j(t.map(function(u){return _.param0(u)}),2),_.local_=t[0],_.remote_=t[1],_.syncBarrierResolve(_)}).catch(function(t){t=_.logRemoteInvokeError(t,".syncBarrier failed!"),_.syncBarrierReject(t)})})},R}(S.ProxyObject),e.IceCandidatePair=f},851:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.logger=e.Logger=void 0;var V=p(550),j=p(93),A=p(698),S=j.LogLevel.Info;f=function(){function c(w){var E=this;w===void 0&&(w="[HdxWebRTC.js]"),this.enabled_=!0,this.mslogger_=void 0,this.level_=S,this.enable_timestamp_=this.configuration_received_=!1,this.deferredLogs_=[],this.buffer_size_max_=10,this.intervalID_=0,this.flush=function(){0<E.deferredLogs_.length&&(E.protocol_.log(E.deferredLogs_),E.deferredLogs_=[])},this.tag_=w,V.BUILD_TYPE_SDK&&(this.enable_timestamp_=!0),this.protocol_=new A.LoggingProtocol(function(R){E.info(E.user_friendly_id()+" - Received Capabilities Cmd with caps = "+JSON.stringify(R)),E.protocol_.configure(E.appInfo_).then(function(_){var m=_.level,l=_.delay;_=_.buffer_size_max,E.info(E.user_friendly_id()+"- Configure Response received with level = "+m+", delay = "+l+", buffer_size_max = "+_),E.configuration_received_=!0,E.level_=m,E.deferredLogs_=E.deferredLogs_.filter(function(t){return t.level>=E.level_}),E.delay_=l,E.buffer_size_max_=_,E.intervalID_=setInterval(E.flush,1e3*E.delay_)}).catch(function(_){E.error(_)})},function(){clearInterval(E.intervalID_),E.deferredLogs_=[],E.level_=S})}return c.prototype.setInstanceId=function(w){this.instanceId_=w},c.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.instanceId_+"]"},c.prototype.log=function(w){for(var E=[],R=1;R<arguments.length;R++)E[R-1]=arguments[R];if(this.enabled_&&!(w<this.level_)){var E=this.tag_+" "+E,_=new Date,R=_.getTime(),_=_.toISOString();this.protocol_.isEnabled()&&(this.deferredLogs_.push({level:w,msg:"["+R+"] "+_+" "+j.LogLevel[w].toUpperCase()+" "+E}),this.configuration_received_&&this.deferredLogs_.length>this.buffer_size_max_&&this.flush()),this.enable_timestamp_&&(E="["+R+"] "+_+" "+E),this.mslogger_!==void 0?this.mslogger_.info(E):console.log(E)}},c.prototype.setMSLogger=function(w,E){this.mslogger_=w,E!=null&&(this.enable_timestamp_=E)},Object.defineProperty(c.prototype,"appInfo",{set:function(w){this.appInfo_=w},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"level",{set:function(w){this.level_=w},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"enable",{set:function(w){this.enabled_=w},enumerable:!1,configurable:!0}),c.prototype.trace=function(){for(var w=[],E=0;E<arguments.length;E++)w[E]=arguments[E];this.log(j.LogLevel.Trace,w)},c.prototype.debug=function(){for(var w=[],E=0;E<arguments.length;E++)w[E]=arguments[E];this.log(j.LogLevel.Debug,w)},c.prototype.info=function(){for(var w=[],E=0;E<arguments.length;E++)w[E]=arguments[E];this.log(j.LogLevel.Info,w)},c.prototype.warning=function(){for(var w=[],E=0;E<arguments.length;E++)w[E]=arguments[E];this.log(j.LogLevel.Warning,w)},c.prototype.error=function(){for(var w=[],E=0;E<arguments.length;E++)w[E]=arguments[E];this.log(j.LogLevel.Error,w)},c.prototype.cleanup=function(){this.flush()},c}(),e.Logger=f,e.logger=new f},93:function(f,e){Object.defineProperty(e,"__esModule",{value:!0}),e.LogLevel=void 0;var p=e.LogLevel||(e.LogLevel={});p[p.Trace=0]="Trace",p[p.Debug=1]="Debug",p[p.Info=2]="Info",p[p.Warning=3]="Warning",p[p.Error=4]="Error"},698:function(f,e,p){var V=this&&this.__extends||function(){var c=function(w,E){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,_){R.__proto__=_}||function(R,_){for(var m in _)_.hasOwnProperty(m)&&(R[m]=_[m])},c(w,E)};return function(w,E){function R(){this.constructor=w}c(w,E),w.prototype=E===null?Object.create(E):(R.prototype=E.prototype,new R)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.LoggingProtocol=void 0;var j=p(946),A=p(121),S;(function(c){c[c.UNINITIALIZED=0]="UNINITIALIZED",c[c.ENABLED=1]="ENABLED",c[c.DISABLED=2]="DISABLED"})(S||(S={})),f=function(c){function w(E,R){var _=c.call(this)||this;return _.name="logging",_.state_=S.UNINITIALIZED,_.handleFailedHandshake=function(){_.state_===S.UNINITIALIZED&&_.disable()},A.protocol_handler_manager.addProtocolHandler(_),_.onCapsReceivedCb=E,_.onDisableCb=R,_}return V(w,c),w.prototype.disable=function(){this.state_=S.DISABLED,this.onDisableCb()},w.prototype.init=function(E,R){var _=this;R.find(function(m){return m===_.name})===void 0&&this.disable()},w.prototype.deinit=function(){this.clearRequests(),this.clearCallbacks()},w.prototype.on_message=function(E){if(E.command==="capabilities")j.getRedirector().WSSendObject({v:this.name,command:"capabilities",caps:[]}),this.onCapsReceivedCb(E.caps);else if(E.command==="configure"){var R=this.processResponseEx(Number(E.req_id));R!==void 0?E.status===!0?(this.state_=S.ENABLED,R.resolve({level:E.level,delay:E.delay,buffer_size_max:E.buffer_size_max})):(this.disable(),R.reject("failed to configure logging protocol on agent!")):this.disable()}else E.command==="shutdown"&&this.disable()},w.prototype.isEnabled=function(){return this.state_===S.UNINITIALIZED||this.state_===S.ENABLED},w.prototype.configure=function(E){var R=this;return new Promise(function(_,m){var l=R.processRequestEx(_,m);j.getRedirector().WSSendObject({v:R.name,command:"configure",req_id:String(l),client_info:E.clientInfo,vendor_name:E.vendorName}),setTimeout(R.handleFailedHandshake,6e4)})},w.prototype.log=function(E){j.getRedirector().WSSendObject({v:this.name,command:"log",data:E})},w}(A.protocol_base),e.LoggingProtocol=f},293:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.number_allocator=void 0;var V=p(851);f=function(){function j(A,S,c){this.min_=A<j.BOUND_LOW||A>j.BOUND_HIGH?j.DEF_MIN:A,this.max_=S<j.BOUND_LOW||S>j.BOUND_HIGH?j.DEF_MAX:S,this.interval_=c<j.BOUND_LOW||c>j.BOUND_HIGH?j.DEF_INTERVAL:c,this.numbers_=new Map,this.numbers_.set(this.min_,this.max_)}return Object.defineProperty(j.prototype,"max",{get:function(){return this.max_},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"min",{get:function(){return this.min_},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"interval",{get:function(){return this.interval_},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"numbers",{get:function(){return this.numbers_},enumerable:!1,configurable:!0}),j.prototype.allocate=function(){var A=-1;if(0<this.numbers_.size){var S=Array.from(this.numbers_.keys()).sort(function(w,E){return w-E})[0],c=this.numbers_.get(S);V.logger.debug("low="+S+" this.min="+this.min_+" this.interval="+this.interval_),A=this.min_+(S-this.min_)*this.interval_,this.numbers_.delete(S),S+=1,S<c&&this.numbers_.set(S,c)}return A},j.prototype.deallocate=function(A){var S=Array.from(this.numbers_.keys()).sort(function(E,R){return E-R});A=(A-this.min_)/this.interval_;for(var c=!1,w=0;w<S.length&&(S[w]==A+1?(this.numbers_.set(A,this.numbers_.get(S[w])),this.numbers_.delete(S[w]),c=!0):this.numbers_.get(S[w])==A&&(this.numbers_.set(S[w],A+1),w+1<S.length&&S[w+1]==A+1&&(this.numbers_.set(S[w],this.numbers_.get(S[w+1])),this.numbers_.delete(S[w+1])),c=!0),!c);w++);c||this.numbers_.set(A,A+1)},j.BOUND_LOW=0,j.BOUND_HIGH=4294967295,j.DEF_MIN=0,j.DEF_MAX=1024,j.DEF_INTERVAL=1,j}(),e.number_allocator=f},360:function(f,e,p){var V=this&&this.__extends||function(){var i=function(s,r){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,b){o.__proto__=b}||function(o,b){for(var T in b)b.hasOwnProperty(T)&&(o[T]=b[T])},i(s,r)};return function(s,r){function o(){this.constructor=s}i(s,r),s.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}}(),j=this&&this.__awaiter||function(i,s,r,o){function b(T){return T instanceof r?T:new r(function(O){O(T)})}return new(r||(r=Promise))(function(T,O){function x(G){try{n(o.next(G))}catch(K){O(K)}}function N(G){try{n(o.throw(G))}catch(K){O(K)}}function n(G){G.done?T(G.value):b(G.value).then(x,N)}n((o=o.apply(i,s||[])).next())})},A=this&&this.__generator||function(i,s){function r(n){return function(G){return o([n,G])}}function o(n){if(T)throw new TypeError("Generator is already executing.");for(;b;)try{if(T=1,O&&(x=n[0]&2?O.return:n[0]?O.throw||((x=O.return)&&x.call(O),0):O.next)&&!(x=x.call(O,n[1])).done)return x;switch(O=0,x&&(n=[n[0]&2,x.value]),n[0]){case 0:case 1:x=n;break;case 4:return b.label++,{value:n[1],done:!1};case 5:b.label++,O=n[1],n=[0];continue;case 7:n=b.ops.pop(),b.trys.pop();continue;default:if(x=b.trys,!(x=0<x.length&&x[x.length-1])&&(n[0]===6||n[0]===2)){b=0;continue}if(n[0]===3&&(!x||n[1]>x[0]&&n[1]<x[3]))b.label=n[1];else if(n[0]===6&&b.label<x[1])b.label=x[1],x=n;else if(x&&b.label<x[2])b.label=x[2],b.ops.push(n);else{x[2]&&b.ops.pop(),b.trys.pop();continue}}n=s.call(i,b)}catch(G){n=[6,G],O=0}finally{T=x=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var b={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},T,O,x,N;return P.initSymbol(),P.initSymbol(),P.initSymbolIterator(),N={next:r(0),throw:r(1),return:r(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N},S=this&&this.__values||function(i){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var s=typeof Symbol=="function"&&Symbol.iterator,r=s&&i[s],o=0;if(r)return r.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&o>=i.length&&(i=void 0),{value:i&&i[o++],done:!i}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(i,s){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var o=r.call(i),b,T=[],O;try{for(;(s===void 0||0<s--)&&!(b=o.next()).done;)T.push(b.value)}catch(x){O={error:x}}finally{try{b&&!b.done&&(r=o.return)&&r.call(o)}finally{if(O)throw O.error}}return T},w=this&&this.__spread||function(){for(var i=[],s=0;s<arguments.length;s++)i=i.concat(c(arguments[s]));return i};Object.defineProperty(e,"__esModule",{value:!0}),e.PeerConnection=e.SessionDescription=e.SessionDescriptionInit=e.RtcConfiguration=e.RtcIceServer=e.IceCandidateEvent=void 0;var E=p(946),R=p(144),_=p(589),m=p(658),l=p(610),t=p(985),u=p(377),h=p(650),g=p(24),y=p(550),a=p(851),v=p(517),d=p(394),I=function(i){function s(r,o,b){return r=i.call(this,r,y.class_id_t.RTCIceCandidateEvent,o,m.ProxyMode.Remote)||this,r.target=b,r.type="icecandidate",r}return V(s,i),Object.defineProperty(s.prototype,"candidate",{get:function(){return this.candidate_},enumerable:!1,configurable:!0}),s.prototype.syncBarrier=function(){var r=this;return a.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(o,b){r.syncBarrierDeep(o,b)&&r.waitUntilConnected(r.user_friendly_id()+".syncBarrier").then(function(){return r.remoteInvoke(!1,y.method_id_RTCIceCandidateEvent_t.candidate,{oid:0})}).then(function(T){return T=r.param0(T),T.is_null===!1?new t.IceCandidate(r,T.oid,m.ProxyMode.Remote).syncBarrier():Promise.resolve(null)}).then(function(T){a.logger.info(r.user_friendly_id()+".onicecandidate: icecandidate available!"),r.candidate_=T,r.syncBarrierResolve(r)}).catch(function(T){T=r.logRemoteInvokeError(T,".onicecandidate() failed!"),r.syncBarrierReject(T)})})},s}(m.ProxyObject);e.IceCandidateEvent=I;var k=function(){function i(s,r){this.state_="new",this.candidates_=[],this.gatheringstateupdatecb_=void 0,this.pc_=s,this.gatheringstateupdatecb_=r}return i.prototype.pushState=function(s){a.logger.info(this.pc_.user_friendly_id()+".onicegatheringstatechange: new state is "+s),this.state_=s,this.state_=="gathering"?(this.candidates_=[],this.postUpdate()):this.processRemaining()},i.prototype.addIceCandidate=function(s){var r=this;this.candidates_.push(s);var o=[];o.push(s.syncBarrier()),o.push(this.pc_.updateSdpDescription(!0)),Promise.all(o).then(function(b){a.logger.info(r.pc_.user_friendly_id()+".onicecandidate: icecandidate available!"),r.postIceCandidate(b[0])})},i.prototype.postIceCandidate=function(s){a.logger.info(this.pc_.user_friendly_id()+".onicecandidate: posting ice candidate now!"),this.pc_.onicecandidate!=null?this.pc_.onicecandidate(s):a.logger.warning(this.pc_.user_friendly_id()+"onicecandidate is NULL!!!"),this.candidates_.shift(),this.processRemaining()},i.prototype.postUpdate=function(){a.logger.info(this.pc_.user_friendly_id()+".onicegatheringstatechange: posting event now!");var s=new z("onicegatheringstatechange",this.pc_);this.gatheringstateupdatecb_&&this.gatheringstateupdatecb_(this.state_),this.pc_.onicegatheringstatechange(s)},i.prototype.processRemaining=function(){this.candidates_.length==0&&this.state_=="complete"?this.pc_.onicecandidate!=null&&(this.pc_.onicecandidate({candidate:null,target:this}),this.postUpdate()):a.logger.info(this.pc_.user_friendly_id()+".onicecandidate: candidates remaining=["+this.candidates_.map(function(s){return s.object_id()})+"], state="+this.state_)},i}(),D=function(){function i(){}return i.toRtcIceServer=function(s,r){var o={urls:[],credential:"",username:""};if(s&&(s.urls?Array.isArray(s.urls)?o.urls=s.urls:o.urls.push(s.urls):a.logger.warning("RtcIceServer.toRtcIceServer().urls property is missing! this is required property!"),s.credential&&(s.credential.hasOwnProperty("accessToken")?o.credential=s.credential.accessToken:o.credential=s.credential),s.username&&(o.username=s.username)),r==1)for(var b in s)b!="urls"&&b!="credential"&&b!="username"&&a.logger.warning("RtcIceServer.toRtcIceServer() unsupported property:"+b);return o},i}();e.RtcIceServer=D;var F=function(){function i(){}return i.toRtcConfiguration=function(s,r){var o,b;r==1&&a.logger.info("RtcConfiguration.toRtcConfiguration() in RTCConfiguration config:"+JSON.stringify(s));var T={};if(s){if(s.iceServers){T.iceServers=[];try{for(var O=S(s.iceServers),x=O.next();!x.done;x=O.next())T.iceServers.push(D.toRtcIceServer(x.value,r))}catch(n){o={error:n}}finally{try{x&&!x.done&&(b=O.return)&&b.call(O)}finally{if(o)throw o.error}}}s.iceTransportPolicy&&(T.iceTransportPolicy=s.iceTransportPolicy),s.bundlePolicy&&(T.bundlePolicy=s.bundlePolicy),s.rtcpMuxPolicy&&(T.rtcpMuxPolicy=s.rtcpMuxPolicy),s.iceTransports&&(T.iceTransports=s.iceTransports),s.sdpSemantics&&(T.sdpSemantics=s.sdpSemantics),s.enableDtlsSrtp&&(T.enableDtlsSrtp=s.enableDtlsSrtp),s.enableDscp&&(T.enableDscp=s.enableDscp)}if(r==1){for(var N in s)N!="iceServers"&&N!="iceTransportPolicy"&&N!="bundlePolicy"&&N!="rtcpMuxPolicy"&&N!="iceTransports"&&N!="sdpSemantics"&&N!="enableDtlsSrtp"&&N!="enableDscp"&&a.logger.warning("RtcConfiguration.toRtcConfiguration() warning: unsupported property:"+N);a.logger.info("RtcConfiguration.toRtcConfiguration() converted RtcConfiguration config:"+JSON.stringify(T))}return T},i}();e.RtcConfiguration=F;var H=function(){return function(i,s){this.sdp=s,this.type=i}}();e.SessionDescriptionInit=H;var L=function(i){function s(r,o,b){for(var T=[],O=3;O<arguments.length;O++)T[O-3]=arguments[O];return i.apply(this,w([r,y.class_id_t.RTCSessionDescription,o,b,null,[]],T))||this}return V(s,i),s.prototype.toJSON=function(){return{type:this.type_,sdp:this.sdp_}},Object.defineProperty(s.prototype,"sdp",{get:function(){return this.sdp_},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"type",{get:function(){return this.type_},enumerable:!1,configurable:!0}),s.prototype.syncBarrier=function(){var r=this;return a.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(o,b){r.syncBarrierDeep(o,b)&&r.waitUntilConnected(r.user_friendly_id()+".syncBarrier").then(function(){return Promise.all([r.remoteInvoke(!1,y.method_id_RTCSessionDescription_t.type,0),r.remoteInvoke(!1,y.method_id_RTCSessionDescription_t.sdp,"")])}).then(function(T){r.type_=r.convertType(r.param0(T[0])),r.sdp_=r.param0(T[1]),r.syncBarrierResolve(r)}).catch(function(T){T=r.logRemoteInvokeError(T,".syncBarrier() failed!"),r.syncBarrierReject(T)})})},s.prototype.convertType=function(r){return r==0?"offer":r==1?"pranswer":r==2?"answer":"rollback"},s.convertC2H=function(r){return r=="offer"?0:r=="pranswer"?1:r=="answer"?2:3},s}(m.ProxyObject);e.SessionDescription=L;var z=function(){return function(i,s){this.type=i,this.target=s}}(),U=function(){return function(){}}(),C=function(){function i(s,r){this.local=s,this.remote=r}return Object.defineProperty(i.prototype,"active",{get:function(){var s=!1;return(this.local==1||this.remote==1)&&(s=!0),s},enumerable:!1,configurable:!0}),i}();f=function(i){function s(r){var o=i.call(this,null,y.class_id_t.RTCPeerConnection,0,m.ProxyMode.Local,null,[],s.ensure_config_defined(r,!1),{})||this;if(o.timeerstarted_=!1,o.firsttimeremoteoffer_=!1,o.firststable_=!1,o.firsttimelocaloffer_=!1,o.audiocall_=new C(!1,!1),o.videocall_=new C(!1,!1),o.screensharingcall_=new C(!1,!1),o.conferencecall_=!1,o.incomingcall_=!1,o.outgoingcall_=!1,o.usingasynconly_=!1,o.rtcconfig_=s.ensure_config_defined(r,!0),a.logger.info(o.user_friendly_id()+".constructor sdpSemantics="+o.rtcconfig_.sdpSemantics),!y.BUILD_TYPE_SDK&&o.isUnified()&&!E.getRedirector().getFeatureValue(y.FEATURE_ms_teams_webrtc_1dot0))throw new DOMException("CWA client does not support unified sdpSemantic","createPeerConnection");return o.pendingtransceiver_=0,o.pendingtrack_=0,o.deferredOfferAnswers=[],o.localStreams=[],o.remoteStreams=[],o.onaddstream_=null,o.signalingState_="stable",o.iceConnectionState_="new",o.iceGatheringState_="new",o.iceQ_=new k(o,function(b){o.onicegatheringstateupdate(b)}),o.receivers_=[],o.senders_=[],o.transceivers_=[],o.registerStateChangeNotification(o.onStateChange),o.localdatachannel_=null,o.remotedatachannel_=null,o}return V(s,i),s.ensure_config_defined=function(r,o){return F.toRtcConfiguration(r,o)},s.prototype.dumpSdp=function(r){a.logger.debug(this.user_friendly_id()+".dumpSdp"),r&&a.logger.debug(this.user_friendly_id()+" type: "+r.type+", sdp: "+r.sdp)},Object.defineProperty(s.prototype,"localDescription",{get:function(){return a.logger.trace(this.user_friendly_id()+".get_localDescription() called."),this.localDescription_},set:function(r){a.logger.debug(this.user_friendly_id()+".set_localDescription() called."),this.localDescription_=r},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"remoteDescription",{get:function(){return a.logger.trace(this.user_friendly_id()+".get_remoteDescription() called."),this.remoteDescription_},set:function(r){a.logger.debug(this.user_friendly_id()+".get_remoteDescription() called."),this.remoteDescription_=r},enumerable:!1,configurable:!0}),s.prototype.isUnified=function(){return this.rtcconfig_.sdpSemantics=="unified"||this.rtcconfig_.sdpSemantics=="unified-plan"},s.prototype.onStateChange=function(){var r=new z("iceconnectionstatechange",this);this.oniceconnectionstatechange_&&this.oniceconnectionstatechange_(r)},s.prototype.addIceCandidate=function(r){var o=this;a.logger.debug(this.user_friendly_id()+".addIceCandidate() called."),this.waitUntilConnected(this.user_friendly_id()+".addIceCandidate").then(function(){var b={candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex};return(b.candidate==null||b.candidate==null)&&(b.candidate=""),b.sdpMid==null&&(b.sdpMid=null),b.sdpMLineIndex==null&&(b.sdpMLineIndex=null),new t.IceCandidate(o,0,m.ProxyMode.Local,b).syncBarrier()}).then(function(b){return o.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.addIceCandidate,[b],{})}).then(function(){return a.logger.debug(o.user_friendly_id()+".addIceCandidate() success."),o.updateSdpDescription(!1)}).then(function(){a.logger.info(o.user_friendly_id()+".addIceCandidate() - sync remote sdp success.")}).catch(function(b){o.logRemoteInvokeError(b,".addIceCandidate() failed!")})},Object.defineProperty(s.prototype,"onicecandidate",{get:function(){return this.onicecandidate_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_onicecandidate() called."),this.onicecandidate_=r,this.waitUntilConnected(this.user_friendly_id()+".onicecandidate").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.onicecandidate);return b.then(function(T){a.logger.info(o.user_friendly_id()+".onicecandidate callback received!!!"),T=new I(o,o.param0(T).oid,o),o.iceQ_!=null&&o.iceQ_.addIceCandidate(T)}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.onicecandidate,b.success)}).catch(function(b){o.logRemoteInvokeError(b,".set_onicecandidate() failed!")})},enumerable:!1,configurable:!0}),s.prototype.convertIceConnectionState=function(r){return r==0?"new":r==1?"checking":r==2?"connected":r==3?"completed":r==4?"failed":r==5?"disconnected":"closed"},s.prototype.convertConnectionState=function(r){if(r!=0){if(r==1)return"connecting";if(r==2)return"connected";if(r==3)return"disconnected";if(r==4)return"failed";if(r==5)return"closed"}return"new"},Object.defineProperty(s.prototype,"onconnectionstatechange",{get:function(){return this.onconnectionstatechange_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_onconnectionstatechange() called."),this.onconnectionstatechange_=r,this.waitUntilConnected(this.user_friendly_id()+".onconnectionstatechange").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.onconnectionstatechange);return b.then(function(T){a.logger.info(o.user_friendly_id()+".onconnectionstatechange(): success callback received!!!"),o.connectionState_=o.convertConnectionState(o.param0(T)),a.logger.info(o.user_friendly_id()+" connectionState=:"+o.connectionState_),T=new z("connectionstatechange",o),o.onconnectionstatechange_&&o.onconnectionstatechange_(T)}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.onconnectionstatechange,b.success)}).catch(function(b){o.logRemoteInvokeError(b,".set_onconnectionstatechange() failed!")})},enumerable:!1,configurable:!0}),s.prototype.get_connectionState=function(){return a.logger.trace(this.user_friendly_id()+".get_connectionState() called, value = "+this.connectionState_),this.isRedirected()?this.connectionState_:"failed"},Object.defineProperty(s.prototype,"oniceconnectionstatechange",{get:function(){return this.oniceconnectionstatechange_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_oniceconnectionstatechange() called."),this.oniceconnectionstatechange_=r,this.waitUntilConnected(this.user_friendly_id()+".oniceconnectionstatechange").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.oniceconnectionstatechange);return b.then(function(T){a.logger.info(o.user_friendly_id()+".oniceconnectionstatechange(): success callback received!!!"),o.iceConnectionState_=o.convertIceConnectionState(o.param0(T)),T=new z("iceconnectionstatechange",o),o.oniceconnectionstatechange_&&o.oniceconnectionstatechange_(T)}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.oniceconnectionstatechange,b.success)}).catch(function(b){o.logRemoteInvokeError(b,".set_oniceconnectionstatechange() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"iceConnectionState",{get:function(){return a.logger.trace(this.user_friendly_id()+".get_iceConnectionState() called, value = "+this.iceConnectionState_),this.isRedirected()?this.iceConnectionState_:"failed"},enumerable:!1,configurable:!0}),s.prototype.convertIceGatheringState=function(r){return r==0?"new":r==1?"gathering":"complete"},s.prototype.onicegatheringstateupdate=function(r){a.logger.info(this.user_friendly_id()+".onicegatheringstateupdate() current:"+this.iceGatheringState_+" updating to:"+r),this.iceGatheringState_=r,a.logger.info(this.user_friendly_id()+".onicegatheringstateupdate() after update: iceGatheringState_:"+this.iceGatheringState_)},Object.defineProperty(s.prototype,"onicegatheringstatechange",{get:function(){return this.onicegatheringstatechange_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_onicegatheringstatechange() called."),this.onicegatheringstatechange_=r,this.waitUntilConnected(this.user_friendly_id()+".onicegatheringstatechange").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.onicegatheringstatechange);return b.then(function(T){a.logger.info(o.user_friendly_id()+".onicegatheringstatechange(): callback received!!!"),T=o.convertIceGatheringState(o.param0(T)),o.iceQ_!=null&&o.iceQ_.pushState(T)}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.onicegatheringstatechange,b.success)}).catch(function(b){o.logRemoteInvokeError(b,".set_onicegatheringstatechange() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"iceGatheringState",{get:function(){return a.logger.debug(this.user_friendly_id()+".get_iceGatheringState() called, value = "+this.iceGatheringState_),this.iceGatheringState_},enumerable:!1,configurable:!0}),s.prototype.convertSignalState=function(r){return r==0?"stable":r==1?"have-local-offer":r==2?"have-local-pranswer":r==3?"have-remote-offer":r==4?"have-remote-pranswer":"closed"},s.prototype.TelemtryReadings_=function(){var r,o,b,T,O,x,N,n,G=this;if(this.signalingState_=="have-local-offer"&&this.firsttimelocaloffer_==0&&this.firsttimeremoteoffer_==0&&(this.outgoingcallstart_=new Date().getTime(),this.outgoingcall_==0&&(this.SendTelemetryData(d.tel_key_PerfCallState,d.tel_CallState.active,1),this.SendTelemetryData(d.tel_key_PerfCallDirection,d.tel_CallDirection.outgoing,1),this.outgoingcall_=!0),this.firsttimelocaloffer_=!0),this.signalingState_=="have-remote-offer"&&this.firsttimeremoteoffer_==0&&this.firsttimelocaloffer_==0&&(this.incomingcallstart_=new Date().getTime(),this.incomingcall_==0&&(this.SendTelemetryData(d.tel_key_PerfCallState,d.tel_CallState.active,1),this.SendTelemetryData(d.tel_key_PerfCallDirection,d.tel_CallDirection.incoming,1),this.incomingcall_=!0),this.firsttimeremoteoffer_=!0),this.signalingState_=="stable"&&this.firststable_==0&&(this.callstartTime_=new Date().getTime(),this.firststable_=this.timeerstarted_=!0),this.signalingState_=="stable"){try{for(var K=S(this.localStreams),Q=K.next();!Q.done;Q=K.next()){var Y=Q.value;1<=Y.getAudioTracks().length&&this.audiocall_.local==0&&(this.SendTelemetryData(d.tel_key_PerfCallType,d.tel_CallType.audio,1),this.audiocall_.local=!0);var te=Y.getVideoTracks();if(1<=te.length)try{for(var ee=(b=void 0,S(te)),ie=ee.next();!ie.done;ie=ee.next()){var oe=ie.value;oe.getSettings().deviceId.includes("display")==1?this.screensharingcall_.local==0&&(this.SendTelemetryData(d.tel_key_PerfCallType,d.tel_CallType.dshare,1),this.screensharingcall_.local=!0):this.videocall_.local==0&&(this.SendTelemetryData(d.tel_key_PerfCallType,d.tel_CallType.video,1),this.videocall_.local=!0)}}catch(ne){b={error:ne}}finally{try{ie&&!ie.done&&(T=ee.return)&&T.call(ee)}finally{if(b)throw b.error}}}}catch(ne){r={error:ne}}finally{try{Q&&!Q.done&&(o=K.return)&&o.call(K)}finally{if(r)throw r.error}}try{for(var ce=S(this.remoteStreams),ae=ce.next();!ae.done;ae=ce.next()){oe=ae.value,1<=oe.getAudioTracks().length&&this.audiocall_.remote==0&&(this.SendTelemetryData(d.tel_key_PerfCallType,d.tel_CallType.audio,1),this.audiocall_.remote=!0);var se=oe.getVideoTracks();if(1<=se.length)try{for(var Z=(N=void 0,S(se)),re=Z.next();!re.done;re=Z.next())re.value.id.includes("applicationsharingVideo")==1?this.screensharingcall_.remote==0&&(this.SendTelemetryData(d.tel_key_PerfCallType,d.tel_CallType.dshare,1),this.screensharingcall_.remote=!0):this.videocall_.remote==0&&(this.SendTelemetryData(d.tel_key_PerfCallType,d.tel_CallType.video,1),this.videocall_.remote=!0)}catch(ne){N={error:ne}}finally{try{re&&!re.done&&(n=Z.return)&&n.call(Z)}finally{if(N)throw N.error}}}}catch(ne){O={error:ne}}finally{try{ae&&!ae.done&&(x=ce.return)&&x.call(ce)}finally{if(O)throw O.error}}this.getReceiversAsync().then(function(ne){2<ne.length&&G.conferencecall_==0&&(G.SendTelemetryData(d.tel_key_PerfCallType,d.tel_CallType.multi,1),G.conferencecall_=!0)})}},Object.defineProperty(s.prototype,"onsignalingstatechange",{set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_onsignalingstatechange() called."),this.onsignalingstatechange_=r,this.waitUntilConnected(this.user_friendly_id()+".onsignalingstatechanged").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.onsignalingstatechange);return b.then(function(T){a.logger.info(o.user_friendly_id()+".onsignalingstatechange(): callback received!!!"),o.signalingState_=o.convertSignalState(o.param0(T)),T=new z("onsignalingstatechange",o),o.onsignalingstatechange_&&o.onsignalingstatechange_(T),o.TelemtryReadings_()}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.onsignalingstatechange,b.success)}).catch(function(b){o.logRemoteInvokeError(b,".set_onsignalingstatechange() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"onsignalingstatechanged",{get:function(){return this.onsignalingstatechange_},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"ontrack",{get:function(){return this.ontrack_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_ontrack() called."),this.ontrack_=r,this.waitUntilConnected(this.user_friendly_id()+".ontrack").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.ontrack);return b.then(function(T){return j(o,void 0,void 0,function(){var O,x,N,n,G,K,Q,Y,te,ee,ie,oe,ce,ae=this;return A(this,function(se){if(a.logger.info(this.user_friendly_id()+".ontrack(): callback received!!!"),O=new U,x=[],N=this.param0(T),N.track!=null&&N.track.is_null===!1&&(a.logger.info(this.user_friendly_id()+" adding a RemoteMediaTrack with oid:"+N.track.oid),n=new R.RemoteMediaTrack(this,N.track.oid),x.push(n.syncBarrier())),O.track=n,N.receiver!=null&&N.receiver.is_null===!1&&(G=this.receivers_.find(function(Z){return Z.object_id()===N.receiver.oid}),G===void 0&&(a.logger.info(this.user_friendly_id()+" adding a RtpReceiver with oid:"+N.receiver.oid),G=new _.RtpReceiver(this,N.receiver.oid,m.ProxyMode.Remote,this.isUnified(),n)),x.push(G.syncBarrier())),O.receiver=G,h.RemoteSession.isFeatureWebrtc1dot0Supported()&&N.transceiver!=null&&N.transceiver.is_null===!1&&(K=this.transceivers_.find(function(Z){return Z.object_id()===N.transceiver.oid}),K===void 0&&(a.logger.info(this.user_friendly_id()+" adding a RtpTransceiver with oid:"+N.transceiver.oid),K=new u.RtpTransceiver(this,N.transceiver.oid,m.ProxyMode.Remote,this.isUnified(),u.RtcRtpTransceiverDirection.inactive,G),this.transceivers_.push(K)),x.push(K.syncBarrier())),O.transceiver=K,O.streams=[],N.streams!=null){Q=function(Z){var re=Y.remoteStreams.find(function(ne){return Z.is_null===!1&&ne.object_id()===Z.oid});re===void 0&&(a.logger.info(Y.user_friendly_id()+" adding a RemoteStream with oid:"+Z.oid),re=new R.RemoteStream(Y,Z.oid,m.ProxyMode.Remote),Y.remoteStreams.push(re)),x.push(re.syncBarrier()),O.streams.push(re)},Y=this;try{for(te=S(N.streams),ee=te.next();!ee.done;ee=te.next())ie=ee.value,Q(ie)}catch(Z){oe={error:Z}}finally{try{ee&&!ee.done&&(ce=te.return)&&ce.call(te)}finally{if(oe)throw oe.error}}}return a.logger.info(this.user_friendly_id()+".ontrack(): .prop.syncBarrier start"),Promise.all(x).then(function(){var Z,re;a.logger.info(ae.user_friendly_id()+".ontrack(): notified!!! with evt: "+O);try{for(var ne=S(O.streams),B=ne.next();!B.done;B=ne.next())B.value.toggleAudio(!1)}catch(q){Z={error:q}}finally{try{B&&!B.done&&(re=ne.return)&&re.call(ne)}finally{if(Z)throw Z.error}}ae.ontrack_&&ae.ontrack_(O)}).catch(function(Z){ae.logRemoteInvokeError(Z,".ontrack(): .prop.syncBarrier failed.")}),[2]})})}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.ontrack,b.success)}).catch(function(b){o.logRemoteInvokeError(b,".set_ontrack(): failed.")})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"signalingState",{get:function(){return a.logger.debug(this.user_friendly_id()+".get_signalingState() called, value = "+this.signalingState_),this.signalingState_},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"onnegotiationneeded",{get:function(){return this.onnegotiationneeded_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_onnegotiationneeded() called."),this.onnegotiationneeded_=r,this.waitUntilConnected(this.user_friendly_id()+".onnegotiationneeded").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.onnegotiationneeded);return b.then(function(){a.logger.info(o.user_friendly_id()+".onnegotiationneeded(): callback received!!!");var T=new z("negotiationneeded",o);o.onnegotiationneeded_&&o.onnegotiationneeded_(T)}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.onnegotiationneeded,b.success)}).catch(function(b){o.logRemoteInvokeError(b,".set_onnegotiationneeded(): failed.")})},enumerable:!1,configurable:!0}),s.prototype.dumpConstraints=function(r){a.logger.debug(this.user_friendly_id()+" constraints: "+r),r!==void 0&&Object.keys(r).length!==0||a.logger.warning(this.user_friendly_id()+" constraints either undefined or empty!"),r&&(a.logger.debug(this.user_friendly_id()+"  -- video: "+r.offerToReceiveVideo),a.logger.debug(this.user_friendly_id()+"  -- audio: "+r.offerToReceiveAudio),a.logger.debug(this.user_friendly_id()+"  -- iceRestart: "+r.iceRestart),a.logger.debug(this.user_friendly_id()+"  -- voiceActivityDetection: "+r.voiceActivityDetection))},s.prototype.fix_constraints=function(r){this.dumpConstraints(r);var o={};return this.isUnified()||(o={audio:!0,video:!0}),r&&((r.video!==void 0||r.offerToReceiveVideo!==void 0)&&(o.video=r.offerToReceiveVideo),(r.audio!==void 0||r.offerToReceiveAudio!==void 0)&&(o.audio=r.offerToReceiveAudio),r.iceRestart!==void 0&&(o.iceRestart=r.iceRestart),r.voiceActivityDetection!==void 0&&(o.voiceActivityDetection=r.voiceActivityDetection)),o},s.prototype.createOffer=function(r,o,b){return a.logger.info(this.user_friendly_id()+".createOffer() called.",JSON.stringify(r)),this.isUnified()?r==null?this.createOffer_v2():r?this.createOffer_v2(r):this.createOffer_v1(r,o,b):this.createOffer_v1(r,o,b)},s.prototype.createOffer_v2=function(r){var o=this;return a.logger.info(this.user_friendly_id()+".createOffer_v2() called.",JSON.stringify(r)),new Promise(function(b,T){o.createOffer_v1(function(O){a.logger.info(o.user_friendly_id()+".createOffer_v2(): got sdp!!!",JSON.stringify(O)),O=new H(O.type,O.sdp),b(O)},function(O){O!=null&&(O=o.logRemoteInvokeError(O,".createOffer_v2() failed."),T(O))},r)})},s.prototype.createOffer_v1=function(r,o,b){var T=this;a.logger.info(this.user_friendly_id()+".createOffer_v1().",JSON.stringify(b));var O=[this.waitUntilConnected(this.user_friendly_id()+".createOffer_v1"),this.waitTransceiverAndTrackReady(this.user_friendly_id()+".createOffer_v1")];Promise.all(O).then(function(){var x=T.registerCallbacks(!0,!1,y.method_id_RTCPeerConnection_t.createOffer);return T.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.createOffer,x.success,x.fail,T.fix_constraints(b)),x.prom()}).then(function(x){return a.logger.info(T.user_friendly_id()+".createOffer_v1(): success callback received!!!"),new L(T,T.param0(x).oid,m.ProxyMode.Remote).syncBarrier()}).then(function(x){r&&r(x)}).catch(function(x){x!=null&&(x=T.logRemoteInvokeError(x,".createOffer_v1() failed."),o&&o(x))})},s.prototype.createAnswer=function(r,o,b){return a.logger.info(this.user_friendly_id()+".createAnswer() called.",JSON.stringify(r)),this.isUnified()?r==null?this.createAnswer_v2():r?this.createAnswer_v2(r):this.createAnswer_v1(r,o,b):this.createAnswer_v1(r,o,b)},s.prototype.createAnswer_v2=function(r){var o=this;return a.logger.info(this.user_friendly_id()+".createAnswer_v2() called.",JSON.stringify(r)),new Promise(function(b,T){o.createAnswer_v1(function(O){a.logger.info(o.user_friendly_id()+".createAnswer_v2(): got sdp!!!",JSON.stringify(O)),O=new H(O.type,O.sdp),b(O)},function(O){O!=null&&(O=o.logRemoteInvokeError(O,".createAnswer_v2() failed."),T(O))},r)})},s.prototype.createAnswer_v1=function(r,o,b){var T=this;a.logger.info(this.user_friendly_id()+".createAnswer_v1() called.",JSON.stringify(b));var O=[this.waitUntilConnected(this.user_friendly_id()+".createAnswer_v1"),this.waitTransceiverAndTrackReady(this.user_friendly_id()+".createAnswer_v1")];Promise.all(O).then(function(){var x=T.registerCallbacks(!0,!1,y.method_id_RTCPeerConnection_t.createAnswer);return T.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.createAnswer,x.success,x.fail,T.fix_constraints(b),{}),x.prom()}).then(function(x){return a.logger.info(T.user_friendly_id()+".createAnswer_v1(): success callback received!!!"),new L(T,T.param0(x).oid,m.ProxyMode.Remote).syncBarrier()}).then(function(x){r&&r(x)}).catch(function(x){x=T.logRemoteInvokeError(x,".createAnswer_v1() failed."),o&&o(x.message)})},s.prototype.updateSdpDescription=function(r){a.logger.info(this.user_friendly_id()+".updateSdpDescription() called.");var o=this;return new Promise(function(b,T){var O=[];r==1?O.push(o.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.localDescription,{oid:0})):O.push(o.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.remoteDescription,{oid:0})),Promise.all(O).then(function(x){return a.logger.info(o.user_friendly_id()+".updateSdpDescription() resolved."),new L(o,o.param0(x[0]).oid,m.ProxyMode.Remote).syncBarrier()}).then(function(x){r==1?o.localDescription_=x:o.remoteDescription_=x,a.logger.info(o.user_friendly_id()+".updateSdpDescription() updated sdp"),b()}).catch(function(x){o.logRemoteInvokeError(x,"sdp.syncBarrier() failed!"),T()})})},s.prototype.sdpToString=function(r){var o,b,T="";r=r?r.split(/\r?\n/):[];try{for(var O=S(r),x=O.next();!x.done;x=O.next()){var N=x.value;(N.indexOf("m=",0)!=-1||N.indexOf("o=-",0)!=-1||N.indexOf("a=ssrc",0)!=-1)&&(T+=N+"\\r\\n")}}catch(n){o={error:n}}finally{try{x&&!x.done&&(b=O.return)&&b.call(O)}finally{if(o)throw o.error}}return T},s.prototype.setLocalDescription=function(r,o,b){return a.logger.info(this.user_friendly_id()+".setLocalDescription() called.",this.sdpToString(r.sdp)),r instanceof H?this.setLocalDescription_v2(r):r instanceof RTCSessionDescription&&o?this.setLocalDescription_v1(r,o,b):(o=void 0,r?o=new H(r.type,r.sdp):(a.logger.info(this.user_friendly_id()+".setLocalDescription() empty param1, setting sdp type to rollback"),r=void 0,r=this.signalingState_=="have-remote-offer"?"answer":this.signalingState_=="have-local-pranswer"||this.signalingState_=="have-remote-pranswer"?"pranswer":"offer",o=new H(r,"")),this.setLocalDescription_v2(o))},s.prototype.setLocalDescription_v2=function(r){var o=this;return a.logger.info(this.user_friendly_id()+".setLocalDescription_v2() called."),new Promise(function(b,T){o.waitUntilConnected(o.user_friendly_id()+".setLocalDescription_v2").then(function(){return new L(o,0,m.ProxyMode.Local,{type:L.convertC2H(r.type),sdp:r.sdp}).syncBarrier()}).then(function(O){var x=o.registerCallbacks(!0,!1,y.method_id_RTCPeerConnection_t.setLocalDescription_v2),N={type:L.convertC2H(r.type),sdp:r.sdp};o.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.setLocalDescription_v2,N,x.success,x.fail),x.prom().then(function(){o.localDescription_=O,a.logger.info(o.user_friendly_id()+".setLocalDescription_v2(): success callback received!!! updated localDescription_"),Promise.all([]).then(function(){a.logger.info(o.user_friendly_id()+".setLocalDescription_v2() success."),b()}).catch(function(n){n=o.logRemoteInvokeError(n,".prop.setLocalDescription_v2() failed!"),T(n)})}).catch(function(n){n=o.logRemoteInvokeError(n,"setLocalDescription_v2() error callback received!"),T(n)})}).catch(function(O){O=o.logRemoteInvokeError(O,".setLocalDescription_v2() failed."),T(O)})})},s.prototype.setLocalDescription_v1=function(r,o,b){var T=this;a.logger.info(this.user_friendly_id()+".setLocalDescription_v1() called."),this.waitUntilConnected(this.user_friendly_id()+".setLocalDescription_v1").then(function(){return new L(T,0,m.ProxyMode.Local,{type:L.convertC2H(r.type),sdp:r.sdp}).syncBarrier()}).then(function(O){var x=T.registerCallbacks(!0,!1,y.method_id_RTCPeerConnection_t.setLocalDescription);T.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.setLocalDescription,[O],x.success,x.fail),x.prom().then(function(){T.localDescription_=O,a.logger.info(T.user_friendly_id()+".setLocalDescription_v1(): success callback received!!! updated localDescription_"),Promise.all([]).then(function(){a.logger.info(T.user_friendly_id()+".setLocalDescription_v1() success."),o&&o()}).catch(function(N){N=T.logRemoteInvokeError(N,".prop.setLocalDescription_v1() failed."),b&&b(N.message)})}).catch(function(N){N=T.logRemoteInvokeError(N,".setLocalDescription_v1() error callback received."),b&&b(N.message)})}).catch(function(O){O=T.logRemoteInvokeError(O,".setLocalDescription_v1() failed."),b&&b(O.message)})},s.prototype.setRemoteDescription=function(r,o,b){return a.logger.info(this.user_friendly_id()+".setRemoteDescription() called.",this.sdpToString(r.sdp)),r instanceof H?this.setRemoteDescription_v2(r):r instanceof RTCSessionDescription&&o?this.setRemoteDescription_v1(r,o,b):(o=void 0,r?o=new H(r.type,r.sdp):(a.logger.info(this.user_friendly_id()+".setRemoteDescription() empty param1, setting sdp type to rollback"),r=void 0,r=this.signalingState_=="have-remote-offer"?"answer":this.signalingState_=="have-local-pranswer"||this.signalingState_=="have-remote-pranswer"?"pranswer":"offer",o=new H(r,"")),this.setRemoteDescription_v2(o))},s.prototype.setRemoteDescription_v2=function(r){var o=this;return a.logger.info(this.user_friendly_id()+".setRemoteDescription_v2() called."),new Promise(function(b,T){o.waitUntilConnected(o.user_friendly_id()+".setRemoteDescription_v2").then(function(){var x=new L(o,0,m.ProxyMode.Local,{type:L.convertC2H(r.type),sdp:r.sdp}),O=[];O.push(x.syncBarrier());var x=o.registerCallbacks(!0,!1,y.method_id_RTCPeerConnection_t.setRemoteDescription_v2),N={type:L.convertC2H(r.type),sdp:r.sdp};o.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.setRemoteDescription_v2,N,x.success,x.fail),O.push(x.prom()),Promise.all(O).then(function(n){a.logger.info(o.user_friendly_id()+".setRemoteDescription_v2(): remote success."),o.remoteDescription_=n[0],O=[],o.usingasynconly_||(o.isUnified()?O.push(o.getTransceiversAsync()):O.push(o.getSendersAsync())),Promise.all(O).then(function(G){a.logger.info(o.user_friendly_id()+".setRemoteDescription_v2(): final success."),b()}).catch(function(G){G=o.logRemoteInvokeError(G,".prop.setRemoteDescription_v2() final failed."),T(G)})}).catch(function(n){n=o.logRemoteInvokeError(n,".prop.setRemoteDescription_v2() remote failed."),T(n)})}).catch(function(O){O=o.logRemoteInvokeError(O,".setRemoteDescription_v2() failed."),T(O)})})},s.prototype.setRemoteDescription_v1=function(r,o,b){var T=this;a.logger.info(this.user_friendly_id()+".setRemoteDescription_v1() called."),this.waitUntilConnected(this.user_friendly_id()+".setRemoteDescription_v1").then(function(){return new L(T,0,m.ProxyMode.Local,{type:L.convertC2H(r.type),sdp:r.sdp}).syncBarrier()}).then(function(O){var x=T.registerCallbacks(!0,!1,y.method_id_RTCPeerConnection_t.setRemoteDescription);T.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.setRemoteDescription,[O],x.success,x.fail),x.prom().then(function(){T.remoteDescription_=O,a.logger.info(T.user_friendly_id()+".setRemoteDescription_v1(): success callback received!!! updated remoteDescription_");var N=[];T.usingasynconly_||(T.isUnified()?N.push(T.getTransceiversAsync()):N.push(T.getSendersAsync())),Promise.all(N).then(function(){a.logger.info(T.user_friendly_id()+".setRemoteDescription_v1(): success."),o&&o()}).catch(function(n){n=T.logRemoteInvokeError(n,".prop.setRemoteDescription_v1() failed."),b&&b(n.message)})})}).catch(function(O){O=T.logRemoteInvokeError(O,".setRemoteDescription_v1() failed."),b&&b(O.message)})},s.prototype.getLocalStreams=function(){var r,o;a.logger.debug("PeerConnection.getLocalStreams() called. [oid="+this.object_id()+"]");try{for(var b=S(this.localStreams),T=b.next();!T.done;T=b.next())a.logger.debug(JSON.stringify(T.value))}catch(O){r={error:O}}finally{try{T&&!T.done&&(o=b.return)&&o.call(b)}finally{if(r)throw r.error}}return this.localStreams},s.prototype.getRemoteStreams=function(){var r,o;a.logger.debug(this.user_friendly_id()+".getRemoteStreams() called.");try{for(var b=S(this.remoteStreams),T=b.next();!T.done;T=b.next())a.logger.debug(JSON.stringify(T.value))}catch(O){r={error:O}}finally{try{T&&!T.done&&(o=b.return)&&o.call(b)}finally{if(r)throw r.error}}return this.remoteStreams},s.prototype.addTrack=function(r,o){return this.addTrackInternal(r,o,!1)},s.prototype.addTrackAsync=function(r,o){return this.addTrackInternal(r,o,!0)},s.prototype.addTrackInternal=function(r,o,b){var T=this;a.logger.info(this.user_friendly_id()+".addTrackInternal() called. track.id = "+r.id+", streams = "+JSON.stringify(o)+", isAsync = "+b),this.incrementPendingTrackCount();var O=[];if(o)if(o instanceof R.RemoteStream)O.push(o.id),this.localStreams.push(o);else for(var x=0;x<o.length;x++)O.push(o[x].id),this.localStreams.push(o[x]);else a.logger.info(this.user_friendly_id()+".addTrackInternal() empty streams passed in, continue with empty array");var N=new _.RtpSender(this,0,m.ProxyMode.Pseudo,this.isUnified());return this.senders_.push(N),o=new Promise(function(n,G){T.waitUntilConnected(T.user_friendly_id()+".addTrackInternal").then(function(){return T.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.addTrack,[r],O)}).then(function(K){a.logger.info(T.user_friendly_id()+".addTrackInternal() success with oid: "+T.param0(K).oid),N.bind(T,T.param0(K).oid),N.syncBarrier().then(function(){a.logger.info(T.user_friendly_id()+"sender.syncBarrier(): success"),!T.usingasynconly_&&T.isUnified()?T.getTransceiversAsync().then(function(){T.decrementPendingTrackCount(),n(N)}).catch(function(Q){T.logRemoteInvokeError(Q,".addTrackInternal() getTransceiversAsync() failed!"),T.decrementPendingTrackCount(),G()}):(T.decrementPendingTrackCount(),n(N))}).catch(function(Q){T.logRemoteInvokeError(Q,"sender.syncBarrier() failed!"),T.decrementPendingTrackCount(),G()})}).catch(function(K){T.logRemoteInvokeError(K,"addTrack() failed!"),T.decrementPendingTrackCount(),G()})}),b?o:(a.logger.debug(this.user_friendly_id()+".addTrack() returning: "+N),N)},s.prototype.removeTrack=function(r){a.logger.info(this.user_friendly_id()+".removeTrack() called."),this.removeTrackAsync(r)},s.prototype.removeTrackAsync=function(r){var o=this;a.logger.info(this.user_friendly_id()+".removeTrackAsync() called."),this.incrementPendingTrackCount();for(var b=0;b<this.senders_.length;b++)this.senders_[b]==r&&this.senders_.splice(b,1);return new Promise(function(T,O){o.waitUntilConnected(o.user_friendly_id()+".removeTrackAsync").then(function(){return o.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.removeTrack,[r])}).then(function(){a.logger.info(o.user_friendly_id()+".removeTrackAsync() success."),!o.usingasynconly_&&o.isUnified()?o.getTransceiversAsync().then(function(){o.decrementPendingTrackCount(),T()}).catch(function(x){o.logRemoteInvokeError(x,"removeTrackAsync() getTransceiversAsync() failed!"),o.decrementPendingTrackCount(),O(x)}):(o.decrementPendingTrackCount(),T())}).catch(function(x){o.logRemoteInvokeError(x,"removeTrackAsync() failed!"),o.decrementPendingTrackCount(),O(x)})})},s.prototype.addStream=function(r){var o=this;a.logger.info(this.user_friendly_id()+".addStream() called: "+JSON.stringify(r)),this.localStreams.push(r),this.waitUntilConnected(this.user_friendly_id()+".addStream").then(function(){return o.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.addStream,[r],{})}).then(function(){a.logger.info(o.user_friendly_id()+".addStream() success.")}).catch(function(b){o.logRemoteInvokeError(b,"addStream() failed.")})},s.prototype.removeStream=function(r){var o=this;a.logger.info(this.user_friendly_id()+".removeStream() called: "+JSON.stringify(r));for(var b=0;b<this.localStreams.length;b++)this.localStreams[b]==r&&this.localStreams.splice(b,1);this.waitUntilConnected(this.user_friendly_id()+".removeStream").then(function(){return o.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.removeStream,[r])}).then(function(){a.logger.info(o.user_friendly_id()+".removeStream() success.")}).catch(function(T){o.logRemoteInvokeError(T,"removeStream() failed.")})},Object.defineProperty(s.prototype,"onaddstream",{get:function(){return this.onaddstream_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_onaddstream() called."),this.onaddstream_=r,this.waitUntilConnected(this.user_friendly_id()+".onaddstream").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.onaddstream);return b.then(function(T){new R.RemoteStreamEvent(o,o.param0(T).oid).syncBarrier().then(function(O){a.logger.info(o.user_friendly_id()+".onaddstream callback received!"),o.remoteStreams.find(function(x){return O.stream!=null&&x.object_id()===O.stream.object_id()})===void 0&&o.remoteStreams.push(O.stream),o.onaddstream_&&(a.logger.info(o.user_friendly_id()+".onaddstream notified!!! "+O.stream.id),o.onaddstream_(O))})}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.onaddstream,b.success)}).catch(function(b){o.logRemoteInvokeError(b,"set_onaddstream() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"onremovestream",{get:function(){return this.onremovestream_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_onremovestream() called."),this.onremovestream_=r,this.waitUntilConnected(this.user_friendly_id()+".onremovestream").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.onremovestream);return b.then(function(T){new R.RemoteStreamEvent(o,o.param0(T).oid).syncBarrier().then(function(O){a.logger.info(o.user_friendly_id()+".onremovestream callback received! "+O.stream.id);var x=o.remoteStreams.findIndex(function(N){return N.id==O.stream.id});0<=x&&o.remoteStreams.splice(x,1),o.onremovestream_&&o.onremovestream_(O)})}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.onremovestream,b.success)}).catch(function(b){o.logRemoteInvokeError(b,"set_onremovestream() failed!")})},enumerable:!1,configurable:!0}),s.prototype.getStats=function(r,o){o===void 0&&(o=!1);var b=this;return new Promise(function(T,O){b.isRedirected()?typeof r!="function"&&r!=null?(a.logger.error(this.user_friendly_id()+".getStats callback is of unsupported type "+typeof r),T()):b.waitUntilConnected(b.user_friendly_id()+".getStats").then(function(){var x=b.registerCallbacks(!0,!1,y.method_id_RTCPeerConnection_t.getStats);return x.then(function(N){N.params===void 0||N.params.length===0||N.params[0].length===0?T():r?(r(v.StatsReport.fromJSON(JSON.parse(N.params[0]))),T()):T(o?new v.CitrixRTCStatsReport(JSON.parse(N.params[0])):JSON.parse(N.params[0]))}),r?b.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.getStats,x.success):b.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.getStats_v2,x.success)}).catch(function(x){b&&(x=b.logRemoteInvokeError(x,".getStats() failed!"),O(x))}):(typeof r=="function"&&r({}),T())})},s.prototype.SendTelemetryData=function(r,o,b){E.getRedirector().telemetry.SendTelemetryData(d.tel_cmd.Data,r,o,b)},s.prototype.MillisecondstoDisplayformat_=function(r){var o,b;b=Math.floor(r/1e3),o=Math.floor(b/60),r=Math.floor(o/60),a.logger.debug(Math.floor(r/24)+":"+r%24+":"+o%60+":"+b%60)},s.prototype.CalculateCallDurationandType_=function(){if(this.timeerstarted_==1){this.timeerstarted_=!1,this.callendTime_=new Date().getTime();var r=this.callendTime_-this.callstartTime_;this.MillisecondstoDisplayformat_(r),r=Math.round(r/1e3),a.logger.info("Call Duration "+r),this.conferencecall_==1?this.SendTelemetryData(d.tel_key_ConferenceCallDuration,r,1):(this.audiocall_.active==1&&this.SendTelemetryData(d.tel_key_AudioCallDuration,r,1),this.videocall_.active==1&&this.SendTelemetryData(d.tel_key_VideoCallDuration,r,1),this.screensharingcall_.active==1&&this.SendTelemetryData(d.tel_key_ScreensharingCallDuration,r,1));var o;this.firsttimelocaloffer_==1&&(o=this.callstartTime_-this.outgoingcallstart_),this.firsttimeremoteoffer_==1&&(o=this.callstartTime_-this.incomingcallstart_),this.MillisecondstoDisplayformat_(o),o=Math.round(o/1e3),a.logger.info("Call Establish Time "+o),this.incomingcall_==1?this.SendTelemetryData(d.tel_key_CallEstIncoming,o,1):this.outgoingcall_==1&&this.SendTelemetryData(d.tel_key_CallEstOutgoing,o,1),this.SendTelemetryData(d.tel_key_PerfCallState,d.tel_CallState.idle,1)}},s.prototype.close=function(){var r=this;a.logger.info(this.user_friendly_id()+".close() called."),this.CalculateCallDurationandType_(),this.unregisterStateChangeNotification(this.onStateChange),this.iceQ_=this.onnegotiationneeded=this.onsignalingstatechange=this.onicegatheringstatechange=this.oniceconnectionstatechange=this.onicecandidate=this.onaddstream=null,this.waitUntilConnected(this.user_friendly_id()+".close").then(function(){return r.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.close)}).then(function(){r.release(),a.logger.info(r.user_friendly_id()+".close() success.")}).catch(function(o){r.logRemoteInvokeError(o,".close() failed."),r.release()})},s.prototype.createDTMFSender=function(r){a.logger.info(this.user_friendly_id()+".createDTMFSender() called.");var o,b=this.senders_;return(b===void 0||b.length===0)&&(b=this.getSenders()),b!=null&&(b=b.find(function(T){return T.track.id===r.id}),b!=null&&(a.logger.info(this.user_friendly_id()+" returning RtpSender with oid:"+b.object_id()),o=b.dtmf)),o},Object.defineProperty(s.prototype,"usingAsyncOnly",{get:function(){return this.usingasynconly_},set:function(r){a.logger.info(this.user_friendly_id()+".usingAsyncOnly() called with async:"+r),r!=null&&r!=null&&(this.usingasynconly_=r)},enumerable:!1,configurable:!0}),s.prototype.getSendersAsync=function(){return a.logger.info(this.user_friendly_id()+".getSendersAsync() called."),this.getSendersAsyncInternal()},s.prototype.getSenders=function(){if(a.logger.info(this.user_friendly_id()+".getSenders() called. "),this.usingasynconly_)throw a.logger.error(this.user_friendly_id()+".getSenders(): throwing exception: not allowed when usingAsyncOnly is true!!!"),new DOMException(".getSenders() not allowed when usingAsyncOnly is true!!!");return this.getSendersAsyncInternal(),a.logger.info(this.user_friendly_id()+".getSenders() returning:"+this.senders_.length+" items"),this.senders_},s.prototype.getSendersAsyncInternal=function(){var r=this;return a.logger.info(this.user_friendly_id()+".getSendersAsyncInternal() called. "+this.senders_),new Promise(function(o,b){r.waitUntilConnected(r.user_friendly_id()+".getSendersAsyncInternal").then(function(){return a.logger.info(r.user_friendly_id()+".getSendersAsyncInternal invoking remote"),r.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.getSenders)}).then(function(T){a.logger.info(r.user_friendly_id()+".getSendersAsyncInternal remote success");var O=[],x=[];T.params[0].forEach(function(N){var n=r.senders_.find(function(G){return G.object_id()===N.oid});n===void 0&&(a.logger.info(r.user_friendly_id()+" adding a RtpSender with oid:"+N.oid),n=new _.RtpSender(r,N.oid,m.ProxyMode.Remote,r.isUnified())),x.push(n.syncBarrier()),O.push(n)}),Promise.all(x).then(function(){r.senders_=O,a.logger.info(r.user_friendly_id()+".getSendersAsyncInternal: returning senders with ids ["+r.senders_.map(function(N){return N.object_id()})+"]"),o(r.senders_)}).catch(function(N){r.logRemoteInvokeError(N,".prop.getSendersAsyncInternal() failed."),r.senders_=[],o(r.senders_)})}).catch(function(T){r.logRemoteInvokeError(T,".getSendersAsyncInternal() failed."),r.senders_=[],o(r.senders_)})})},s.prototype.getReceiversAsync=function(){return a.logger.info(this.user_friendly_id()+".getReceiversAsync() called."),this.getReceiversAsyncInternal()},s.prototype.getReceivers=function(){if(a.logger.info(this.user_friendly_id()+".getReceivers() called. "),this.usingasynconly_)throw a.logger.error(this.user_friendly_id()+".getReceivers(): throwing exception: not allowed when usingAsyncOnly is true!!!"),new DOMException(".getReceivers() not allowed when usingAsyncOnly is true!!!");return this.getReceiversAsyncInternal(),a.logger.info(this.user_friendly_id()+".getReceivers() returning:"+this.receivers_.length+" items"),this.receivers_},s.prototype.getReceiversAsyncInternal=function(){var r=this;return a.logger.info(this.user_friendly_id()+".getReceiversAsyncInternal() called. "+this.receivers_),new Promise(function(o,b){r.waitUntilConnected(r.user_friendly_id()+".getReceiversAsyncInternal").then(function(){return r.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.getReceivers)}).then(function(T){a.logger.info(r.user_friendly_id()+".getReceiversAsyncInternal: remote success.");var O=[],x=[];T.params[0].forEach(function(N){var n=r.receivers_.find(function(G){return G.object_id()===N.oid});n===void 0&&(a.logger.info(r.user_friendly_id()+" adding a RtpReceiver with oid:"+N.oid),n=new _.RtpReceiver(r,N.oid,m.ProxyMode.Remote,r.isUnified())),x.push(n.syncBarrier()),O.push(n)}),Promise.all(x).then(function(){r.receivers_=O,a.logger.info(r.user_friendly_id()+".getReceiversAsyncInternal: returning receiver with ids ["+r.receivers_.map(function(N){return N.object_id()})+"]"),o(r.receivers_)}).catch(function(N){r.logRemoteInvokeError(N,".prop.getReceiversAsyncInternal() failed!"),r.receivers_=[],o(r.receivers_)})}).catch(function(T){r.logRemoteInvokeError(T,".getReceiversAsyncInternal() failed!"),r.receivers_=[],o(r.receivers_)})})},s.prototype.addTransceiver=function(r,o){return a.logger.info(this.user_friendly_id()+".addTransceiver() called: "+JSON.stringify(r)+" init="+JSON.stringify(o)),this.addTransceiverInternal(r,o,!1)},s.prototype.addTransceiverAsync=function(r,o){return a.logger.info(this.user_friendly_id()+".addTransceiverAsync() called: "+JSON.stringify(r)+" init="+JSON.stringify(o)),this.addTransceiverInternal(r,o,!0)},s.prototype.addTransceiverInternal=function(r,o,b){var T=this;a.logger.info(this.user_friendly_id()+".addTransceiverInternal() called: "+JSON.stringify(r)+" init="+JSON.stringify(o)),this.incrementPendingTransceiverCount();var O=u.RtcRtpTransceiverDirection.sendrecv,x=void 0;o&&(x=u.RtcRtpTransceiverInit.toRtcRtpTransceiverInit(o),x.direction&&(O=x.direction));var N=o;h.RemoteSession.isFeatureCallConstraintsSupported()&&(N=x);var n=new u.RtpTransceiver(this,0,m.ProxyMode.Pseudo,this.isUnified(),O);return this.transceivers_.push(n),o=new Promise(function(G,K){T.waitUntilConnected(T.user_friendly_id()+".addTransceiverInternal").then(function(){return typeof r=="string"?T.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.addTransceiverWithKind,r,N):T.remoteInvokeEx(!1,y.method_id_RTCPeerConnection_t.addTransceiverWithTrack,[r],N)}).then(function(Q){a.logger.info(T.user_friendly_id()+".addTransceiverInternal() success with oid: "+T.param0(Q).oid),n.bind(T,T.param0(Q).oid),n.syncBarrier().then(function(){a.logger.info(T.user_friendly_id()+".addTransceiverInternal(): success"),T.decrementPendingTransceiverCount(),G(n)}).catch(function(Y){T.logRemoteInvokeError(Y,".prop.addTransceiverInternal() failed!"),T.decrementPendingTransceiverCount(),K()})}).catch(function(Q){T.logRemoteInvokeError(Q,"addTransceiverInternal() failed!"),T.decrementPendingTransceiverCount(),K()})}),a.logger.debug(this.user_friendly_id()+".addTransceiverInternal() returning:"),b?o:n},s.prototype.incrementPendingTransceiverCount=function(){++this.pendingtransceiver_},s.prototype.decrementPendingTransceiverCount=function(){0<this.pendingtransceiver_&&--this.pendingtransceiver_},s.prototype.incrementPendingTrackCount=function(){++this.pendingtrack_},s.prototype.decrementPendingTrackCount=function(){0<this.pendingtrack_&&--this.pendingtrack_},s.prototype.waitTransceiverAndTrackReady=function(r){var o=this;return new Promise(function(b,T){if(a.logger.trace(o.user_friendly_id()+".waitTransceiverAndTrackReady(): pendingtransceiver_="+o.pendingtransceiver_+", pendingtrack_="+o.pendingtrack_),o.pendingtransceiver_==0&&o.pendingtrack_==0){for(;o.deferredOfferAnswers&&0<o.deferredOfferAnswers.length;)o.deferredOfferAnswers.shift().post(!0);b()}else o.deferredOfferAnswers.push(new l.deferred_action(b,T,r)),o.checkTransceiverAndTrack(600,25)})},s.prototype.checkTransceiverAndTrack=function(r,o){var b=this;if(0>=r)for(a.logger.warning(".checkTransceiverAndTrack() timeout, disposing pending offer/answer requests!!!");this.deferredOfferAnswers&&0<this.deferredOfferAnswers.length;)this.deferredOfferAnswers.shift().post(!1);else setTimeout(function(T){if(b.pendingtransceiver_==0&&b.pendingtrack_==0)for(;b.deferredOfferAnswers&&0<b.deferredOfferAnswers.length;)b.deferredOfferAnswers.shift().post(!0);else a.logger.debug('.checkTransceiverAndTrack(): count= "'+T),b.checkTransceiverAndTrack(--T,o)},o,r)},s.prototype.getTransceivers=function(){if(a.logger.info(this.user_friendly_id()+".getTransceivers() called. "),this.usingasynconly_)throw a.logger.error(this.user_friendly_id()+".getTransceivers(): throwing exception: not allowed when usingAsyncOnly is true!!!"),new DOMException(".getTransceivers() not allowed when usingAsyncOnly is true!!!");return this.getTransceiversAsync(),a.logger.info(this.user_friendly_id()+".getTransceivers: returning transceivers with ids ["+this.transceivers_.map(function(r){return r.object_id()})+"]"),this.transceivers_},s.prototype.getTransceiversAsync=function(){var r=this;return a.logger.info(this.user_friendly_id()+".getTransceiversAsync() called. "),new Promise(function(o,b){if(!r.isUnified())return a.logger.info(r.user_friendly_id()+".getTransceiversAsync() called in non-Unified. "),Promise.resolve(r.transceivers_);r.waitUntilConnected(r.user_friendly_id()+".getTransceiversAsync").then(function(){return r.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.getTransceivers)}).then(function(T){a.logger.info(r.user_friendly_id()+".getTransceiversAsync() remote success.");var O=[],x=[];T.params[0].forEach(function(N){var n=r.transceivers_.find(function(G){return G.object_id()===N.oid});n===void 0&&(a.logger.info(r.user_friendly_id()+" adding a RtpTransceiver with oid:"+N.oid),n=new u.RtpTransceiver(r,N.oid,m.ProxyMode.Remote,r.isUnified())),x.push(n.syncBarrier()),O.push(n)}),Promise.all(x).then(function(){r.transceivers_=O,a.logger.info(r.user_friendly_id()+".prop.getTransceiversAsync: returning transceiver with ids ["+r.transceivers_.map(function(N){return N.object_id()})+"]"),o(r.transceivers_)}).catch(function(N){r.logRemoteInvokeError(N,".prop.getTransceiversAsync() failed!"),r.transceivers_=[],o(r.transceivers_)})}).catch(function(T){r.logRemoteInvokeError(T,".getTransceiversAsync() failed!"),r.transceivers_=[],o(r.transceivers_)})})},Object.defineProperty(s.prototype,"sctp",{get:function(){return this.sctp_},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"ondatachannel",{get:function(){return this.ondatachannel_},set:function(r){var o=this;a.logger.info(this.user_friendly_id()+".set_ondatachannel() called."),this.ondatachannel_=r,this.waitUntilConnected(this.user_friendly_id()+".ondatachannel").then(function(){var b=o.registerCallbacks(!1,o.isNullCallback(r),y.method_id_RTCPeerConnection_t.ondatachannel);return b.then(function(T){a.logger.info(o.user_friendly_id()+".ondatachannel callback received!!!"),(o.remotedatachannel_===null||o.remotedatachannel_.object_id()!=o.param0(T).oid)&&(o.remotedatachannel_=new g.RtcDataChannel(o,o.param0(T).oid,m.ProxyMode.Remote),o.remotedatachannel_.syncBarrier().then(function(){a.logger.info(o.user_friendly_id()+"remotedatachannel_.syncBarrier(): success");var O=new Event("ondatachannel");O.channel=o.remotedatachannel_,o.localdatachannel_&&!o.localdatachannel_.isdestroyed()?o.localdatachannel_.syncBarrier().then(function(){a.logger.info(o.user_friendly_id()+"ondatachannel(): notifying..."),o.ondatachannel_&&o.ondatachannel_(O)}).catch(function(){a.logger.error(o.user_friendly_id()+"localdatachannel_.syncBarrier(): failed!")}):(a.logger.info(o.user_friendly_id()+"ondatachannel(): notifying... (local channel is invalid)"),o.ondatachannel_&&o.ondatachannel_(O))}).catch(function(){a.logger.error(o.user_friendly_id()+"remotedatachannel_.syncBarrier(): failed!")}))}),o.remoteInvoke(!0,y.method_id_RTCPeerConnection_t.ondatachannel,b.success)}).catch(function(){a.logger.error(o.user_friendly_id()+".ondatachannel() failed.")})},enumerable:!1,configurable:!0}),s.prototype.fixDataChannelConfig=function(r){return a.logger.info(this.user_friendly_id()+".fixDataChannelConfig() called: "+r),r==null&&(r={}),r.negotiated==null&&r.id==null&&(r.negotiated=!1,r.id=-1),r},s.prototype.createDataChannel=function(r,o){var b=this;return a.logger.info(this.user_friendly_id()+".createDataChannel() called. label:"+r),this.localdatachannel_=new g.RtcDataChannel(this,0,m.ProxyMode.Pseudo),this.waitUntilConnected(this.user_friendly_id()+".createDataChannel").then(function(){return b.remoteInvoke(!1,y.method_id_RTCPeerConnection_t.createDataChannel,r,b.fixDataChannelConfig(o))}).then(function(T){a.logger.info(b.user_friendly_id()+".createDataChannel() success with oid: "+b.param0(T).oid),b.localdatachannel_.bind(b,b.param0(T).oid),b.localdatachannel_.syncBarrier().then(function(){a.logger.info(b.user_friendly_id()+"channel.syncBarrier(): success")}).catch(function(){a.logger.error(b.user_friendly_id()+"channel.syncBarrier(): failed!")})}).catch(function(T){T=b.param0(T),a.logger.error(b.user_friendly_id()+".createDataChannel() failed with error: "+T)}),a.logger.info(this.user_friendly_id()+".createDataChannel() returning: "+this.localdatachannel_),this.localdatachannel_},s}(m.ProxyObject),e.PeerConnection=f},121:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.protocol_handler_manager=e.protocol_base=e.callback_base=e.completion_base=void 0;var V=p(851),j=p(293),A=function(){return function(c,w,E,R,_){this.resolve=c,this.reject=w,this.reqid=_,this.cbid=E,this.completion_cb=R}}();e.completion_base=A;var S=function(){function c(w){this.id=w}return c.prototype.resolve=function(w){V.logger.trace("callback.resolve() called. [id="+this.id+"]"),this.handler!=null&&this.handler(w)},c.prototype.reject=function(w){this.err_handler!=null&&this.err_handler(w)},c.prototype.then=function(w){this.handler=w},c.prototype.prom=function(){var w=this;return new Promise(function(E,R){w.handler=E,w.err_handler=R})},c}();e.callback_base=S,f=function(){function c(){this.reqs_=[],this.ID_MAX=4294967296,this.cbid_allocator_=new j.number_allocator(0,this.ID_MAX,1),this.reqid_allocator_=new j.number_allocator(0,this.ID_MAX,1),this.reqs_w_id_=new Map,this.cbs_=new Map,this.cbidmap_=new Map}return c.prototype.user_friendly_id=function(){return this.constructor.name},c.prototype.processRequestEx=function(w,E,R){R===void 0&&(R=-1);var _=this.reqid_allocator_.allocate();return w=new A(w,E,void 0,null,_),this.reqs_w_id_.set(_,w),0<=R&&this.startCommandTimoutTimer(w,R),_},c.prototype.processResponseEx=function(w){var E;return this.reqid_allocator_.deallocate(w),this.reqs_w_id_.has(w)?(E=this.reqs_w_id_.get(w),this.reqs_w_id_.delete(w)):V.logger.warning(this.user_friendly_id()+".processResponse(). reqid="+w+" Cant find request!!!!"),E&&this.stopCommandTimoutTimer(E),E},c.prototype.startCommandTimoutTimer=function(w,E){var R=this,_=setTimeout(function(){w.timerId=void 0,R.processResponseEx(w.reqid),w.reject()},E);w.timerId=_},c.prototype.stopCommandTimoutTimer=function(w){w.timerId&&(clearTimeout(w.timerId),w.timerId=void 0)},c.prototype.processRequest=function(w,E){var R=new A(w,E);this.reqs_.push(R)},c.prototype.processResponse=function(){return this.reqs_.shift()},c.prototype.clearRequests=function(){var w=this;this.reqs_w_id_.forEach(function(E,R){E.reject(),w.cbid_allocator_.deallocate(R)}),this.reqs_w_id_.clear(),this.reqs_.forEach(function(E,R){E.reject()}),this.reqs_=[]},c.prototype.registerCallback=function(w){var E=this,R=this.cbid_allocator_.allocate();w&&this.unregisterCallback(w),this.cbidmap_.set(w,R),w=new S(R),0>R&&V.logger.warning(this.user_friendly_id()+".registerCallback(). !!!! ran out of cbid !!!!"),V.logger.debug(this.user_friendly_id()+".registerCallback(). cbid="+R),w.completion_cb=function(m){E.unregisterCallback(m)};var _=new A(w.resolve.bind(w),w.reject.bind(w),w.id,w.completion_cb);return this.cbs_.set(R,_),w},c.prototype.unregisterCallback=function(w){var E;typeof w=="string"&&this.cbidmap_.has(w)?(E=this.cbidmap_.get(w),this.cbidmap_.delete(w)):typeof w=="number"&&(E=w),this.cbs_.has(E)&&(this.cbid_allocator_.deallocate(E),this.cbs_.delete(E))},c.prototype.clearCallbacks=function(){var w=this;V.logger.info(this.user_friendly_id()+".clearCallbacks()."),this.cbs_.forEach(function(E,R){E.reject(),w.cbid_allocator_.deallocate(R)}),this.cbs_.clear(),this.cbidmap_.clear()},c.prototype.getCallback=function(w){if(typeof w=="string"&&this.cbidmap_.has(w))w=this.cbidmap_.get(w);else if(typeof w!="number"){V.logger.warning(this.user_friendly_id()+".getCallback(). !!!! invalid cbid !!!!");return}return this.cbs_.get(w)},c}(),e.protocol_base=f,f=function(){function c(){}return c.findHandler=function(w){return c.handlers_.find(function(E){return E.name==w})},c.addProtocolHandler=function(w){c.handlers_.find(function(E){return E.name==w.name})==null&&c.handlers_.push(w)},c.oninit=function(w,E){c.handlers_.forEach(function(R,_){R.init(w,E)})},c.ondeinit=function(){c.handlers_.forEach(function(w,E){w.deinit()})},c.removeAllHandlers=function(){c.handlers_.splice(0,c.handlers_.length)},c.removeProtocolHandler=function(w){var E=c.handlers_.findIndex(function(R){return R.name==w});0<=E&&c.handlers_.splice(E,1)},c.handlers_=[],c}(),e.protocol_handler_manager=f},658:function(f,e,p){var V=this&&this.__extends||function(){var y=function(a,v){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,I){d.__proto__=I}||function(d,I){for(var k in I)I.hasOwnProperty(k)&&(d[k]=I[k])},y(a,v)};return function(a,v){function d(){this.constructor=a}y(a,v),a.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}(),j=this&&this.__read||function(y,a){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var v=typeof Symbol=="function"&&y[Symbol.iterator];if(!v)return y;var d=v.call(y),I,k=[],D;try{for(;(a===void 0||0<a--)&&!(I=d.next()).done;)k.push(I.value)}catch(F){D={error:F}}finally{try{I&&!I.done&&(v=d.return)&&v.call(d)}finally{if(D)throw D.error}}return k},A=this&&this.__spread||function(){for(var y=[],a=0;a<arguments.length;a++)y=y.concat(j(arguments[a]));return y},S=this&&this.__values||function(y){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var a=typeof Symbol=="function"&&Symbol.iterator,v=a&&y[a],d=0;if(v)return v.call(y);if(y&&typeof y.length=="number")return{next:function(){return y&&d>=y.length&&(y=void 0),{value:y&&y[d++],done:!y}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyObject=e.ProxyMode=e.ProxyReadyState=e.callback=e.rpc_callback=void 0;var c=p(946),w=p(851),E=p(545),R=p(247),_=p(550),m=p(293);f=p(121);var l=p(610),t=function(){return function(y,a){this.id=y,this.is_null=a}}();e.rpc_callback=t;var u=function(y){function a(v,d,I){var k=y.call(this,v)||this;return k.success=new t(v<<16,d),k.fail=new t(v<<16|1,d),k.oneShot=I,k}return V(a,y),a}(f.callback_base);e.callback=u;var h;(function(y){y[y.NotConfigured=0]="NotConfigured",y[y.Configured=1]="Configured",y[y.Error=2]="Error",y[y.Destroyed=3]="Destroyed"})(h=e.ProxyReadyState||(e.ProxyReadyState={}));var g;(function(y){y[y.Local=0]="Local",y[y.Remote=1]="Remote",y[y.Pseudo=2]="Pseudo"})(g=e.ProxyMode||(e.ProxyMode={})),p=function(){function y(a,v,d,I,k,D){var F=this;k===void 0&&(k=null),D===void 0&&(D=[]);for(var H=[],L=6;L<arguments.length;L++)H[L-6]=arguments[L];if(this.hdxms=c.getRedirector(),this.minimalLogging=!1,this.iid=v,this.oid=d,this.mode=I,this.proxystate=h.NotConfigured,this.deferredActions=[],this.pendingSyncBarriers=[],this.cbs=new Map,I===g.Local){L=!1,this.iid===_.class_id_t.EngineControl&&(L=!0);var z=this;this.hdxms.startRedirection(L,this.user_friendly_id()).then(function(){return F.oid=y.nextId++,w.logger.info(F.user_friendly_id()+" assigned local oid:"+F.oid),new Promise(function(U,C){z.waitUntilConnectedEx(z.user_friendly_id()+".ctor()",D).then(function(){var i=z.oidsFromProxyOjbects(D).concat(H),s=_.WebrpcClassLibInfoUtil.getMethodFeatureByid(v,0);return w.logger.info(z.user_friendly_id()+".ctor() all parameter rpc objects are ready, feature is "+JSON.stringify(s)),z.hdxms.WSSendObjectWrapper(s,v,0,E.WsJsonUtil.createMessageByid.apply(E.WsJsonUtil,A([!1,!1,E.ws_msg_type_t.req,v,0,z.oid],i)))}).then(function(i){w.logger.info(z.user_friendly_id()+".ctor() success."),U(i)}).catch(function(i){w.logger.error(z.user_friendly_id()+".ctor() failed."+JSON.stringify(i)),C()})})}).then(function(U){w.logger.trace("ProxyObject: setting state to configured. (iid: "+F.iid+" oid: "+F.oid+")");var C=F.oid;z.proxystate=h.Configured,z.oid=F.param0(U),w.logger.info(F.user_friendly_id()+" assigned remote oid for local oid:"+C),z.onConnected(),k&&k(),R.getGC().trackObject(F,a)}).catch(function(){z.proxystate=h.Error,z.onConnected()})}else I===g.Remote&&(this.proxystate=h.Configured,R.getGC().trackObject(this,a))}return y.prototype.syncBarrierDeep=function(a,v){var d=!0;return 0<this.pendingSyncBarriers.length&&(d=!1),this.pendingSyncBarriers.push(new l.deferred_action(a,v,this.user_friendly_id()+".syncBarrier")),w.logger.info(this.user_friendly_id()+".syncBarrierDeep() queing request for:"+this.oid+", rv:"+d+", items:"+this.pendingSyncBarriers.length),d},y.prototype.syncBarrierResolve=function(a){for(w.logger.info(this.user_friendly_id()+".syncBarrierResolve() items:"+this.pendingSyncBarriers.length);this.pendingSyncBarriers&&0<this.pendingSyncBarriers.length;)w.logger.info(this.user_friendly_id()+".syncBarrierResolve() items:"+this.pendingSyncBarriers.length+" resolving request for:"+this.oid),this.pendingSyncBarriers.shift().postResolve(a)},y.prototype.syncBarrierReject=function(a){for(w.logger.info(this.user_friendly_id()+".syncBarrierReject() items:"+this.pendingSyncBarriers.length);this.pendingSyncBarriers&&0<this.pendingSyncBarriers.length;)w.logger.info(this.user_friendly_id()+".syncBarrierReject() rejecting request for:"+this.oid),this.pendingSyncBarriers.shift().postReject(a)},Object.defineProperty(y.prototype,"proxyreadystate",{get:function(){return this.proxystate},set:function(a){this.proxystate=a},enumerable:!1,configurable:!0}),y.prototype.bind=function(a,v){if(w.logger.trace("ProxyObject: binding object. (iid: "+this.iid+" oid: "+v+" mode: "+this.mode+")"),this.mode===g.Pseudo){this.proxystate=h.Configured;var d=this.oid;this.oid=v,w.logger.info(this.user_friendly_id()+" assigned remote oid:"+v+" for local oid:"+d),this.onConnected(),R.getGC().trackObject(this,a),this.mode=g.Remote}else this.mode===g.Remote?w.logger.info("ProxyObject: binding already complete."):w.logger.error("ProxyObject: binding failure. incorrect mode!")},y.prototype.reconstructor=function(a,v,d){for(var I=this,k=[],D=3;D<arguments.length;D++)k[D-3]=arguments[D];this.proxystate=h.NotConfigured,this.deferredActions=[],D=_.WebrpcClassLibInfoUtil.getMethodFeatureByid(v,0),this.hdxms.WSSendObjectWrapper(D,v,0,E.WsJsonUtil.createMessageByid.apply(E.WsJsonUtil,A([!1,!1,E.ws_msg_type_t.req,v,0,this.oid],k))).then(function(F){w.logger.trace("ProxyObject: setting state to configured. (iid: "+I.iid+" oid: "+I.oid+")");var H=I.oid;I.proxystate=h.Configured,I.oid=I.param0(F),w.logger.info(I.user_friendly_id()+" assigned remote oid for local oid:"+H),I.onConnected(),R.getGC().trackObject(I,a)}).catch(function(){I.proxystate=h.Error,I.onConnected()})},y.prototype.setParent=function(a){R.getGC().setParent(this,a)},y.prototype.release=function(){this.minimalLogging||w.logger.info(this.user_friendly_id()+".release() called."),R.getGC().releaseObject(this)},y.prototype.destroy=function(){this.minimalLogging||w.logger.info(this.user_friendly_id()+".destroy() called."),this.proxystate=h.Destroyed;var a=_.WebrpcClassLibInfoUtil.getMethodFeatureByid(this.iid,0);this.hdxms.WSSendObjectWrapper(a,this.iid,0,E.WsJsonUtil.createMessageByid(!1,!0,E.ws_msg_type_t.req,this.iid,0,this.oid)),this.clearCallbacks()},y.prototype.isdestroyed=function(){return this.proxystate==h.Destroyed},y.prototype.onConnected=function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.proxystate==h.Configured)},y.prototype.isPseudo=function(){return this.mode==g.Pseudo},y.prototype.checkState=function(a,v,d){var I=this;0>=a?(w.logger.error("ProxyObject.checkState() timeout waiting for connection response! failed. (iid: "+I.iid+" oid: "+I.oid+" name: "+d+")"),I.onConnected()):setTimeout(function(k,D){I.proxystate==h.Configured||I.proxystate==h.Error||I.proxystate==h.Destroyed?I.onConnected():I.checkState(--k,v,D)},v,a,d)},y.prototype.waitUntilConnected=function(a){var v=this;return new Promise(function(d,I){v?(w.logger.trace("ProxyObject.waitUntilConnected(): readyState="+v.proxystate+". (iid: "+v.iid+" oid: "+v.oid+")"),v.proxystate==h.Destroyed?(v.onConnected(),w.logger.trace("rejecting already destroyed Object:"+v.user_friendly_id()),I("Object already destroyed :"+v.user_friendly_id())):v.proxystate==h.Configured?(v.onConnected(),d()):v.proxystate==h.Error?(w.logger.trace("ProxyObject.waitUntilConnected(): readyState="+v.proxystate+". (iid: "+v.iid+" oid: "+v.oid+")"),v.onConnected(),I()):(w.logger.info('ProxyObject.waitUntilConnected(): deferring action "'+a+'". (iid: '+v.iid+" oid: "+v.oid+")"),v.deferredActions.push(new l.deferred_action(d,I,a)),v.checkState(600,25,a))):I("Invalid Object")})},y.prototype.remoteInvoke=function(a,v){for(var d=[],I=2;I<arguments.length;I++)d[I-2]=arguments[I];return this.remoteInvokeWithInterfaceId.apply(this,A([this.iid,a,v],d))},y.prototype.remoteInvokeWithInterfaceId=function(a,v,d){for(var I=[],k=3;k<arguments.length;k++)I[k-3]=arguments[k];return this.proxystate==h.Destroyed?(w.logger.trace("rejecting already destroyed Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke destroyed object :"+this.user_friendly_id())):this.proxystate==h.Error?(w.logger.trace("rejecting already error state Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke object in Error state:"+this.user_friendly_id())):(k=_.WebrpcClassLibInfoUtil.getMethodFeatureByid(a,d),this.hdxms.WSSendObjectWrapper(k,a,d,E.WsJsonUtil.createMessageByid.apply(E.WsJsonUtil,A([v,!1,E.ws_msg_type_t.req,a,d,this.oid],I))))},y.prototype.waitUntilConnectedEx=function(a,v){var d=this;return new Promise(function(I,k){var D,F,H,L;if(d){var z=[];try{for(var U=S(v),C=U.next();!C.done;C=U.next()){var i=C.value;if(i instanceof Array)try{for(var s=(H=void 0,S(i)),r=s.next();!r.done;r=s.next()){var o=r.value;z.push(o.waitUntilConnected(a+"."+o.user_friendly_id()))}}catch(b){H={error:b}}finally{try{r&&!r.done&&(L=s.return)&&L.call(s)}finally{if(H)throw H.error}}else z.push(i.waitUntilConnected(a+"."+i.user_friendly_id()))}}catch(b){D={error:b}}finally{try{C&&!C.done&&(F=U.return)&&F.call(U)}finally{if(D)throw D.error}}Promise.all(z).then(function(){w.logger.info(d.user_friendly_id()+".waitUntilConnectedEx() success."),I()}).catch(function(b){d.logRemoteInvokeError(b,".waitUntilConnectedEx(): failed."),k()})}else k("Invalid Object")})},y.prototype.oidsFromProxyOjbects=function(a){var v,d,I,k,D=[];try{for(var F=S(a),H=F.next();!H.done;H=F.next()){var L=H.value;if(L instanceof Array){a=[];try{for(var z=(I=void 0,S(L)),U=z.next();!U.done;U=z.next())a.push({oid:U.value.object_id()})}catch(C){I={error:C}}finally{try{U&&!U.done&&(k=z.return)&&k.call(z)}finally{if(I)throw I.error}}D.push(a)}else D.push({oid:L.object_id()})}}catch(C){v={error:C}}finally{try{H&&!H.done&&(d=F.return)&&d.call(F)}finally{if(v)throw v.error}}return D},y.prototype.remoteInvokeEx=function(a,v,d){for(var I=[],k=3;k<arguments.length;k++)I[k-3]=arguments[k];if(this.proxystate==h.Destroyed)return w.logger.trace("rejecting already destroyed Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke destroyed object :"+this.user_friendly_id());if(this.proxystate==h.Error)return w.logger.trace("rejecting already error state Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke object in Error state:"+this.user_friendly_id());var D=this;return new Promise(function(F,H){D.waitUntilConnectedEx(D.user_friendly_id()+".remoteInvokeEx",d).then(function(){w.logger.info(D.user_friendly_id()+".remoteInvokeEx() all parameter rpc objects are ready.");var L=D.oidsFromProxyOjbects(d).concat(I),z=_.WebrpcClassLibInfoUtil.getMethodFeatureByid(D.iid,v);return D.hdxms.WSSendObjectWrapper(z,D.iid,v,E.WsJsonUtil.createMessageByid.apply(E.WsJsonUtil,A([a,!1,E.ws_msg_type_t.req,D.iid,v,D.oid],L)))}).then(function(L){w.logger.info(D.user_friendly_id()+".remoteInvokeEx() success."),F(L)}).catch(function(){w.logger.error(D.user_friendly_id()+".remoteInvokeEx() failed."),H()})})},y.prototype.logRemoteInvokeError=function(a,v){var d="",I=a;return I?d=v+" with error: "+JSON.stringify(I.message):(d=this.param0(a),I=Object.keys(d).length!==0?new DOMException(v+" with error: "+JSON.stringify(d),this.user_friendly_id()):new DOMException(v,this.user_friendly_id()),d=I.message),this.isdestroyed()||w.logger.error(this.user_friendly_id()+d),I},y.prototype.allocate_cbid=function(){return y.cbid_allocator_.allocate()},y.prototype.deallocate_cbid=function(a){y.cbid_allocator_.deallocate(a)},y.prototype.registerCallbacks=function(a,v,d){var I=this,k=this.allocate_cbid();return a=new u(k,v,a),0>k&&w.logger.warning(this.user_friendly_id()+".registerCallbacks(). !!!! ran out of cbid !!!!"),v||(this.cbs.set(k,d),a.completion_cb=function(D,F){I.unregisterCallbacks(D)},this.hdxms.registerHandler(this.iid,this.oid,d,a)),a},y.prototype.unregisterCallbacks=function(a){this.cbs.has(a)?(this.hdxms.unregisterHandler(this.iid,this.oid,a),this.deallocate_cbid(a),this.cbs.delete(a)):w.logger.warning(this.user_friendly_id()+".unregisterCallbacks(). mid="+this.cbs.get(a)+" cbid="+a+" Cant find callback handler registration!!!!")},y.prototype.clearCallbacks=function(){var a,v;this.minimalLogging||w.logger.info(this.user_friendly_id()+".clearCallbacks().");try{for(var d=S(Array.from(this.cbs.keys())),I=d.next();!I.done;I=d.next()){var k=I.value;this.hdxms.unregisterHandler(this.iid,this.oid,k),this.deallocate_cbid(k)}}catch(D){a={error:D}}finally{try{I&&!I.done&&(v=d.return)&&v.call(d)}finally{if(a)throw a.error}}this.cbs.clear()},y.prototype.object_id=function(){return this.oid},y.prototype.param0=function(a){var v={};return a&&a.params&&(v=a.params[0]),v},y.prototype.isNullCallback=function(a){return a==null||a==null},y.prototype.user_friendly_id=function(){var a=this.constructor.name;return 0<=this.iid&&(a=_.class_id_t[this.iid]),a+"["+this.oid+"]"},y.prototype.isRedirected=function(){return this.hdxms.isRedirected()},y.prototype.isValid=function(){return!(this.proxystate===h.Error||this.proxystate===h.Destroyed)},y.prototype.registerStateChangeNotification=function(a){this.hdxms.registerStateChangeNotification(a)},y.prototype.unregisterStateChangeNotification=function(a){this.hdxms.unregisterStateChangeNotification(a)},Object.defineProperty(y.prototype,"useMinimalLogging",{get:function(){return this.minimalLogging},set:function(a){this.minimalLogging=a},enumerable:!1,configurable:!0}),y.nextId=0,y.CBID_MAX=65536,y.cbid_allocator_=new m.number_allocator(0,y.CBID_MAX,1),y}(),e.ProxyObject=p},144:function(f,e,p){var V=this&&this.__extends||function(){var U=function(C,i){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,r){s.__proto__=r}||function(s,r){for(var o in r)r.hasOwnProperty(o)&&(s[o]=r[o])},U(C,i)};return function(C,i){function s(){this.constructor=C}U(C,i),C.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),j=this&&this.__awaiter||function(U,C,i,s){function r(o){return o instanceof i?o:new i(function(b){b(o)})}return new(i||(i=Promise))(function(o,b){function T(N){try{x(s.next(N))}catch(n){b(n)}}function O(N){try{x(s.throw(N))}catch(n){b(n)}}function x(N){N.done?o(N.value):r(N.value).then(T,O)}x((s=s.apply(U,C||[])).next())})},A=this&&this.__generator||function(U,C){function i(x){return function(N){return s([x,N])}}function s(x){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,b&&(T=x[0]&2?b.return:x[0]?b.throw||((T=b.return)&&T.call(b),0):b.next)&&!(T=T.call(b,x[1])).done)return T;switch(b=0,T&&(x=[x[0]&2,T.value]),x[0]){case 0:case 1:T=x;break;case 4:return r.label++,{value:x[1],done:!1};case 5:r.label++,b=x[1],x=[0];continue;case 7:x=r.ops.pop(),r.trys.pop();continue;default:if(T=r.trys,!(T=0<T.length&&T[T.length-1])&&(x[0]===6||x[0]===2)){r=0;continue}if(x[0]===3&&(!T||x[1]>T[0]&&x[1]<T[3]))r.label=x[1];else if(x[0]===6&&r.label<T[1])r.label=T[1],T=x;else if(T&&r.label<T[2])r.label=T[2],r.ops.push(x);else{T[2]&&r.ops.pop(),r.trys.pop();continue}}x=C.call(U,r)}catch(N){x=[6,N],b=0}finally{o=T=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}var r={label:0,sent:function(){if(T[0]&1)throw T[1];return T[1]},trys:[],ops:[]},o,b,T,O;return P.initSymbol(),P.initSymbol(),P.initSymbolIterator(),O={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O},S=this&&this.__read||function(U,C){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var i=typeof Symbol=="function"&&U[Symbol.iterator];if(!i)return U;var s=i.call(U),r,o=[],b;try{for(;(C===void 0||0<C--)&&!(r=s.next()).done;)o.push(r.value)}catch(T){b={error:T}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(b)throw b.error}}return o},c=this&&this.__values||function(U){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var C=typeof Symbol=="function"&&Symbol.iterator,i=C&&U[C],s=0;if(i)return i.call(U);if(U&&typeof U.length=="number")return{next:function(){return U&&s>=U.length&&(U=void 0),{value:U&&U[s++],done:!U}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.NavigatorUserMedia=e.RemoteMediaStreamConstraints=e.RemoteMediaTrackConstraints=e.RemoteMediaTrackConstraintSet=e.RemoteDevices=e.RemoteDeviceInfo=e.DeviceInfo=e.RemoteStreamEvent=e.RemoteStream=e.RemoteMediaTrack=e.enumeratedDevices=void 0;var w=p(550),E=p(658),R=p(610),_=p(851),m=p(946),l=p(394),t=p(259),u=p(650),h=p(973),g;e.enumeratedDevices=g;var y=function(){return function(U,C){this.type=U,this.target=C}}(),a=function(){function U(){this.is_local_clone=!1,this.clone_id=this.clone_count=0}return U.prototype.clone=function(){this.clone_count++;var C=new U;return C.is_local_clone=!0,C.clone_id=this.clone_count,C},U.prototype.synchronize=function(C){return j(this,void 0,void 0,function(){return A(this,function(i){return this.is_local_clone?[2,C.asyncClone()]:[2,Promise.resolve(C)]})})},U}(),v=function(U){function C(i,s,r){return r===void 0&&(r=E.ProxyMode.Remote),i=U.call(this,i,w.class_id_t.MediaStreamTrack,s,r)||this,i.enabled_=!0,i.muted=!1,i.readyState_="live",i.refCount_=0,i.refCount_++,i.clone_state=new a,i}return V(C,U),C.createPseudo=function(i,s,r,o){return i=new C(i,-1,E.ProxyMode.Pseudo),i.id=s,i.kind=r,i.label=o,i},C.prototype.dumpInfo=function(){_.logger.debug(this.user_friendly_id()+".dumpInfo() [id="+this.id+"] kind="+this.kind+" label="+this.label+" refcount="+this.refcount+" enabled="+this.enabled+" readyState="+this.readyState)},Object.defineProperty(C.prototype,"refcount",{get:function(){return this.refCount_},enumerable:!1,configurable:!0}),C.prototype.addRef=function(){this.refCount_++,_.logger.debug(this.user_friendly_id()+".addRef() called. [id="+this.id+"] refcount="+this.refCount_)},Object.defineProperty(C.prototype,"onended",{get:function(){return _.logger.debug(this.user_friendly_id()+".get_onended() called. [id="+this.id+"]"),this.onended_},set:function(i){var s=this;_.logger.info(this.user_friendly_id()+".set_onended() called. [id="+this.id+"]"),this.onended_=i,this.waitUntilConnected("MediaStreamTrack.onended").then(function(){var r=s.registerCallbacks(!1,s.isNullCallback(i),w.method_id_MediaStreamTrack_t.onended);return r.then(function(o){_.logger.info(s.user_friendly_id()+"onended event received!!!"),o=new y("ended",s),s.readyState_="ended",s.onended_(o)}),s.remoteInvoke(!0,w.method_id_MediaStreamTrack_t.onended,r.success)}).catch(function(r){s.logRemoteInvokeError(r,".onended failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"onmute",{get:function(){return _.logger.info(this.user_friendly_id()+".get_onmute() called. [id="+this.id+"]"),this.onmute_},set:function(i){var s=this;_.logger.info(this.user_friendly_id()+".set_onmute() called. [id="+this.id+"]"),this.onmute_=i,this.waitUntilConnected("MediaStreamTrack.onmute").then(function(){var r=s.registerCallbacks(!1,s.isNullCallback(i),w.method_id_MediaStreamTrack_t.onmute);return r.then(function(o){_.logger.info(s.user_friendly_id()+"onmute event received!!!"),o=new y("mute",s),s.muted=!0,s.onmute_(o)}),s.remoteInvoke(!0,w.method_id_MediaStreamTrack_t.onmute,r.success)}).catch(function(r){s.logRemoteInvokeError(r,".onmute failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"onunmute",{get:function(){return _.logger.debug(this.user_friendly_id()+".get_onunmute() called. [id="+this.id+"]"),this.onunmute_},set:function(i){var s=this;_.logger.info(this.user_friendly_id()+".set_onunmute() called. [id="+this.id+"]"),this.onunmute_=i,this.waitUntilConnected("MediaStreamTrack.onunmute").then(function(){var r=s.registerCallbacks(!1,s.isNullCallback(i),w.method_id_MediaStreamTrack_t.onunmute);return r.then(function(o){_.logger.info("onunmute event received!!!"),o=new y("unmute",s),s.muted=!1,s.onunmute_(o)}),s.remoteInvoke(!0,w.method_id_MediaStreamTrack_t.onunmute,r.success)}).catch(function(r){s.logRemoteInvokeError(r,".onunmute failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"onstop",{set:function(i){this.onstop_=i},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"enabled",{get:function(){return _.logger.debug(this.user_friendly_id()+".get_enabled() called. [id="+this.id+", value="+this.enabled_+"]"),this.enabled_},set:function(i){var s=this;_.logger.info(this.user_friendly_id()+".set_enabled() called. [id="+this.id+", value="+i+"]"),this.waitUntilConnected("MediaStreamTrack.set_enabled").then(function(){s.remoteInvoke(!0,w.method_id_MediaStreamTrack_t.enabled,i).then(function(){s.enabled_=i}).catch(function(r){s.logRemoteInvokeError(r,".enabled failed!")})}).catch(function(r){s.logRemoteInvokeError(r,".enabled failed! remote object is not ready yet, try again later!")})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"readyState",{get:function(){return _.logger.debug(this.user_friendly_id()+".get_readyState() called. [id="+this.id+"]"),this.readyState_},enumerable:!1,configurable:!0}),C.prototype.asyncClone=function(){return j(this,void 0,void 0,function(){var i,s,r;return A(this,function(o){switch(o.label){case 0:return[4,this.waitUntilConnected("RemoteMediaTrack.asyncClone")];case 1:return o.sent(),[4,this.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.clone)];case 2:return i=o.sent(),s=this.param0(i),r=new C(this,s.oid),[2,r.syncBarrier()]}})})},C.prototype.deepClone=function(i){var s=this;if(_.logger.info(this.user_friendly_id()+".deepClone() called. [id="+this.id+"]"),u.RemoteSession.isFeatureTrackCloneWithIdSupported()){var r=new C(null,0,E.ProxyMode.Pseudo),o=new a;return r.id=i||this.id+"."+o.clone_id.toString(),r.label=this.label,r.kind=this.kind,r.enabled_=this.enabled_,r.muted=this.muted,r.readyState_=this.readyState_,r.trackSettings_=this.trackSettings_,r.clone_state=o,r.constraints_=this.constraints_,r.capabilities_=this.capabilities_,r.onended=this.onended,r.onmute=this.onmute,r.onunmute=this.onunmute,r.onstop=this.onstop,this.waitUntilConnected("RemoteMediaTrack.deepClone").then(function(){return s.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.clone,r.id)}).then(function(b){_.logger.info(s.user_friendly_id()+".deepClone() success with oid: "+s.param0(b).oid),r.bind(null,s.param0(b).oid),r.syncBarrier().then(function(){_.logger.info(s.user_friendly_id()+"track.syncBarrier(): success")}).catch(function(T){s.logRemoteInvokeError(T,"track.syncBarrier() failed!")})}).catch(function(b){s.logRemoteInvokeError(b,".deepClone() failed!")}),r}_.logger.warning(this.user_friendly_id()+".deepClone() is not supported!")},C.prototype.localClone=function(){_.logger.info(this.user_friendly_id()+".localClone() called. [id="+this.id+"]");var i=this.clone_state.clone(),s=new C(this,this.object_id());return s.id=this.id+"."+i.clone_id.toString(),s.label=this.label,s.kind=this.kind,s.enabled_=this.enabled_,s.muted=this.muted,s.readyState_=this.readyState_,s.trackSettings_=this.trackSettings_,s.clone_state=i,s.constraints_=this.constraints_,s.capabilities_=this.capabilities_,s},C.prototype.clone=function(){return _.logger.info(this.user_friendly_id()+".clone() called. [id="+this.id+"]"),u.RemoteSession.isFeatureTrackCloneWithIdSupported()?this.deepClone():this.localClone()},C.prototype.stop=function(){var i=this;_.logger.info(this.user_friendly_id()+".stop() called. [id="+this.id+"] refcount="+this.refCount_),this.readyState_="ended",0<this.refCount_&&(this.refCount_--,this.refCount_===0&&(_.logger.info(this.user_friendly_id()+".stop() called. [id="+this.id+"] remote invoking..."),this.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.stop).catch(function(s){i.logRemoteInvokeError(s,".stop failed!")}),this.kind=="video"&&this.label=="remoteapp-track"&&h.ScreenSharing.screenSharingInstance().stopAppshare(),this.onstop_!==null&&this.onstop_!=null))&&this.onstop_()},C.prototype.getCapabilities=function(){return this.capabilities_},C.prototype.getConstraints=function(){return this.constraints_},C.prototype.getSettings=function(){return this.kind=="audio"?function(i){return{deviceId:i.deviceId,echoCancellation:i.echoCancellation}}(this.trackSettings_):function(i){return{aspectRatio:i.aspectRatio,deviceId:i.deviceId,frameRate:i.frameRate,height:i.height,width:i.width}}(this.trackSettings_)},C.prototype.getChannelCount=function(){return 2},C.prototype.applyConstraints=function(i){var s=this;return _.logger.info(this.user_friendly_id()+".applyConstraints() called."),new Promise(function(r,o){s.waitUntilConnected("MediaStreamTrack.applyConstraints").then(function(){return Promise.all([s.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.applyConstraints,i),s.syncBarrier()])}).catch(function(b){s.logRemoteInvokeError(b,"applyConstraints failed!"),o({name:"OverconstrainedError",message:"Failed to apply constraints."})}).then(function(){return s.constraints_=i,s.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.getConstraints)}).then(function(b){s.constraints_=s.param0(b)}).catch(function(b){s.logRemoteInvokeError(b,".syncBarrier() remote client does not support getConstraints method. Ignore it")}).then(function(){return r()})})},C.convertReadyState=function(i){return i==0?"live":"ended"},C.prototype.copyFrom=function(i){this.kind=i.kind,this.id=i.id,this.label=i.label,this.enabled_=i.enabled_,this.muted=i.muted,this.trackSettings_=i.trackSettings_,this.capabilities_=i.capabilities_,this.readyState_=i.readyState_,_.logger.debug(`
            `+this.user_friendly_id()+` copy tracks property from new track:
            kind=`+i.kind+" id="+i.id+" label="+i.label+" enabled="+i.enabled+" muted="+i.muted+" readyState="+i.readyState+`
        `)},C.prototype.syncBarrier=function(){var i=this;return _.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(s,r){i.syncBarrierDeep(s,r)&&i.waitUntilConnected("MediaStreamTrack.syncBarrier").then(function(){return Promise.all([i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.kind,""),i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.id,""),i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.label,""),i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.enabled,!1),i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.muted,!1),i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.readyState,0),i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.getSettings),i.remoteInvoke(!1,w.method_id_MediaStreamTrack_t.getCapabilities)])}).then(function(o){var b=0;o=S(o.map(function(T){return i.param0(T)}),8),i.kind=o[0],i.id=o[1],i.label=o[2],i.enabled_=o[3],i.muted=o[4],b=o[5],i.trackSettings_=o[6],i.capabilities_=o[7],i.readyState_=C.convertReadyState(b),i.syncBarrierResolve(i)}).catch(function(o){o=i.logRemoteInvokeError(o,".syncBarrier() failed!"),i.syncBarrierReject(o)})})},C.prototype.dispose=function(){_.logger.info(this.user_friendly_id()+".dispose() called. [id="+this.id+"]"),this.stop(),this.refCount_===0&&this.release()},C}(E.ProxyObject);e.RemoteMediaTrack=v;var d=function(){return function(){}}(),I=function(U){function C(i,s,r,o,b){r===void 0&&(r=E.ProxyMode.Local),o===void 0&&(o=[]);var T=this;return _.logger.info("RemoteStream.ctor() streamid="+b+" num tracks="+o.length),r==E.ProxyMode.Remote||b||(b=C.uuidv4()),T=b&&u.RemoteSession.isFeatureTrackCloneWithIdSupported()?U.call(this,i,w.class_id_t.MediaStream,s,r,null,[o],b)||this:U.call(this,i,w.class_id_t.MediaStream,s,r,null,[o])||this,T.id=b,T.tracks_=o,T.clone_state=new a,T.active_=!0,T.tracks_.forEach(function(O){O.setParent(T)}),T}return V(C,U),C.uuidv4=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(i){return(i^crypto.getRandomValues(new Uint8Array(1))[0]&15>>i/4).toString(16)})},C.generateIdWithPrefix=function(i){var s=this.uuidv4(),r=s.indexOf("-");return 0<r&&(s=s.substring(0,r)),i+s},C.createPseudo=function(i,s,r){return new C(i,-1,E.ProxyMode.Pseudo,r,s)},C.prototype.dumpInfo=function(){var i,s;_.logger.debug(this.user_friendly_id()+".dumpInfo() [id="+this.id+"] active="+this.active_+" num tracks="+this.tracks_.length);try{for(var r=c(this.tracks_),o=r.next();!o.done;o=r.next()){var b=o.value;b&&b.dumpInfo()}}catch(T){i={error:T}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(i)throw i.error}}},C.prototype.toggleAudio=function(i){var s,r;_.logger.info(this.user_friendly_id()+".toggleAudio() called: "+i);var o=this.getAudioTracks();try{for(var b=c(o),T=b.next();!T.done;T=b.next())T.value.enabled=i}catch(O){s={error:O}}finally{try{T&&!T.done&&(r=b.return)&&r.call(b)}finally{if(s)throw s.error}}},C.prototype.toJSON=function(){var i=new d;return i.id=this.id,i.active=this.active_,i.oid=this.object_id(),"RemoteStream:"+JSON.stringify(i)},Object.defineProperty(C.prototype,"active",{get:function(){var i=this;return _.logger.info(this.user_friendly_id()+".get active() called. [id="+this.id+"] active="+this.active_),m.getRedirector().getFeatureValue(w.FEATURE_ms_teams_stream_active_status)?this.waitUntilConnected("MediaStream.active").then(function(){return _.logger.debug(i.user_friendly_id()+".get active() remote invoking"),i.remoteInvoke(!1,w.method_id_MediaStream_t.active,!1)}).then(function(s){i.active_=i.param0(s),_.logger.info(i.user_friendly_id()+".get active() success, active="+i.active_)}).catch(function(s){i.active_=!0,i.logRemoteInvokeError(s,".get active() failed! active="+i.active_)}):this.active_=!0,this.active_},enumerable:!1,configurable:!0}),C.prototype.getAudioTracks=function(){var i,s;_.logger.debug(this.user_friendly_id()+".getAudioTracks() called. [id="+this.id+"]");var r=[];try{for(var o=c(this.tracks_),b=o.next();!b.done;b=o.next()){var T=b.value;T.kind=="audio"&&r.push(T)}}catch(O){i={error:O}}finally{try{b&&!b.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}return r},C.prototype.getVideoTracks=function(){var i,s;_.logger.debug(this.user_friendly_id()+".getVideoTracks() called. [id="+this.id+"]");var r=[];try{for(var o=c(this.tracks_),b=o.next();!b.done;b=o.next()){var T=b.value;T.kind=="video"&&r.push(T)}}catch(O){i={error:O}}finally{try{b&&!b.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}return r},C.prototype.getTracks=function(){return _.logger.debug(this.user_friendly_id()+".getTracks() called. [id="+this.id+"]"),this.tracks_},C.prototype.getTrackById=function(i){var s,r;_.logger.debug(this.user_friendly_id()+".getTrackById() called. [id="+this.id+"]");try{for(var o=c(this.tracks_),b=o.next();!b.done;b=o.next()){var T=b.value;if(T.id==i)return T}}catch(O){s={error:O}}finally{try{b&&!b.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}},C.prototype.addTrack=function(i){var s=this;_.logger.info(this.user_friendly_id()+".addTrack() called. [id="+this.id+"]"),this.tracks_.push(i),i&&i.dumpInfo();var r=this;this.waitUntilConnected("MediaStream.addTrack").then(function(){return _.logger.info(r.user_friendly_id()+".addTrack remote invoking"),r.remoteInvokeEx(!1,w.method_id_MediaStream_t.addTrack,[i])}).then(function(){_.logger.info(r.user_friendly_id()+".addTrack success")}).catch(function(o){s.logRemoteInvokeError(o,".addTrack failed!")})},C.prototype.removeTrack=function(i){var s=this;_.logger.info(this.user_friendly_id()+".removeTrack() called. [id="+this.id+"]");var r=this.tracks_.indexOf(i);this.tracks_.splice(r,1);var o=this;this.waitUntilConnected("MediaStream.removeTrack").then(function(){return _.logger.info(o.user_friendly_id()+".removeTrack remote invoking"),o.remoteInvokeEx(!1,w.method_id_MediaStream_t.removeTrack,[i])}).then(function(){_.logger.info(o.user_friendly_id()+".removeTrack success")}).catch(function(b){s.logRemoteInvokeError(b,".removeTrack failed!")})},C.prototype.asyncClone=function(){return j(this,void 0,void 0,function(){var i,s,r;return A(this,function(o){switch(o.label){case 0:return _.logger.info(this.user_friendly_id()+".asyncClone() called. [id="+this.id+"]"),[4,this.waitUntilConnected("asyncClone")];case 1:return o.sent(),[4,this.remoteInvoke(!1,w.method_id_MediaStream_t.clone)];case 2:return i=o.sent(),_.logger.info(i),s=this.param0(i),r=new C(this,s.oid,E.ProxyMode.Remote),[2,r.syncBarrier()]}})})},C.prototype.deepClone=function(i){var s=this;if(_.logger.info(this.user_friendly_id()+".deepClone() called. [id="+this.id+"]"),u.RemoteSession.isFeatureTrackCloneWithIdSupported()){var r=[];this.tracks_.forEach(function(T){r.push(T.deepClone())});var o=new a;i=i||this.id+"."+o.clone_id.toString();var b=new C(null,0,E.ProxyMode.Local,r,i);return b.id=i,b.active_=this.active_,b.clone_state=o,b.tracks_=r,b.waitUntilConnected("RemoteStream.deepClone").then(function(){b.syncBarrier().then(function(){_.logger.info(s.user_friendly_id()+"stream.syncBarrier(): success")}).catch(function(T){s.logRemoteInvokeError(T,"stream.syncBarrier() failed!")})}).catch(function(T){s.logRemoteInvokeError(T,".deepClone() failed!")}),b}_.logger.warning(this.user_friendly_id()+".deepClone() is not supported!")},C.prototype.localClone=function(){_.logger.info(this.user_friendly_id()+".localClone() called. [id="+this.id+"]");var i=this.clone_state.clone(),s=new C(this,this.object_id(),E.ProxyMode.Remote);return s.id=this.id+"."+i.clone_id.toString(),s.active_=this.active_,this.tracks_.forEach(function(r){r.addRef()}),s.tracks_=this.tracks_,s.clone_state=i,s},C.prototype.clone=function(){return _.logger.info(this.user_friendly_id()+".clone() called. [id="+this.id+"]"),u.RemoteSession.isFeatureTrackCloneWithIdSupported()?this.deepClone():this.localClone()},C.prototype.onTrackStop=function(){_.logger.info(this.user_friendly_id()+".onTrackStop id="+this.id),this.tracks_.filter(function(i){return i.readyState==="live"}).length===0&&this.release()},C.prototype.updateTracks=function(i){var s=this,r=[],o=this.tracks_.filter(function(b){return b.isPseudo()});_.logger.debug(this.user_friendly_id()+".updateTracks new_tracks="+i+" current pseudoTracks="+o),i.forEach(function(b){var T=o.findIndex(function(O){return O.id===b.id});0<=T&&(_.logger.info(`
                    `+s.user_friendly_id()+" bind pseudo track track-id:"+o[T].id+` 
                    to track with track-id:`+b.id+" and object-id:"+b.object_id()+`
                `),o[T].bind(s,b.object_id()),o[T].copyFrom(b),b=o.splice(T,1).shift()),w.BUILD_TYPE_SDK||(b.onstop=s.onTrackStop.bind(s)),r.push(b)}),this.tracks_=r},C.prototype.syncBarrier=function(){var i=this;return _.logger.info(this.user_friendly_id()+".syncBarrier() called. [id="+this.id+"]"),new Promise(function(s,r){i.syncBarrierDeep(s,r)&&i.waitUntilConnected("MediaStream.syncBarrier").then(function(){var o=[];return o.push(i.remoteInvoke(!1,w.method_id_MediaStream_t.id,"")),m.getRedirector().getFeatureValue(w.FEATURE_ms_teams_stream_active_status)&&o.push(i.remoteInvoke(!1,w.method_id_MediaStream_t.active,!0)),o.push(i.remoteInvoke(!1,w.method_id_MediaStream_t.getTracks)),Promise.all(o)}).then(function(o){var b,T;_.logger.info(i.user_friendly_id()+".syncBarrier() remote success"),m.getRedirector().getFeatureValue(w.FEATURE_ms_teams_stream_active_status)?(o=S(o.map(function(G){return i.param0(G)}),3),i.id=o[0],i.active_=o[1],o=o[2]):(o=S(o.map(function(G){return i.param0(G)}),2),i.id=o[0],o=o[1],i.active_=!0);var O=[],x=function(G){var K=i.tracks_.find(function(Q){return Q.object_id()===G.oid});K===void 0&&(_.logger.info(i.user_friendly_id()+" adding a RemoteMediaTrack with oid:"+G.oid),K=new v(i,G.oid)),O.push(K.syncBarrier())};try{for(var N=c(o),n=N.next();!n.done;n=N.next())x(n.value)}catch(G){b={error:G}}finally{try{n&&!n.done&&(T=N.return)&&T.call(N)}finally{if(b)throw b.error}}return Promise.all(O)}).then(function(o){i.updateTracks(o),i.syncBarrierResolve(i)}).catch(function(o){i.logRemoteInvokeError(o,".syncBarrier failed!"),i.syncBarrierReject()})})},C.prototype.dispose=function(){_.logger.info(this.user_friendly_id()+".dispose() called. [id="+this.id+"]"),this.tracks_.forEach(function(i){i.dispose()}),this.release()},C}(E.ProxyObject);e.RemoteStream=I,f=function(U){function C(i,s){return U.call(this,i,w.class_id_t.MediaStreamEvent,s,E.ProxyMode.Remote)||this}return V(C,U),C.prototype.syncBarrier=function(){var i=this;return _.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(s,r){i.syncBarrierDeep(s,r)&&i.waitUntilConnected("MediaStreamEvent.syncBarrier").then(function(){return i.remoteInvoke(!1,w.method_id_MediaStreamEvent_t.stream,{oid:0})}).then(function(o){return new I(i,o.params[0].oid,E.ProxyMode.Remote).syncBarrier()}).then(function(o){i.stream=o,i.syncBarrierResolve(i)}).catch(function(o){o=i.logRemoteInvokeError(o,".syncBarrier() failed!"),i.syncBarrierReject(o)})})},C}(E.ProxyObject),e.RemoteStreamEvent=f;var k=function(){return function(U,C,i,s){this.deviceId=U,this.groupId=C,this.kind=i,this.label=s}}();e.DeviceInfo=k;var D=function(U){function C(i){return U.call(this,null,w.class_id_t.MediaDeviceInfo,i,E.ProxyMode.Remote)||this}return V(C,U),C.convertKind=function(i){return i==0?"audioinput":i==1?"audiooutput":"videoinput"},C.prototype.syncBarrier=function(){var i=this;return _.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(s,r){i.syncBarrierDeep(s,r)&&i.waitUntilConnected("RemoteDeviceInfo.syncBarrier").then(function(){return Promise.all([i.remoteInvoke(!1,w.method_id_MediaDeviceInfo_t.deviceId,""),i.remoteInvoke(!1,w.method_id_MediaDeviceInfo_t.kind,0),i.remoteInvoke(!1,w.method_id_MediaDeviceInfo_t.label,""),i.remoteInvoke(!1,w.method_id_MediaDeviceInfo_t.groupId,"")])}).then(function(o){i.kind=C.convertKind(i.param0(o.splice(1,1)[0])),o=S(o.map(function(b){return i.param0(b)}),3),i.deviceId=o[0],i.label=o[1],i.groupId=o[2],i.syncBarrierResolve(i)}).catch(function(o){o=i.logRemoteInvokeError(o,".syncBarrier() failed!"),i.syncBarrierReject(o)})})},C}(E.ProxyObject);e.RemoteDeviceInfo=D,f=function(U){function C(){var i=U.call(this,null,w.class_id_t.MediaDevices,0,E.ProxyMode.Local,function(){i.setDeviceChangeCallback()})||this;return i.devices_=[],i.enumerateMarker="enumerateDevicesPrivate",i.enumerateRemoteMarker="enumeratedDevicesPrivate-Remote",i.shareSystemAudio_=!1,i.pendingEnumerateDevice_=[],i.panelid_=-1,i}return V(C,U),Object.defineProperty(C.prototype,"panelid",{set:function(i){this.panelid_=i},enumerable:!1,configurable:!0}),C.prototype.clearPanelId=function(){this.panelid_=-1},C.prototype.enumerateDevices=function(){var i=this;return 0<this.devices_.length&&this.pendingEnumerateDevice_.length==0?new Promise(function(s,r){_.logger.info(i.user_friendly_id()+".enumerateDevices: returning cached devices"),s(i.devices_)}):this.enumerateDevicesPrivate(!1)},C.prototype.enumerateDevicesPrivate=function(i){return m.getRedirector().getFeatureValue(w.FEATURE_ms_teams_enumerate_devices_v2)?this.enumerateDevicesPrivateV2(i):this.enumerateDevicesPrivateV1(i)},C.prototype.postEnumerateDevicesResult=function(){var i,s,r=!0,o=0;try{for(var b=c(this.pendingEnumerateDevice_),T=b.next();!T.done;T=b.next()){var O=T.value;if(r==0&&O.name==this.enumerateRemoteMarker)break;O.postWithResult(!0,this.devices_),o++,r=!1}}catch(x){i={error:x}}finally{try{T&&!T.done&&(s=b.return)&&s.call(b)}finally{if(i)throw i.error}}0<o&&this.pendingEnumerateDevice_.splice(0,o)},C.prototype.enumerateDevicesPrivateV2=function(i){var s=this;return _.logger.info(this.user_friendly_id()+".enumerateDevicesPrivateV2() called. refresh:"+i+" pending:"+this.pendingEnumerateDevice_.length),new Promise(function(r,o){i==1||s.pendingEnumerateDevice_.length==0?(s.pendingEnumerateDevice_.push(new R.deferred_action(r,o,s.enumerateRemoteMarker)),s.waitUntilConnected("RemoteDevices.enumerateDevicesPrivateV2").then(function(){return _.logger.info(s.user_friendly_id()+".enumerateDevicesPrivateV2() remote invoking..."),s.remoteInvoke(!1,w.method_id_MediaDevices_t.enumerateDevicesV2)}).then(function(b){var T=[];b.params[0].forEach(function(O){O=new k(O.deviceId,O.groupId,D.convertKind(O.kind),O.label),T.push(O)}),s.devices_=T,e.enumeratedDevices=g=T,_.logger.info(s.user_friendly_id()+".enumerateDevicesPrivateV2: resolving enumerated devices: "+JSON.stringify(s.devices_)),s.postEnumerateDevicesResult()}).catch(function(b){s.devices_=[],e.enumeratedDevices=g=[],s.logRemoteInvokeError(b,".enumerateDevicesPrivateV2() failed, resolving with empty list."),s.postEnumerateDevicesResult()})):(s.pendingEnumerateDevice_.push(new R.deferred_action(r,o,s.enumerateMarker)),_.logger.info(s.user_friendly_id()+".enumerateDevicesPrivateV2() not remoting this call..."))})},C.prototype.enumerateDevicesPrivateV1=function(i){var s=this;return _.logger.info(this.user_friendly_id()+".enumerateDevicesPrivateV1() called. refresh:"+i+" pending:"+this.pendingEnumerateDevice_.length),new Promise(function(r,o){i==1||s.pendingEnumerateDevice_.length==0?(s.pendingEnumerateDevice_.push(new R.deferred_action(r,o,s.enumerateRemoteMarker)),s.waitUntilConnected("RemoteDevices.enumerateDevicesPrivateV1").then(function(){return _.logger.info(s.user_friendly_id()+".enumerateDevicesPrivateV1() remote invoking..."),s.remoteInvoke(!1,w.method_id_MediaDevices_t.enumerateDevices)}).then(function(b){var T=[];return b.params[0].forEach(function(O){O=new D(O.oid),T.push(O.syncBarrier())}),Promise.all(T)}).then(function(b){var T=[];b.forEach(function(O){var x=new k(O.deviceId,O.groupId,O.kind,O.label);T.push(x),O.release()}),s.devices_=T,e.enumeratedDevices=g=T,_.logger.info(s.user_friendly_id()+".enumerateDevicesPrivateV1: resolving enumerated devices: "+JSON.stringify(s.devices_)),s.postEnumerateDevicesResult()}).catch(function(b){e.enumeratedDevices=g=[],s.devices_=[],s.logRemoteInvokeError(b,".enumerateDevicesPrivateV1() failed, resolving with empty list."),s.postEnumerateDevicesResult()})):(s.pendingEnumerateDevice_.push(new R.deferred_action(r,o,s.enumerateMarker)),_.logger.info(s.user_friendly_id()+".enumerateDevicesPrivateV1() not remoting this call..."))})},C.prototype.getDisplayMedia=function(i){var s=this;return new Promise(function(r,o){s.waitUntilConnected("RemoteDevices.getDisplayMedia").then(function(){return h.ScreenSharing.screenSharingInstance().setActiveSource(s.panelid_,u.RemoteSession.isFeaturAppshareSupported())}).then(function(b){return i.video!==void 0&&i.video!==null&&b!==void 0&&(i.video.deviceId=b),m.getRedirector().getFeatureValue(w.FEATURE_ms_teams_share_system_audio)&&(i.audio!==void 0&&typeof i.audio!="boolean"?_.logger.warning("Non-boolean audio constraints"):i.audio=i.audio||s.shareSystemAudio_),b=s.prepareDisplayConstraints(i),b=L.toRemoteMediaStreamConstraints(b,!0),s.remoteInvoke(!1,w.method_id_MediaDevices_t.getDisplayMedia,b)}).then(function(b){return new I(null,b.params[0].oid,E.ProxyMode.Remote).syncBarrier()}).then(function(b){r(b)}).catch(function(b){h.ScreenSharing.screenSharingInstance().isAppshareActive()&&h.ScreenSharing.screenSharingInstance().stopAppshare(),b=s.logRemoteInvokeError(b,".getDisplayMedia() failed!"),o(b)})})},C.prototype.setDeviceChangeCallback=function(){var i=this;_.logger.info(this.user_friendly_id()+".set_DeviceChangeCallback() called."),this.waitUntilConnected("MediaDevices.ondevicechange").then(function(){var s=i.registerCallbacks(!1,!1,w.method_id_MediaDevices_t.ondevicechange);return s.then(function(){_.logger.info(i.user_friendly_id()+".ondevicechange(): callback received!!!"),i.enumerateDevicesPrivate(!0).then(function(){navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))}).catch(function(){navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))})}),i.remoteInvoke(!0,w.method_id_MediaDevices_t.ondevicechange,s.success)}).catch(function(s){i.logRemoteInvokeError(s,".set_ondevicechange() failed!")})},C.prototype.prepareDisplayConstraints=function(i){if(m.getRedirector().getFeatureValue(w.FEATURE_ms_teams_common_media_constraints))return i;var s={frameRate:15,width:{max:1920},height:{max:1080}};if(i.video!==void 0&&i.video!==null){var r=i.video;r.frameRate!==void 0&&r.width!==void 0&&r.height!==void 0&&(s.frameRate=r.frameRate,s.width.max=r.width.max||r.width,s.height.max=r.height.max||r.height)}return i.audio?{video:s,audio:i.audio}:{video:s}},C}(E.ProxyObject),e.RemoteDevices=f;var F=function(){function U(){}return U.toRemoteMediaTrackConstraintSet=function(C){var i=void 0;return t.Util.hasValue(C)&&(i={},t.Util.hasValue(C.width)&&(i.width=C.width),t.Util.hasValue(C.height)&&(i.height=C.height),t.Util.hasValue(C.aspectRatio)&&(i.aspectRatio=C.aspectRatio),t.Util.hasValue(C.frameRate)&&(i.frameRate=C.frameRate),t.Util.hasValue(C.facingMode)&&(i.facingMode=C.facingMode),t.Util.hasValue(C.sampleRate)&&(i.sampleRate=C.sampleRate),t.Util.hasValue(C.sampleSize)&&(i.sampleSize=C.sampleSize),t.Util.hasValue(C.volume)&&(i.volume=C.volume),t.Util.hasValue(C.echoCancellation)&&(i.echoCancellation=C.echoCancellation),t.Util.hasValue(C.autoGainControl)&&(i.autoGainControl=C.autoGainControl),t.Util.hasValue(C.noiseSuppression)&&(i.noiseSuppression=C.noiseSuppression),t.Util.hasValue(C.latency)&&(i.latency=C.latency),t.Util.hasValue(C.channelCount)&&(i.channelCount=C.channelCount),t.Util.hasValue(C.deviceId)&&(i.deviceId=C.deviceId),t.Util.hasValue(C.groupId)&&(i.groupId=C.groupId),t.Util.hasValue(C.maxFrameRate)&&(i.maxFrameRate=C.maxFrameRate),t.Util.hasValue(C.maxHeight)&&(i.maxHeight=C.maxHeight),t.Util.hasValue(C.maxWidth)&&(i.maxWidth=C.maxWidth),t.Util.hasValue(C.minHeight)&&(i.minHeight=C.minHeight),t.Util.hasValue(C.minWidth)&&(i.minWidth=C.minWidth),t.Util.hasValue(C.sourceId)&&(i.sourceId=C.sourceId)),i},U}();e.RemoteMediaTrackConstraintSet=F;var H=function(U){function C(){return U!==null&&U.apply(this,arguments)||this}return V(C,U),C.defMandatory=function(i){var s=i;return t.Util.hasValue(i)?(t.Util.hasValue(i.maxFrameRate)||(s.maxFrameRate=30),t.Util.hasValue(i.minWidth)||(s.minWidth=360),t.Util.hasValue(i.maxWidth)||(s.maxWidth=1920),t.Util.hasValue(i.minHeight)||(s.minHeight=180),t.Util.hasValue(i.maxHeight)||(s.maxHeight=1080)):s={maxFrameRate:30,minWidth:360,maxWidth:1920,minHeight:180,maxHeight:1080},s},C.toRemoteMediaTrackConstraints=function(i){var s=void 0;return t.Util.hasValue(i)&&(s=F.toRemoteMediaTrackConstraintSet(i),s.advanced=[],t.Util.hasValue(i.advanced)&&i.advanced.forEach(function(r){r=F.toRemoteMediaTrackConstraintSet(r),s.advanced.push(r)}),t.Util.hasValue(i.mandatory)&&(s.mandatory=typeof i.mandatory!="boolean"?F.toRemoteMediaTrackConstraintSet(i.mandatory):i.mandatory)),s},C}(F);e.RemoteMediaTrackConstraints=H;var L=function(){function U(){}return U.getDefaultAudioDeviceId=function(){if(g!==void 0){var C=g.find(function(i){return i.kind==="audioinput"&&i.deviceId==="default"});if(C!==void 0)return C.deviceId}return""},U.getDefaultVideoDeviceId=function(){if(g!==void 0){var C=g.find(function(i){return i.kind==="videoinput"});if(C!==void 0)return C.deviceId}return""},U.toRemoteMediaStreamConstraints=function(C,i){i===void 0&&(i=!1),_.logger.info("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() in constraints:"+JSON.stringify(C));var s={};return t.Util.hasValue(C)&&(t.Util.hasValue(C.audio)&&(typeof C.audio!="boolean"?(s.audio=H.toRemoteMediaTrackConstraints(C.audio),Object.keys(s.audio).length!=0&&t.Util.hasValue(s.audio)||(s.audio={dummy:1}),w.BUILD_TYPE_SDK&&i==0&&U.isConstraintsAudioDeviceIdEmpty(C)&&(s.audio.deviceId=U.getDefaultAudioDeviceId(),_.logger.info("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() set default audio deviceId:'"+s.audio.deviceId+"'"))):s.audio=C.audio),t.Util.hasValue(C.peerIdentity)&&(s.peerIdentity=C.peerIdentity),t.Util.hasValue(C.video)&&(typeof C.video!="boolean"?(s.video=H.toRemoteMediaTrackConstraints(C.video),i==0&&typeof s.video.mandatory!="boolean"&&(s.video.mandatory=H.defMandatory(s.video.mandatory),w.BUILD_TYPE_SDK&&U.isConstraintsVideoSourceIdEmpty(C)&&(s.video.mandatory.sourceId=U.getDefaultVideoDeviceId(),_.logger.info("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() set default video sourceId:'"+s.video.mandatory.sourceId+"'")))):(s.video=C.video,C.video==1&&i==0&&w.BUILD_TYPE_SDK&&U.isConstraintsVideoSourceIdEmpty(C)&&(s.video={},s.video.mandatory=H.defMandatory(void 0),s.video.mandatory.sourceId=U.getDefaultVideoDeviceId(),_.logger.info("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() set default video sourceId:'"+s.video.mandatory.sourceId+"'"))))),_.logger.info("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() out constraints:"+JSON.stringify(s)),s},U.isConstraintsAudioDeviceIdEmpty=function(C){var i=!1;return t.Util.hasValue(C)&&t.Util.hasValue(C.audio)&&(typeof C.audio=="boolean"?C.audio==1&&(i=!0):(C=C.audio,!C||t.Util.hasValue(C.deviceId)!==!1&&C.deviceId!==""||(i=!0))),i},U.isConstraintsVideoSourceIdEmpty=function(C){var i=!1;return t.Util.hasValue(C)&&t.Util.hasValue(C.video)&&(typeof C.video=="boolean"?C.video==1&&(i=!0):(C=C.video)&&((C=C.mandatory)&&t.Util.hasValue(C.sourceId)!==!1&&C.sourceId!==""||(i=!0))),i},U}();e.RemoteMediaStreamConstraints=L;var z=function(){function U(){this.video=this.audio=U.EmptyCapabilities}return U.EmptyCapabilities={codecs:[],headerExtensions:[]},U}();f=function(U){function C(){return U.call(this,null,w.class_id_t.NavigatorUserMedia,0,E.ProxyMode.Local)||this}return V(C,U),C.getCapabilities=function(i){return _.logger.info("NavigatorUserMedia.getCapabilities for type="+i+" capabilities="+JSON.stringify(C.capabilities[i])),C.capabilities[i]},C.resetCapabilities=function(){C.capabilities=new z},C.prototype.getCapabilities=function(){var i=this;return _.logger.info(this.user_friendly_id()+".getCapabilities..."),new Promise(function(s,r){i.waitUntilConnected("NavigatorUserMedia.getCapabilities").then(function(){return Promise.all([i.remoteInvoke(!1,w.method_id_NavigatorUserMedia_t.getCapabilities,"audio"),i.remoteInvoke(!1,w.method_id_NavigatorUserMedia_t.getCapabilities,"video")])}).then(function(o){C.capabilities.audio=i.param0(o[0]),C.capabilities.video=i.param0(o[1]),_.logger.info(i.user_friendly_id()+".getCapabilities capabilities="+JSON.stringify(C.capabilities)),s(C.capabilities)}).catch(function(o){r(i.logRemoteInvokeError(o,".getCapabilities failed!"))})})},C.prototype.setCodecCapabilities=function(i){var s=this;return _.logger.info(this.user_friendly_id()+".setCodecCapabilities : set codecCapabilities to "+JSON.stringify(i)),new Promise(function(r,o){s.waitUntilConnected("NavigatorUserMedia.setCodecCapabilities").then(function(){return s.remoteInvoke(!1,w.method_id_NavigatorUserMedia_t.setCodecCapabilities,i)}).then(function(){_.logger.info(s.user_friendly_id()+".setCodecCapabilities() success."),r(!0),s.getCapabilities()}).catch(function(b){b=s.logRemoteInvokeError(b,".setCodecCapabilities() failed!"),o(b)})})},C.prototype.webkitGetUserMedia=function(i,s,r){return this.getUserMedia(i,s,r)},C.prototype.LogTelemetryDevice_=function(i){try{if(typeof i.audio<"u"){var s=i.audio.deviceId,r;g.forEach(function(T){s==T.deviceId&&(r=T.label)}),_.logger.debug(r),this.SendTelemetryData(l.tel_key_AudioDeviceUsed,r,0)}if(typeof i.video<"u"){var o=i.video.mandatory,b;o&&g.forEach(function(T){o.sourceId==T.deviceId&&(b=T.label)}),_.logger.debug(b),this.SendTelemetryData(l.tel_key_VideoDeviceUsed,b,0)}}catch(T){_.logger.error(T)}},C.prototype.getUserMedia=function(i,s,r){return _.logger.info(this.user_friendly_id()+".getUserMedia() called: "+JSON.stringify(i)),s&&r?this.getUserMedia_v1(i,s,r):this.getUserMedia_v2(i)},C.prototype.getUserMedia_v2=function(i){var s=this;return _.logger.info(this.user_friendly_id()+".getUserMedia_v2() called: "+JSON.stringify(i)),new Promise(function(r,o){s.getUserMediaPrivate(i,function(b){_.logger.info(s.user_friendly_id()+"getUserMedia_v2: resolving stream"),r(b)},function(b){_.logger.error(s.user_friendly_id()+"getUserMedia_v2: rejecting stream"),o(b)})})},C.prototype.getUserMedia_v1=function(i,s,r){return _.logger.info(this.user_friendly_id()+".getUserMedia_v1() called: "+JSON.stringify(i)),this.getUserMediaPrivate(i,s,r)},C.prototype.getUserMediaPrivate=function(i,s,r){var o=this;this.waitUntilConnected("NavigatorUserMedia.getUserMediaPrivate").then(function(){var b=o.registerCallbacks(!0,!1,w.method_id_NavigatorUserMedia_t.getUserMedia),T=L.toRemoteMediaStreamConstraints(i);return o.remoteInvoke(!1,w.method_id_NavigatorUserMedia_t.getUserMedia,T,b.success,b.fail),b.prom()}).then(function(b){return _.logger.info(o.user_friendly_id()+".getUserMediaPrivate: received success callback!"),new I(null,o.param0(b).oid,E.ProxyMode.Remote).syncBarrier()}).then(function(b){_.logger.info(o.user_friendly_id()+".getUserMediaPrivate: MediaStream ready to deliver",JSON.stringify(b)),b.getTracks().length==0?(_.logger.warning(o.user_friendly_id()+".getUserMediaPrivate: reporting no tracks as error."),r({constraintName:"",name:"OverconstrainedError",message:""})):(o.LogTelemetryDevice_(i),s(b))}).catch(function(b){o.logRemoteInvokeError(b,".getUserMediaPrivate() failed!"),m.getRedirector().getFeatureValue(w.FEATURE_ms_teams_1912)?o.param0&&b?r(o.param0(b)):r({constraintName:"",name:"OverconstrainedError",message:""}):r({constraintName:"",name:"OverconstrainedError",message:""})})},C.prototype.SendTelemetryData=function(i,s,r){m.getRedirector().telemetry.SendTelemetryData(l.tel_cmd.Data,i,s,r)},C.capabilities=new z,C}(E.ProxyObject),e.NavigatorUserMedia=f},650:function(f,e,p){var V=this&&this.__values||function(m){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var l=typeof Symbol=="function"&&Symbol.iterator,t=l&&m[l],u=0;if(t)return t.call(m);if(m&&typeof m.length=="number")return{next:function(){return m&&u>=m.length&&(m=void 0),{value:m&&m[u++],done:!m}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSession=e.SessionInfo=e.RemoteType=void 0;var j=p(946),A=p(550),S=p(9),c=p(851),w=p(550),E=p(394),R;(function(m){m[m.Unknown=0]="Unknown",m[m.Windows=1]="Windows",m[m.Linux=2]="Linux"})(R=e.RemoteType||(e.RemoteType={}));var _=function(){return function(){}}();e.SessionInfo=_,f=function(){function m(l,t){var u=this;this.isremote_=!1,this.isremote_=!0,this.type_=R.Windows,this.address_="0.0.0.0",this.sessioninfo_=null,j.getRedirector().setRemoteSessionInfoCb(function(){return u.remoteSessionInfo()}),this.enginecontrol_=new S.EngineControl(l+"::"+t),c.logger.appInfo={clientInfo:l,vendorName:t}}return m.prototype.release=function(){j.getRedirector().setRemoteSessionInfoCb(null)},m.prototype.user_friendly_id=function(){return"[RemoteSession]"},m.prototype.getFeatureFlags=function(){var l={};return this.enginecontrol_!==null&&this.enginecontrol_.features_!==null&&this.enginecontrol_.features_!==void 0&&this.enginecontrol_.features_.forEach(function(t){l[t.name]=t.value}),l},m.prototype.isFeatureSupported=function(l){if(l==="video")return!0;if(l==="givecontrol"&&this.sessioninfo_.clientPlatform.includes("Linux")||!(l in w.featureNameMap))return!1;for(var t=w.featureNameMap[l],u=this.getFeatureFlags(),h=0;h<t.length;h++)if(!(t[h]in u)||u[t[h]]!==!0)return!1;return l in w.vdaFeatureNameMap?w.vdaFeatureNameMap[l].map(function(g){return j.getRedirector().getVDAFeatureValue(g)}).reduce(function(g,y){return g&&y},!0):!0},m.isFeaturePstnSupported=function(){return m.pstn_},m.isFeatureDtmfSupported=function(){return m.dtmfswitch_},m.isFeaturAppshareSupported=function(){return m.appshare_},m.isFeatureWebrtc1dot0Supported=function(){return m.webrtc1dot0_},m.isFeatureDataChannelSupported=function(){return m.datachannel_},m.isFeatureVdNoBufferLimitSupported=function(){return m.vdnobuflimit_},m.isFeatureCallConstraintsSupported=function(){return m.callconstraints_},m.isFeatureTrackCloneWithIdSupported=function(){return m.trackclonewithid_},m.isFeatureSenderStatsFixSupported=function(){return m.senderstatsfix_},m.isFeatureGTCSupported=function(){return m.gtc_},m.prototype.getSessionInfo=function(){return c.logger.debug(this.user_friendly_id()+".getSessionInfo() called."),this.sessioninfo_!=null?Promise.resolve(this.sessioninfo_):Promise.reject()},m.prototype.remoteSessionInfo=function(){var l=this,t=this;return c.logger.info(t.user_friendly_id()+".remoteSessionInfo() called."),new Promise(function(u,h){t.enginecontrol_.syncBarrier().then(function(g){var y,a;if(c.logger.info(t.user_friendly_id()+"enginecontrol info received!"),t.sessioninfo_=new _,t.sessioninfo_.type_script=A.HDXMS_VERSION,t.sessioninfo_.webrpc=g.version_.major.toString()+"."+g.version_.minor.toString()+"."+g.version_.revision.toString()+"."+g.version_.build.toString(),g.versions_!=null&&g.versions_!=null){t.SendTelemetryData(E.tel_key_VerTypeScript,A.HDXMS_VERSION,0);var v=0;try{for(var d=V(g.versions_),I=d.next();!I.done;I=d.next()){var k=I.value,D=k.major.toString()+"."+k.minor.toString()+"."+k.revision.toString()+"."+k.build.toString();switch(v){case S.VersionType.Webrpc:t.sessioninfo_.webrpc=D,t.SendTelemetryData(E.tel_key_VerWebrpc,D,0);break;case S.VersionType.WebrtcCodecs:t.sessioninfo_.webrtc_codecs=D,t.SendTelemetryData(E.tel_key_VerWebrtcCodecs,D,0);break;case S.VersionType.Receiver:t.sessioninfo_.receiver=D,t.SendTelemetryData(E.tel_key_VerReceiver,D,0);break;case S.VersionType.Vda:t.sessioninfo_.vda=D,t.SendTelemetryData(E.tel_key_VerVda,D,0);break;case S.VersionType.Endpoint:t.sessioninfo_.endpoint=D,t.SendTelemetryData(E.tel_key_VerEndpoint,D,0);break;case S.VersionType.HdxRtcEngine:t.sessioninfo_.hdxrtcengine=D,t.SendTelemetryData(E.tel_key_VerHdxRtcEngine,D,0);break;default:c.logger.warning(t.user_friendly_id()+"Unknown version type!")}v++}}catch(F){y={error:F}}finally{try{I&&!I.done&&(a=d.return)&&a.call(d)}finally{if(y)throw y.error}}}g.osinfo_!=null&&g.osinfo_!=null&&(t.sessioninfo_.osinfo=g.osinfo_,g.osinfo_.family.includes("Darwin")&&["Mac OS X","macOS","OS X"].some(function(F){return g.osinfo_.edition.startsWith(F)})?t.sessioninfo_.clientPlatform="Mac":t.sessioninfo_.clientPlatform=g.osinfo_.family,t.SendTelemetryData(E.tel_key_OSFamily,g.osinfo_.family,0),t.SendTelemetryData(E.tel_key_OSVersion,g.osinfo_.version,0),t.SendTelemetryData(E.tel_key_OSArchitecture,g.osinfo_.architecture,0),t.SendTelemetryData(E.tel_key_OSDistro,g.osinfo_.distro,0),t.SendTelemetryData(E.tel_key_OSEdition,g.osinfo_.edition,0)),g.endpointid_!=null&&g.endpointid_!=null&&(t.sessioninfo_.endpointId=g.endpointid_.machine_id),g.hardwareinfo_!=null&&g.hardwareinfo_!=null&&(t.sessioninfo_.hardware_info=g.hardwareinfo_,t.SendTelemetryData(E.tel_key_CPUModel,g.hardwareinfo_.cpu_info.cpumodel,0),t.SendTelemetryData(E.tel_key_CPUProcessors,g.hardwareinfo_.cpu_info.numberofprocessors,0),t.SendTelemetryData(E.tel_key_CPUGpuinfo,JSON.stringify(g.hardwareinfo_.gpu_info.gpus),0),t.SendTelemetryData(E.tel_key_CPUTotalmemory,g.hardwareinfo_.memory_info.totalmemory,0)),m.pstn_=l.isFeatureSupported(A.Features.FEATURE_public_pstn),m.dtmfswitch_=l.isFeatureSupported(A.Features.FEATURE_public_dtmf),m.appshare_=l.isFeatureSupported(A.Features.FEATURE_public_app_sharing),m.webrtc1dot0_=l.isFeatureSupported(A.Features.FEATURE_public_webrtc1dot0),m.datachannel_=l.isFeatureSupported(A.Features.FEATURE_public_data_channel),m.vdnobuflimit_=l.isFeatureSupported(A.Features.FEATURE_public_vdnobuflimit),m.callconstraints_=l.isFeatureSupported(A.Features.FEATURE_public_stream_resolution),m.trackclonewithid_=l.isFeatureSupported(A.Features.FEATURE_public_track_clone_with_id),m.senderstatsfix_=l.isFeatureSupported(A.Features.FEATURE_public_sender_stats_fix),m.gtc_=l.isFeatureSupported(A.Features.FEATURE_public_gtc),u(t.sessioninfo_),t.enginecontrol_.release()}).catch(function(){j.getRedirector().isPingActive()?t.retrySessionInfo():(h(),t.enginecontrol_.release(),t.enginecontrol_=null)})})},m.prototype.retrySessionInfo=function(){var l=this;setTimeout(function(){c.logger.info("checking if we are connected..."),l.enginecontrol_.bind(),j.getRedirector().handleRemoteSessionInfo()},15e3)},m.prototype.SendTelemetryData=function(l,t,u){j.getRedirector().telemetry.SendTelemetryData(E.tel_cmd.Data,l,t,u)},m.pstn_=!1,m.dtmfswitch_=!1,m.appshare_=!1,m.webrtc1dot0_=!1,m.datachannel_=!1,m.vdnobuflimit_=!1,m.callconstraints_=!1,m.trackclonewithid_=!1,m.senderstatsfix_=!1,m.gtc_=!1,m}(),e.RemoteSession=f},24:function(f,e,p){var V=this&&this.__extends||function(){var m=function(l,t){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var g in h)h.hasOwnProperty(g)&&(u[g]=h[g])},m(l,t)};return function(l,t){function u(){this.constructor=l}m(l,t),l.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),j=this&&this.__read||function(m,l){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var t=typeof Symbol=="function"&&m[Symbol.iterator];if(!t)return m;var u=t.call(m),h,g=[],y;try{for(;(l===void 0||0<l--)&&!(h=u.next()).done;)g.push(h.value)}catch(a){y={error:a}}finally{try{h&&!h.done&&(t=u.return)&&t.call(u)}finally{if(y)throw y.error}}return g};Object.defineProperty(e,"__esModule",{value:!0}),e.RtcDataChannel=e.RTCSctpTransport=void 0;var A=p(658),S=p(550),c=p(851),w=p(589),E=p(259),R;(function(m){m[m.new=0]="new",m[m.connecting=1]="connecting",m[m.connected=2]="connected",m[m.closed=3]="closed",m[m.max=4]="max"})(R||(R={})),f=function(m){function l(t,u){var h=m.call(this,t,S.class_id_t.RTCSctpTransport,u,A.ProxyMode.Remote)||this;return c.logger.info(h.user_friendly_id()+".constructor"),h}return V(l,m),l.prototype.syncBarrier=function(){var t=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(u,h){t.syncBarrierDeep(u,h)&&t.waitUntilConnected("RTCSctpTransport.syncBarrier").then(function(){return c.logger.info(t.user_friendly_id()+".syncBarrierBase success."),Promise.all([t.remoteInvoke(!1,S.method_id_RTCSctpTransport_t.transport,{oid:0}),t.remoteInvoke(!1,S.method_id_RTCSctpTransport_t.state,0),t.remoteInvoke(!1,S.method_id_RTCSctpTransport_t.maxMessageSize,0),t.remoteInvoke(!1,S.method_id_RTCSctpTransport_t.maxChannels,0)])}).then(function(g){var y;y=j(g.map(function(a){return t.param0(a)}),4),g=y[0],t.sctpstate_=y[1],t.maxMessageSize_=y[2],t.maxChannels_=y[3],y=t.transport_,g==null||g.is_null!==!1||t.transport_!==null&&t.transport_.object_id()==g.oid||(y=new w.DtlsTransport(t,g.oid)),y.syncBarrier().then(function(a){c.logger.info(t.user_friendly_id()+"transport.syncBarrier(): success"),t.transport_=a,t.syncBarrierResolve(t)}).catch(function(){c.logger.error(t.user_friendly_id()+"transport.syncBarrier(): failed!"),t.transport_=null,t.syncBarrierResolve(t)})}).catch(function(g){g=t.logRemoteInvokeError(g,".syncBarrier() failed!"),t.syncBarrierReject(g)})})},Object.defineProperty(l.prototype,"transport",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_transport() called: "+this.transport_),this.transport_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"state",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_state() called: "+this.sctpstate_),this.sctpstate_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"maxMessageSize",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_maxMessageSize() called: "+this.maxMessageSize_),this.maxMessageSize_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"maxChannels",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_maxChannels() called: "+this.maxChannels_),this.maxChannels_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"onstatechange",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_onstatechange() called: "+this.onstatechange_),this.onstatechange_},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_onstatechange() called."),this.onstatechange_=t,this.waitUntilConnected(this.user_friendly_id()+".onstatechange").then(function(){var h=u.registerCallbacks(!1,u.isNullCallback(t),S.method_id_RTCSctpTransport_t.onstatechange);return h.then(function(g){u.sctpstate_=l.convertState(u.param0(g)),c.logger.info(u.user_friendly_id()+".onstatechange callback received!!! sctpstate_: "+u.sctpstate_),g=new Event("onstatechange"),u.onstatechange_(g)}),u.remoteInvoke(!0,S.method_id_RTCSctpTransport_t.onstatechange,h.success)}).catch(function(){c.logger.error(u.user_friendly_id()+".onstatechange() failed.")})},enumerable:!1,configurable:!0}),l.convertState=function(t){return t==R.new?"closed":t==R.connecting?"connecting":t==R.connected?"connected":"closed"},l}(A.ProxyObject),e.RTCSctpTransport=f;var _;(function(m){m[m.connecting=0]="connecting",m[m.open=1]="open",m[m.closing=2]="closing",m[m.closed=3]="closed"})(_||(_={})),f=function(m){function l(t,u,h){return t=m.call(this,t,S.class_id_t.RTCDataChannel,u,h)||this,t.binaryType_="blob",c.logger.info(t.user_friendly_id()+".constructor"),t}return V(l,m),l.prototype.syncBarrier=function(){var t=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(u,h){t.syncBarrierDeep(u,h)&&t.waitUntilConnected("RtcDataChannel.syncBarrier").then(function(){return c.logger.info(t.user_friendly_id()+".syncBarrier remote invoking."),Promise.all([t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.label,""),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.ordered,!0),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.maxPacketLifeTime,0),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.maxRetransmits,0),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.protocol,""),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.negotiated,!1),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.id,0),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.readyState,0),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.bufferedAmount,0),t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.bufferedAmountLowThreshold,0)])}).then(function(g){c.logger.info(t.user_friendly_id()+".syncBarrier success.");var y;g=j(g.map(function(a){return t.param0(a)}),10),t.label_=g[0],t.ordered_=g[1],t.maxPacketLifeTime_=g[2],t.maxRetransmits_=g[3],t.protocol_=g[4],t.negotiated_=g[5],t.id_=g[6],y=g[7],t.bufferedAmount_=g[8],t.bufferedAmountLowThreshold_=g[9],t.readyState_=t.toRTCDataChannelState(y),t.syncBarrierResolve(t)}).catch(function(g){g=t.logRemoteInvokeError(g,".syncBarrier() failed!"),t.syncBarrierReject(g)})})},Object.defineProperty(l.prototype,"label",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_label() called: "+this.label_),this.label_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"ordered",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_ordered() called: "+this.ordered_),this.ordered_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"maxPacketLifeTime",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_maxPacketLifeTime() called: "+this.maxPacketLifeTime_),this.maxPacketLifeTime_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"maxRetransmits",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_maxRetransmits() called: "+this.maxRetransmits_),this.maxRetransmits_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"protocol",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_protocol() called: "+this.protocol_),this.protocol_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"negotiated",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_negotiated() called: "+this.negotiated_),this.negotiated_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"id",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_id() called: "+this.id_),this.id_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"readyState",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_readyState() called: "+this.readyState_),this.readyState_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"bufferedAmount",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_bufferedAmount() called: "+this.bufferedAmount_),this.bufferedAmount_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"bufferedAmountLowThreshold",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_bufferedAmountLowThreshold() called: "+this.bufferedAmountLowThreshold_),this.bufferedAmountLowThreshold_},set:function(t){c.logger.info(this.user_friendly_id()+".get_bufferedAmountLowThreshold() called: "+t),this.bufferedAmountLowThreshold_=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"binaryType",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_binaryType() called: "+this.binaryType_),this.binaryType_},set:function(t){c.logger.info(this.user_friendly_id()+".set_binaryType() called: "+t),this.binaryType_=t=="blob"||t=="arraybuffer"?t:"blob"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"onopen",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_onopen() called."),this.onopen_},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_onopen() called."),this.onopen_=t,this.waitUntilConnected(this.user_friendly_id()+".onopen").then(function(){var h=u.registerCallbacks(!1,u.isNullCallback(t),S.method_id_RTCDataChannel_t.onopen);return h.then(function(g){c.logger.info(u.user_friendly_id()+".onopen callback received!!!"),u.syncBarrier().then(function(){c.logger.info(u.user_friendly_id()+".onopen notifying...");var y=new Event("open",{});Object.defineProperty(y,"target",{writable:!1,value:u}),u.onopen_(y)}).catch(function(){c.logger.error(u.user_friendly_id()+".syncBarrier(): failed!")})}),u.remoteInvoke(!0,S.method_id_RTCDataChannel_t.onopen,h.success)}).catch(function(){c.logger.error(u.user_friendly_id()+".onopen() failed.")})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"onbufferedamountlow",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_onbufferedamountlow() called."),this.onbufferedamountlow_},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_onbufferedamountlow() called."),this.onbufferedamountlow_=t,this.waitUntilConnected(this.user_friendly_id()+".onbufferedamountlow").then(function(){var h=u.registerCallbacks(!1,u.isNullCallback(t),S.method_id_RTCDataChannel_t.onbufferedamountlow);return h.then(function(g){c.logger.info(u.user_friendly_id()+".onbufferedamountlow callback received!!!"),g=new Event("onbufferedamountlow"),Object.defineProperty(g,"target",{writable:!1,value:u}),u.onbufferedamountlow_(g)}),u.remoteInvoke(!0,S.method_id_RTCDataChannel_t.onbufferedamountlow,h.success)}).catch(function(){c.logger.error(u.user_friendly_id()+".onbufferedamountlows() failed.")})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"onerror",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_onerror() called."),this.onerror_},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_onerror() called."),this.onerror_=t,this.waitUntilConnected(this.user_friendly_id()+".onerror").then(function(){var h=u.registerCallbacks(!1,u.isNullCallback(t),S.method_id_RTCDataChannel_t.onerror);return h.then(function(g){g=u.param0(g),c.logger.error(u.user_friendly_id()+".onerror callback received! error: "+g),g=new Event("onerror"),Object.defineProperty(g,"target",{writable:!1,value:u}),u.onerror_(g)}),u.remoteInvoke(!0,S.method_id_RTCDataChannel_t.onerror,h.success)}).catch(function(){c.logger.error(u.user_friendly_id()+".onerror() failed.")})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"onclosing",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_onclosing() called."),this.onclosing_},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_onclosing() called."),this.onclosing_=t,this.waitUntilConnected(this.user_friendly_id()+".onclosing").then(function(){var h=u.registerCallbacks(!1,u.isNullCallback(t),S.method_id_RTCDataChannel_t.onclosing);return h.then(function(g){c.logger.info(u.user_friendly_id()+".onclosing callback received!!!"),g=new Event("onclosing"),Object.defineProperty(g,"target",{writable:!1,value:u}),u.onclosing_(g)}),u.remoteInvoke(!0,S.method_id_RTCDataChannel_t.onclosing,h.success)}).catch(function(){c.logger.error(u.user_friendly_id()+".onclosing() failed.")})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"onclose",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_onclose() called."),this.onclose_},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_onclose() called."),this.onclose_=t,this.waitUntilConnected(this.user_friendly_id()+".onclose").then(function(){var h=u.registerCallbacks(!1,u.isNullCallback(t),S.method_id_RTCDataChannel_t.onclose);return h.then(function(g){c.logger.info(u.user_friendly_id()+".onclose callback received!!!"),g=new Event("onclose"),Object.defineProperty(g,"target",{writable:!1,value:u}),u.onclose_(g)}),u.remoteInvoke(!0,S.method_id_RTCDataChannel_t.onclose,h.success)}).catch(function(){c.logger.error(u.user_friendly_id()+".onclose() failed.")})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"onmessage",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_onmessage() called."),this.onmessage_},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_onmessage() called."),this.onmessage_=t,this.waitUntilConnected(this.user_friendly_id()+".onmessage").then(function(){var h=u.registerCallbacks(!1,u.isNullCallback(t),S.method_id_RTCDataChannel_t.onmessage);return h.then(function(g){c.logger.info(u.user_friendly_id()+".onmessage callback received!!!");var y=u.param0(g);g=new Event("onmessage"),y.binary?g.data=y.data_ab:(y=atob(y.data_sz),g.data=y),u.onmessage_(g)}),u.remoteInvoke(!0,S.method_id_RTCDataChannel_t.onmessage,h.success)}).catch(function(){c.logger.error(u.user_friendly_id()+".onmessage() failed.")})},enumerable:!1,configurable:!0}),l.prototype.close=function(){var t=this;c.logger.info(this.user_friendly_id()+".close() called."),this.waitUntilConnected("RTCDataChannel.close").then(function(){return t.remoteInvoke(!1,S.method_id_RTCDataChannel_t.close)}).then(function(){c.logger.info(t.user_friendly_id()+".close: success.")}).catch(function(){c.logger.error(t.user_friendly_id()+".close: failed.")})},l.prototype.send=function(t){var u=this;c.logger.debug(this.user_friendly_id()+".send() called."),this.waitUntilConnected("RTCDataChannel.send").then(function(){if(typeof t=="string")return c.logger.info(u.user_friendly_id()+"data(string): "+t),u.remoteInvoke(!1,S.method_id_RTCDataChannel_t.send_text,t);if(t instanceof Blob)t.arrayBuffer().then(function(g){return g=E.Util.toByteArray(g),u.remoteInvoke(!1,S.method_id_RTCDataChannel_t.send_binary,g)}).catch(function(){c.logger.error(u.user_friendly_id()+".arrayBuffer(): failed.")});else{var h=E.Util.toByteArray(t);return u.remoteInvoke(!1,S.method_id_RTCDataChannel_t.send_binary,h)}}).then(function(){c.logger.debug(u.user_friendly_id()+".send: success.")}).catch(function(){c.logger.error(u.user_friendly_id()+".send: failed.")})},l.prototype.toRTCDataChannelState=function(t){var u="closed";return t==_.connecting?u="connecting":t==_.open?u="open":t==_.closing?u="closing":t==_.closed&&(u="closed"),u},l}(A.ProxyObject),e.RtcDataChannel=f},484:function(f,e,p){var V=this&&this.__extends||function(){var _=function(m,l){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,u){t.__proto__=u}||function(t,u){for(var h in u)u.hasOwnProperty(h)&&(t[h]=u[h])},_(m,l)};return function(m,l){function t(){this.constructor=m}_(m,l),m.prototype=l===null?Object.create(l):(t.prototype=l.prototype,new t)}}(),j=this&&this.__values||function(_){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var m=typeof Symbol=="function"&&Symbol.iterator,l=m&&_[m],t=0;if(l)return l.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&t>=_.length&&(_=void 0),{value:_&&_[t++],done:!_}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.RtcRtpReceiveParameters=e.RtcRtpSendParameters=e.RtcRtpEncodingParameters=e.RtcRtpParameters=e.RtcRtcpParameters=e.RtcRtpHeaderExtensionParameters=e.RtcRtpCodecParameters=void 0;var A=p(851),S=function(){function _(){}return _.defRtcRtpCodecParameters=function(){return{mimeType:"",payloadType:0,sdpFmtpLine:""}},_.defRTCRtpCodecParameters=function(){return{clockRate:0,mimeType:"",payloadType:0}},_.toRtcRtpCodecParameters=function(m){var l=_.defRtcRtpCodecParameters();return m&&(m.channels&&(l.channels=m.channels),m.clockRate&&(l.clockRate=m.clockRate),m.mimeType&&(l.mimeType=m.mimeType),m.payloadType&&(l.payloadType=m.payloadType),m.sdpFmtpLine&&(l.sdpFmtpLine=m.sdpFmtpLine)),l},_.toRTCRtpCodecParameters=function(m){var l=_.defRTCRtpCodecParameters();return m&&(m.channels&&(l.channels=m.channels),m.clockRate&&(l.clockRate=m.clockRate),m.mimeType&&(l.mimeType=m.mimeType),m.payloadType&&(l.payloadType=m.payloadType),m.sdpFmtpLine&&(l.sdpFmtpLine=m.sdpFmtpLine)),l},_}();e.RtcRtpCodecParameters=S;var c=function(){function _(){}return _.defRtcRtpHeaderExtensionParameters=function(){return{encrypted:!1,id:0,uri:""}},_.defRTCRtpHeaderExtensionParameters=function(){return{id:0,uri:""}},_.toRtcRtpHeaderExtensionParameters=function(m){var l=_.defRtcRtpHeaderExtensionParameters();if(m){var t=m.encrypted;t!=null&&t!=null&&(l.encrypted=t),m.id&&(l.id=m.id),m.uri&&(l.uri=m.uri)}return l},_.toRTCRtpHeaderExtensionParameters=function(m){var l=_.defRTCRtpHeaderExtensionParameters();if(m){var t=m.encrypted;t!=null&&t!=null&&(l.encrypted=t),m.id&&(l.id=m.id),m.uri&&(l.uri=m.uri)}return l},_}();e.RtcRtpHeaderExtensionParameters=c;var w=function(){function _(){}return _.defRtcRtcpParameters=function(){return{cname:"",reducedSize:!1}},_.defRTCRtcpParameters=function(){return{}},_.toRtcRtcpParameters=function(m){var l=_.defRtcRtcpParameters();return m&&(m.cname&&(l.cname=m.cname),m=m.reducedSize,m!=null&&m!=null&&(l.reducedSize=m)),l},_.toRTCRtcpParameters=function(m){var l=_.defRTCRtcpParameters();return m&&(m.cname&&(l.cname=m.cname),m=m.reducedSize,m!=null&&m!=null&&(l.reducedSize=m)),l},_}();e.RtcRtcpParameters=w;var E=function(){function _(){}return _.defRtcRtpParameters=function(){return{codecs:[],headerExtensions:[],rtcp:w.defRtcRtcpParameters()}},_.defRTCRtpParameters=function(){return{codecs:[],headerExtensions:[],rtcp:w.defRTCRtcpParameters()}},_.toRtcRtpParameters=function(m){var l,t,u,h,g=_.defRtcRtpParameters();if(m){if(m.codecs)try{for(var y=j(m.codecs),a=y.next();!a.done;a=y.next())g.codecs.push(S.toRtcRtpCodecParameters(a.value))}catch(I){l={error:I}}finally{try{a&&!a.done&&(t=y.return)&&t.call(y)}finally{if(l)throw l.error}}if(m.headerExtensions)try{for(var v=j(m.headerExtensions),d=v.next();!d.done;d=v.next())g.headerExtensions.push(c.toRtcRtpHeaderExtensionParameters(d.value))}catch(I){u={error:I}}finally{try{d&&!d.done&&(h=v.return)&&h.call(v)}finally{if(u)throw u.error}}m.rtcp&&(g.rtcp=w.toRtcRtcpParameters(m.rtcp))}return g},_.toRTCRtpParameters=function(m){var l,t,u,h,g=_.defRTCRtpParameters();if(m){if(m.codecs)try{for(var y=j(m.codecs),a=y.next();!a.done;a=y.next())g.codecs.push(S.toRTCRtpCodecParameters(a.value))}catch(I){l={error:I}}finally{try{a&&!a.done&&(t=y.return)&&t.call(y)}finally{if(l)throw l.error}}if(m.headerExtensions)try{for(var v=j(m.headerExtensions),d=v.next();!d.done;d=v.next())g.headerExtensions.push(c.toRTCRtpHeaderExtensionParameters(d.value))}catch(I){u={error:I}}finally{try{d&&!d.done&&(h=v.return)&&h.call(v)}finally{if(u)throw u.error}}m.rtcp&&(g.rtcp=w.toRtcRtcpParameters(m.rtcp))}return g},_}();e.RtcRtpParameters=E;var R=function(){function _(){}return _.defRtcRtpEncodingParameters=function(){return{active:!0,rid:""}},_.defRTCRtpEncodingParameters=function(){return{}},_.toRtcRtpEncodingParameters=function(m){var l=_.defRtcRtpEncodingParameters();if(m){var t=m.active;t!=null&&t!=null&&(l.active=t),m.maxBitrate&&(l.maxBitrate=m.maxBitrate),m.maxFramerate&&(l.maxFramerate=m.maxFramerate),m.scaleResolutionDownBy&&(l.scaleResolutionDownBy=m.scaleResolutionDownBy),m.rid&&(l.rid=m.rid),m.networkPriority&&(l.networkPriority=m.networkPriority)}return l},_.toRTCRtpEncodingParameters=function(m){var l=_.defRTCRtpEncodingParameters();if(m){var t=m.active;t!=null&&t!=null&&(l.active=t),m.maxBitrate&&(l.maxBitrate=m.maxBitrate),m.maxFramerate&&(l.maxFramerate=m.maxFramerate),m.scaleResolutionDownBy&&(l.scaleResolutionDownBy=m.scaleResolutionDownBy),m.rid&&(l.rid=m.rid),m.networkPriority&&(l.networkPriority=m.networkPriority)}return l},_}();e.RtcRtpEncodingParameters=R,f=function(_){function m(){return _!==null&&_.apply(this,arguments)||this}return V(m,_),m.defRtcRtpSendParameters=function(){var l=E.defRtcRtpParameters();return l.encodings=[],l.transaction_id="",l},m.defRTCRtpSendParameters=function(){var l=E.defRTCRtpParameters();return l.encodings=[],l.transactionId="",l},m.toRtcRtpSendParameters=function(l){var t,u;A.logger.info("RtcRtpSendParameters.toRtcRtpSendParameters() in param:"+JSON.stringify(l));var h=m.defRtcRtpSendParameters(),g=E.toRtcRtpParameters(l);if(g.codecs.forEach(function(v){return h.codecs.push(v)}),g.headerExtensions.forEach(function(v){return h.headerExtensions.push(v)}),h.rtcp=g.rtcp,l){if(l.encodings)try{for(var y=j(l.encodings),a=y.next();!a.done;a=y.next())h.encodings.push(R.toRtcRtpEncodingParameters(a.value))}catch(v){t={error:v}}finally{try{a&&!a.done&&(u=y.return)&&u.call(y)}finally{if(t)throw t.error}}l.transactionId&&(h.transaction_id=l.transactionId)}return A.logger.info("RtcRtpSendParameters.toRtcRtpSendParameters() out param:"+JSON.stringify(h)),h},m.toRTCRtpSendParameters=function(l){var t,u;A.logger.info("RtcRtpSendParameters.toRTCRtpSendParameters() in param:"+JSON.stringify(l));var h=m.defRTCRtpSendParameters(),g=E.toRTCRtpParameters(l);if(g.codecs.forEach(function(v){return h.codecs.push(v)}),g.headerExtensions.forEach(function(v){return h.headerExtensions.push(v)}),h.rtcp=g.rtcp,l){if(l.encodings)try{for(var y=j(l.encodings),a=y.next();!a.done;a=y.next())h.encodings.push(R.toRTCRtpEncodingParameters(a.value))}catch(v){t={error:v}}finally{try{a&&!a.done&&(u=y.return)&&u.call(y)}finally{if(t)throw t.error}}l.transaction_id&&(h.transactionId=l.transaction_id)}return A.logger.info("RtcRtpSendParameters.toRTCRtpSendParameters() out param:"+JSON.stringify(h)),h},m}(E),e.RtcRtpSendParameters=f,f=function(_){function m(){return _!==null&&_.apply(this,arguments)||this}return V(m,_),m.defRtcRtpReceiveParameters=function(){return E.defRtcRtpParameters()},m.defRTCRtpReceiveParameters=function(){return E.defRTCRtpParameters()},m.toRtcRtpReceiveParameters=function(l){return A.logger.info("RtcRtpReceiveParameters.toRtcRtpReceiveParameters() in param:"+JSON.stringify(l)),l=E.toRtcRtpParameters(l),A.logger.info("RtcRtpReceiveParameters.toRtcRtpReceiveParameters() out param:"+JSON.stringify(l)),l},m.toRTCRtpReceiveParameters=function(l){return A.logger.info("RtcRtpReceiveParameters.toRTCRtpReceiveParameters() in param:"+JSON.stringify(l)),l=E.toRTCRtpParameters(l),A.logger.info("RtcRtpReceiveParameters.toRTCRtpReceiveParameters() out param:"+JSON.stringify(l)),l},m}(E),e.RtcRtpReceiveParameters=f},589:function(f,e,p){var V=this&&this.__extends||function(){var a=function(v,d){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,k){I.__proto__=k}||function(I,k){for(var D in k)k.hasOwnProperty(D)&&(I[D]=k[D])},a(v,d)};return function(v,d){function I(){this.constructor=v}a(v,d),v.prototype=d===null?Object.create(d):(I.prototype=d.prototype,new I)}}(),j=this&&this.__read||function(a,v){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var d=typeof Symbol=="function"&&a[Symbol.iterator];if(!d)return a;var I=d.call(a),k,D=[],F;try{for(;(v===void 0||0<v--)&&!(k=I.next()).done;)D.push(k.value)}catch(H){F={error:H}}finally{try{k&&!k.done&&(d=I.return)&&d.call(I)}finally{if(F)throw F.error}}return D};Object.defineProperty(e,"__esModule",{value:!0}),e.RtpReceiver=e.RtpSender=e.RtpSenderReceiver=e.DtlsTransport=e.IceTransport=e.DtmfSender=e.DTMFToneChangeEvent=void 0;var A=p(658),S=p(550),c=p(851),w=p(144),E=p(517),R=p(650),_=p(484),m=function(a){function v(d,I){var k=a.call(this,d,S.class_id_t.RTCDTMFToneChangeEvent,I,A.ProxyMode.Remote)||this;return c.logger.info(k.user_friendly_id()+".constructor"),k}return V(v,a),v.prototype.syncBarrier=function(){var d=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(I,k){d.syncBarrierDeep(I,k)&&d.waitUntilConnected(d.user_friendly_id()+".syncBarrier").then(function(){Promise.all([d.remoteInvoke(!1,S.method_id_RTCDTMFToneChangeEvent_t.tone,""),d.remoteInvoke(!1,S.method_id_RTCDTMFToneChangeEvent_t.tone_buffer,"")]).then(function(D){c.logger.info(d.user_friendly_id()+".syncBarrier(): success."),D=j(D.map(function(F){return d.param0(F)}),2),d.tone=D[0],d.tone_buffer_=D[1],d.syncBarrierResolve(d)}).catch(function(D){D=d.logRemoteInvokeError(D,".prop.syncBarrier() failed."),d.syncBarrierReject(D)})}).catch(function(D){D=d.logRemoteInvokeError(D,".syncBarrier() failed."),d.syncBarrierReject(D)})})},Object.defineProperty(v.prototype,"tone_buffer",{get:function(){return this.tone_buffer_},enumerable:!1,configurable:!0}),v}(A.ProxyObject);e.DTMFToneChangeEvent=m;var l=function(a){function v(d,I){var k=a.call(this,d,S.class_id_t.RTCDTMFSender,I,A.ProxyMode.Remote)||this;return c.logger.info(k.user_friendly_id()+".constructor"),k.canInsertDTMF=!0,k.toneBuffer_="",k}return V(v,a),v.prototype.insertDTMF=function(d,I,k){var D=this;I===void 0&&(I=100),k===void 0&&(k=70),c.logger.info(this.user_friendly_id()+".insertDTMF() called, tones: "+d),this.waitUntilConnected("DtmfSender.insertDTMF").then(function(){return D.remoteInvoke(!1,S.method_id_RTCDTMFSender_t.insertDTMF,d,I,k)}).then(function(){c.logger.info(D.user_friendly_id()+".insertDTMF() success, tones: "+d)}).catch(function(F){D.logRemoteInvokeError(F,".insertDTMF() failed!")})},Object.defineProperty(v.prototype,"ontonechange",{get:function(){return this.ontonechange_},set:function(d){var I=this;c.logger.info(this.user_friendly_id()+".set_ontonechange() called."),this.ontonechange_=d,this.waitUntilConnected("DtmfSender.ontonechange").then(function(){var k=I.registerCallbacks(!1,I.isNullCallback(d),S.method_id_RTCDTMFSender_t.ontonechange);return k.then(function(D){c.logger.info(I.user_friendly_id()+".ontonechange callback received!"),new m(I,I.param0(D).oid).syncBarrier().then(function(F){c.logger.info(I.user_friendly_id()+"tone: "+F.tone+" tone_buffer: "+F.tone_buffer),I.toneBuffer_=F.tone_buffer,I.ontonechange_(F)}).catch(function(F){I.logRemoteInvokeError(F,".toneEvt.syncBarrier() failed!")})}),I.remoteInvoke(!0,S.method_id_RTCDTMFSender_t.ontonechange,k.success)}).catch(function(k){I.logRemoteInvokeError(k,".set_ontonechange() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"toneBuffer",{get:function(){return c.logger.debug(this.user_friendly_id()+".toneBuffer() called."),this.toneBuffer_},enumerable:!1,configurable:!0}),v}(A.ProxyObject);e.DtmfSender=l;var t=function(a){function v(d,I){var k=a.call(this,d,S.class_id_t.RTCIceTransport,I,A.ProxyMode.Remote)||this;return c.logger.info(k.user_friendly_id()+".constructor"),k.selectedPair=null,k.localCandidates_=[],k.remoteCandidates_=[],k}return V(v,a),v.prototype.syncBarrier=function(){var d=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(I,k){d.syncBarrierDeep(I,k)&&d.waitUntilConnected("IceTransport.syncBarrier").then(function(){return Promise.all([d.remoteInvoke(!1,S.method_id_RTCIceTransport_t.role,0),d.remoteInvoke(!1,S.method_id_RTCIceTransport_t.component,0),d.remoteInvoke(!1,S.method_id_RTCIceTransport_t.state,0),d.remoteInvoke(!1,S.method_id_RTCIceTransport_t.gatheringState,0)])}).then(function(D){c.logger.info(d.user_friendly_id()+".syncBarrier success.");var F=0,H=0;D=j(D.map(function(L){return d.param0(L)}),4),d.role_=D[0],d.component_=D[1],F=D[2],H=D[3],d.state_=v.convertState(F),d.gatheringState_=v.convertGatheringState(H),d.syncBarrierResolve(d)}).catch(function(D){D=d.logRemoteInvokeError(D,".syncBarrier() failed!"),d.syncBarrierReject(D)})})},v.prototype.syncCandidates=function(){var d=this;return c.logger.info(this.user_friendly_id()+".syncCandidates() called."),new Promise(function(I,k){d.waitUntilConnected("IceTransport.syncCandidates").then(function(){return Promise.all([d.remoteInvoke(!1,S.method_id_RTCIceTransport_t.localcandidates,[]),d.remoteInvoke(!1,S.method_id_RTCIceTransport_t.remotecandidates,[])])}).then(function(D){c.logger.info(d.user_friendly_id()+".syncCandidates success."),D=j(D.map(function(F){return d.param0(F)}),2),d.localCandidates_=D[0],d.remoteCandidates_=D[1],I(d)}).catch(function(D){D=d.logRemoteInvokeError(D,".syncCandidates() failed!"),k(D)})})},Object.defineProperty(v.prototype,"role",{get:function(){return this.role_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"component",{get:function(){return this.component_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"State",{get:function(){return this.state_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"gatheringState",{get:function(){return this.gatheringState_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onstatechange",{get:function(){return this.onstatechange_},set:function(d){var I=this;c.logger.info(this.user_friendly_id()+".set_onstatechange() called."),this.onstatechange_=d,this.waitUntilConnected("IceTransport.onstatechange").then(function(){var k=I.registerCallbacks(!1,I.isNullCallback(d),S.method_id_RTCIceTransport_t.onstatechange);return k.then(function(D){c.logger.info(I.user_friendly_id()+".onstatechange callback received!"),I.syncCandidates().then(function(F){c.logger.info(I.user_friendly_id()+"received updated ice candidates!")}),I.state_=v.convertState(I.param0(D)),c.logger.info(I.user_friendly_id()+"state: "+I.state_),I.onstatechange_()}),I.remoteInvoke(!0,S.method_id_RTCIceTransport_t.onstatechange,k.success)}).catch(function(k){I.logRemoteInvokeError(k,".set_onstatechange failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"ongatheringstatechange",{get:function(){return this.ongatheringstatechange_},set:function(d){var I=this;c.logger.info(this.user_friendly_id()+".set_ongatheringstatechange() called."),this.ongatheringstatechange_=d,this.waitUntilConnected("IceTransport.ongatheringstatechange").then(function(){var k=I.registerCallbacks(!1,I.isNullCallback(d),S.method_id_RTCIceTransport_t.ongatheringstatechange);return k.then(function(D){c.logger.info(I.user_friendly_id()+".ongatheringstatechange callback received!"),I.syncCandidates().then(function(F){c.logger.info(I.user_friendly_id()+"received updated ice candidates!")}),I.gatheringState_=v.convertGatheringState(I.param0(D)),c.logger.info(I.user_friendly_id()+"gatheringState: "+I.gatheringState_),I.ongatheringstatechange_()}),I.remoteInvoke(!0,S.method_id_RTCIceTransport_t.ongatheringstatechange,k.success)}).catch(function(k){I.logRemoteInvokeError(k,".set_ongatheringstatechange failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onselectedcandidatepairchange",{get:function(){return this.onselectedcandidatepairchange_},set:function(d){var I=this;c.logger.info(this.user_friendly_id()+".set_onselectedcandidatepairchange() called."),this.onselectedcandidatepairchange_=d,this.waitUntilConnected("IceTransport.onselectedcandidatepairchange").then(function(){var k=I.registerCallbacks(!1,I.isNullCallback(d),S.method_id_RTCIceTransport_t.onselectedcandidatepairchange);return k.then(function(D){c.logger.info(I.user_friendly_id()+".onselectedcandidatepairchange callback received!"),I.syncCandidates().then(function(F){c.logger.info(I.user_friendly_id()+"received updated ice candidates!")}),I.selectedPair=I.param0(D),c.logger.info(I.user_friendly_id()+"selectedPair: "+I.selectedPair),I.onselectedcandidatepairchange_()}),I.remoteInvoke(!0,S.method_id_RTCIceTransport_t.onselectedcandidatepairchange,k.success)}).catch(function(k){I.logRemoteInvokeError(k,".set_onselectedcandidatepairchange failed!")})},enumerable:!1,configurable:!0}),v.prototype.getLocalCandidates=function(){return this.localCandidates_},v.prototype.getRemoteCandidates=function(){return this.remoteCandidates_},v.prototype.getLocalParameters=function(){return null},v.prototype.getRemoteParameters=function(){return null},v.prototype.getSelectedCandidatePair=function(){return this.selectedPair},v.convertState=function(d){return d==0?"new":d==1?"checking":d==2?"connected":d==3?"completed":d==4?"failed":d==5?"disconnected":"closed"},v.convertGatheringState=function(d){return d==0?"new":d==1?"gathering":"complete"},v}(A.ProxyObject);e.IceTransport=t;var u;(function(a){a[a.new=0]="new",a[a.connecting=1]="connecting",a[a.connected=2]="connected",a[a.closed=3]="closed",a[a.failed=4]="failed",a[a.max=5]="max"})(u||(u={}));var h=function(a){function v(d,I){var k=a.call(this,d,S.class_id_t.RTCDtlsTransport,I,A.ProxyMode.Remote)||this;return c.logger.info(k.user_friendly_id()+".constructor"),k.state_="new",k.transport_=null,k.remoteCertificates_=[],k}return V(v,a),v.prototype.dumpInfo=function(){c.logger.debug("DtlsTransport["+this.object_id()+`].dumpInfo():
    - state:`+this.state_+`
    - transport:`+this.transport_)},v.prototype.syncBarrier=function(){var d=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(I,k){d.syncBarrierDeep(I,k)&&d.waitUntilConnected("DtlsTransport.syncBarrier").then(function(){return Promise.all([d.remoteInvoke(!1,S.method_id_RTCDtlsTransport_t.transport,{}),d.remoteInvoke(!1,S.method_id_RTCDtlsTransport_t.state,0),d.remoteInvoke(!1,S.method_id_RTCDtlsTransport_t.getRemoteCertificates)])}).then(function(D){var F;c.logger.info(d.user_friendly_id()+".syncBarrier remote success.");var H;F=j(D.map(function(L){return d.param0(L)}),3),D=F[0],H=F[1],d.remoteCertificates_=F[2],d.state_=v.convertState(H),F=[],D!=null&&D.is_null==0?(H=d.transport_,(d.transport_===null||d.transport_.object_id()!=D.oid)&&(H=new t(d,D.oid)),F.push(H.syncBarrier())):F.push(Promise.resolve(null)),Promise.all(F).then(function(L){c.logger.info(d.user_friendly_id()+".syncBarrier success"),d.transport_=L[0],d.syncBarrierResolve(d)}).catch(function(L){L=d.logRemoteInvokeError(L,".prop.syncBarrier failed!"),d.syncBarrierReject(L)})}).catch(function(D){D=d.logRemoteInvokeError(D,".syncBarrier failed!"),d.syncBarrierReject(D)})})},Object.defineProperty(v.prototype,"transport",{get:function(){return this.transport_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"state",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_state() called: "+this.state_),this.state_},enumerable:!1,configurable:!0}),v.prototype.getRemoteCertificates=function(){return this.remoteCertificates_},Object.defineProperty(v.prototype,"onstatechange",{get:function(){return this.onstatechange_},set:function(d){var I=this;c.logger.info(this.user_friendly_id()+".set_onstatechange() called."),this.onstatechange_=d,this.waitUntilConnected("DtlsTransport.onstatechange").then(function(){var k=I.registerCallbacks(!1,I.isNullCallback(d),S.method_id_RTCDtlsTransport_t.onstatechange);return k.then(function(D){c.logger.info(I.user_friendly_id()+".onstatechange callback received!"),I.state_=v.convertState(I.param0(D)),c.logger.info(I.user_friendly_id()+"state_: "+I.state_),I.onstatechange_()}),I.remoteInvoke(!0,S.method_id_RTCDtlsTransport_t.onstatechange,k.success)}).catch(function(k){I.logRemoteInvokeError(k,".set_onstatechange failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onerror",{get:function(){return this.onerror_},set:function(d){var I=this;c.logger.info(this.user_friendly_id()+".set_onerror() called."),this.onerror_=d,this.waitUntilConnected("DtlsTransport.onerror").then(function(){var k=I.registerCallbacks(!1,I.isNullCallback(d),S.method_id_RTCDtlsTransport_t.onerror);return k.then(function(D){D=I.param0(D),c.logger.error(I.user_friendly_id()+".onerror callback received! error: "+D),I.onerror_(D)}),I.remoteInvoke(!0,S.method_id_RTCDtlsTransport_t.onerror,k.success)}).catch(function(k){I.logRemoteInvokeError(k,".set_onerror failed!")})},enumerable:!1,configurable:!0}),v.convertState=function(d){return d==u.new?"new":d==u.connecting?"connecting":d==u.connected?"connected":d==u.closed?"closed":"failed"},v}(A.ProxyObject);e.DtlsTransport=h,f=function(a){function v(d,I,k,D){return d=a.call(this,d,I,k,D)||this,c.logger.debug(d.user_friendly_id()+".constructor base"),d.track_=null,d.transport_=null,d}return V(v,a),v.prototype.syncBarrierBase=function(){c.logger.info(this.user_friendly_id()+".syncBarrierBase() called.");var d=[],I,k;return this instanceof g?(I=S.method_id_RTCRtpSender_t.track,k=S.method_id_RTCRtpSender_t.transport):this instanceof y&&(I=S.method_id_RTCRtpReceiver_t.track,k=S.method_id_RTCRtpReceiver_t.transport),R.RemoteSession.isFeaturePstnSupported()&&R.RemoteSession.isFeatureDtmfSupported()?(d.push(this.remoteInvoke(!1,I,{oid:0})),d.push(this.remoteInvoke(!1,k,{oid:0}))):d.push(this.remoteInvoke(!1,I,{oid:0})),d},v.prototype.syncBarrierBaseResults=function(d){var I,k,D=this;k=0,c.logger.info(this.user_friendly_id()+".syncBarrierBaseResults"),R.RemoteSession.isFeaturePstnSupported()&&R.RemoteSession.isFeatureDtmfSupported()?(I=j(d.map(function(L){return D.param0(L)}),2),d=I[0],I=I[1],k=2):(k=j(d.map(function(L){return D.param0(L)}),1),d=k[0],k=1);var F=[];if(d!=null&&d.is_null===!1){var H=this.track_;this.track_===null||this.track_.object_id()!=d.oid?H=new w.RemoteMediaTrack(this,d.oid):this.track_.bind(this,d.oid),F.push(H.syncBarrier())}else F.push(Promise.resolve(null));return I!=null&&I.is_null===!1?(d=this.transport_,(this.transport_===null||this.transport_.object_id()!=I.oid)&&(d=new h(this,I.oid)),F.push(d.syncBarrier())):F.push(Promise.resolve(null)),[k,F]},v.prototype.syncBarrierBaseResultsWithAllPromisesFulFilled=function(d){this.track_=d[0],this.transport_=d[1]},Object.defineProperty(v.prototype,"transport",{get:function(){return c.logger.debug(this.user_friendly_id()+".get transport() called."),this.transport_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"rtcpTransport",{get:function(){return c.logger.debug(this.user_friendly_id()+".get rtcpTransport() called."),this.transport_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"track",{get:function(){return this.track_},enumerable:!1,configurable:!0}),v.prototype.reinitTrack=function(d){this.track_=d},v.prototype.getStats=function(){c.logger.debug(this.user_friendly_id()+".getStats() called.");var d=this;return new Promise(function(I,k){d.isRedirected()?d.waitUntilConnected("RtpReceiver.getStats").then(function(){if(R.RemoteSession.isFeatureSenderStatsFixSupported()){var D;d instanceof g?D=S.method_id_RTCRtpSender_t.getStats:d instanceof y&&(D=S.method_id_RTCRtpReceiver_t.getStats);var F=d.registerCallbacks(!0,!1,D);return F.then(function(H){H.params===void 0||H.params.length===0||H.params[0].length===0?I():I(E.StatsReport.fromJSON(JSON.parse(H.params[0])))}),d.remoteInvoke(!1,D,F.success)}I()}).catch(function(D){D=d.logRemoteInvokeError(D,".getStats() failed!"),k(D)}):(c.logger.debug(d.user_friendly_id()+".getStats(): not in active redirection!"),I())})},v}(A.ProxyObject),e.RtpSenderReceiver=f;var g=function(a){function v(d,I,k,D){return d=a.call(this,d,S.class_id_t.RTCRtpSender,I,k)||this,c.logger.info(d.user_friendly_id()+".constructor"),d.dtmf_=null,d.params_=_.RtcRtpSendParameters.defRtcRtpSendParameters(),d.unified_=D,d}return V(v,a),v.prototype.dumpInfo=function(){c.logger.debug("RtpSender["+this.object_id()+"].dumpInfo():"),this.track&&this.track.dumpInfo()},v.prototype.syncBarrier=function(){var d=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(I,k){d.syncBarrierDeep(I,k)&&d.waitUntilConnected("RtpSender.syncBarrier").then(function(){var D=a.prototype.syncBarrierBase.call(d);return R.RemoteSession.isFeaturePstnSupported()&&R.RemoteSession.isFeatureDtmfSupported()&&(D.push(d.remoteInvoke(!1,S.method_id_RTCRtpSender_t.dtmf,{oid:0})),D.push(d.remoteInvoke(!1,S.method_id_RTCRtpSender_t.getParameters))),Promise.all(D)}).then(function(D){var F,H;F=j(d.syncBarrierBaseResults(D),2),H=F[0],F=F[1],D=j(D.slice(H).map(function(L){return d.param0(L)}),2),H=D[0],d.params_=D[1],H==null||H.is_null!==!1||d.dtmf_!==null&&d.dtmf_.object_id()==H.oid||(d.dtmf_=new l(d,H.oid)),Promise.all(F).then(function(L){d.syncBarrierBaseResultsWithAllPromisesFulFilled(L),c.logger.info(d.user_friendly_id()+".syncBarrierBase success."),d.syncBarrierResolve(d)}).catch(function(L){L=d.logRemoteInvokeError(L,".syncBarrier() promises_base failed!"),d.syncBarrierReject(L)})}).catch(function(D){D=d.logRemoteInvokeError(D,".syncBarrier failed!"),d.syncBarrierReject(D)})})},v.getCapabilities=function(d){return c.logger.debug(this.constructor.name+".getCapabilities() called."),w.NavigatorUserMedia.getCapabilities(d)},Object.defineProperty(v.prototype,"dtmf",{get:function(){return c.logger.debug(this.user_friendly_id()+".get dtmf() called."),this.dtmf_},enumerable:!1,configurable:!0}),v.prototype.setParameters=function(d){return this.setParametersAsync(d)},v.prototype.setParametersAsync=function(d){var I=this;return c.logger.info(this.user_friendly_id()+".setParametersAsync() called."),new Promise(function(k,D){I.waitUntilConnected("RtpSender.setParametersAsync").then(function(){return Promise.all([I.remoteInvoke(!1,S.method_id_RTCRtpSender_t.setParameters,_.RtcRtpSendParameters.toRtcRtpSendParameters(d))])}).then(function(F){c.logger.info(I.user_friendly_id()+".setParametersAsync(): success."),k(),I.params_=_.RtcRtpSendParameters.toRtcRtpSendParameters(d)}).catch(function(F){F=I.logRemoteInvokeError(F,".setParametersAsync() failed!"),D(F)})})},v.prototype.getParameters=function(){return c.logger.info(this.user_friendly_id()+".getParameters() called."),this.getParametersInternal(!1)},v.prototype.getParametersAsync=function(){return c.logger.info(this.user_friendly_id()+".getParametersAsync() called."),this.getParametersInternal(!0)},v.prototype.getParametersInternal=function(d){var I=this,k=new Promise(function(D,F){I.waitUntilConnected(I.user_friendly_id()+".getParametersInternal").then(function(){return c.logger.info(I.user_friendly_id()+".getParametersInternal() remote invoking"),I.remoteInvoke(!1,S.method_id_RTCRtpSender_t.getParameters)}).then(function(H){I.params_=I.param0(H),c.logger.info(I.user_friendly_id()+".getParametersInternal() success returning: "+I.params_),D(_.RtcRtpSendParameters.toRTCRtpSendParameters(I.params_))}).catch(function(H){H=I.logRemoteInvokeError(H,".getParametersInternal() failed!"),F(H)})});return d?k:(c.logger.info(this.user_friendly_id()+".getParametersInternal() returning: "+this.params_),_.RtcRtpSendParameters.toRTCRtpSendParameters(this.params_))},v.prototype.replaceTrack=function(d){var I=this;return c.logger.info(this.user_friendly_id()+".replaceTrack() called. current track:"+(this.track_?this.track_.object_id():"null")+" with track="+(d?d.object_id():"null")),new Promise(function(k,D){I.waitUntilConnected("RtpSender.replaceTrack").then(function(){return!d&&!R.RemoteSession.isFeatureWebrtc1dot0Supported()?Promise.reject(new DOMException("Does not support replace track with null in non-Unified SDP semantic!")):(c.logger.info(I.user_friendly_id()+".replaceTrack() removeInvoke current track:"+(I.track_?I.track_.object_id():"null")+" with track="+(d?d.object_id():"null")),d?I.remoteInvokeEx(!1,S.method_id_RTCRtpSender_t.replaceTrack,[d]):I.remoteInvoke(!1,S.method_id_RTCRtpSender_t.replaceTrack,{oid:-1}))}).then(function(F){c.logger.info(I.user_friendly_id()+".replaceTrack(): success."),k(),I.reinitTrack(d)}).catch(function(F){F=I.logRemoteInvokeError(F,".replaceTrack() failed!"),D(F)})})},v}(f);e.RtpSender=g;var y=function(a){function v(d,I,k,D,F){return d=a.call(this,d,S.class_id_t.RTCRtpReceiver,I,k)||this,c.logger.info(d.user_friendly_id()+".constructor"),d.contribsources_=[],d.syncsources_=[],d.params_=_.RtcRtpParameters.defRtcRtpParameters(),d.unified_=D,F&&(d.track_=F),d}return V(v,a),v.prototype.dumpInfo=function(){c.logger.debug("RtpReceiver["+this.object_id()+"].dumpInfo():"),this.track&&this.track.dumpInfo(),this.transport&&this.transport.dumpInfo()},v.prototype.syncBarrier=function(){var d=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(I,k){d.syncBarrierDeep(I,k)&&d.waitUntilConnected("RtpReceiver.syncBarrier").then(function(){var D=a.prototype.syncBarrierBase.call(d);return R.RemoteSession.isFeaturePstnSupported()&&R.RemoteSession.isFeatureDtmfSupported()?(D.push(d.remoteInvoke(!1,S.method_id_RTCRtpReceiver_t.getContributingSources)),D.push(d.remoteInvoke(!1,S.method_id_RTCRtpReceiver_t.getSynchronizationSources)),D.push(d.remoteInvoke(!1,S.method_id_RTCRtpReceiver_t.getParameters))):D.push(d.remoteInvoke(!1,S.method_id_RTCRtpReceiver_t.getContributingSources)),Promise.all(D)}).then(function(D){var F;c.logger.info(d.user_friendly_id()+".syncBarrier success.");var H;F=j(d.syncBarrierBaseResults(D),2),H=F[0],F=F[1],D=j(D.slice(H).map(function(L){return d.param0(L)}),3),d.contribsources_=D[0],d.syncsources_=D[1],d.params_=D[2],Promise.all(F).then(function(L){d.syncBarrierBaseResultsWithAllPromisesFulFilled(L),c.logger.info(d.user_friendly_id()+".syncBarrier success."),d.syncBarrierResolve(d)}).catch(function(L){L=d.logRemoteInvokeError(L,".syncBarrier() promises_base failed!"),d.syncBarrierReject(L)})}).catch(function(D){D=d.logRemoteInvokeError(D,".syncBarrier() failed!"),d.syncBarrierReject(D)})})},v.getCapabilities=function(d){return c.logger.debug(this.constructor.name+".getCapabilities() called."),w.NavigatorUserMedia.getCapabilities(d)},v.prototype.getContributingSources=function(){var d=this;return c.logger.info(this.user_friendly_id()+".getContributingSources() called. "+JSON.stringify(this.contribsources_)),this.waitUntilConnected("RtpReceiver.getContributingSources").then(function(){return Promise.all([d.remoteInvoke(!1,S.method_id_RTCRtpReceiver_t.getContributingSources)])}).then(function(I){I=j(I.map(function(k){return d.param0(k)}),1),d.contribsources_=I[0],c.logger.info(d.user_friendly_id(),".getContributingSources() success: "+JSON.stringify(d.contribsources_))}).catch(function(I){d.logRemoteInvokeError(I,".getContributingSources() failed!"),d.contribsources_=[]}),this.contribsources_},v.prototype.getParameters=function(){var d=this;return c.logger.info(this.user_friendly_id()+".getParameters() called."),this.waitUntilConnected(this.user_friendly_id()+".getParameters").then(function(){return c.logger.info(d.user_friendly_id()+".getParameters() remote invoking"),d.remoteInvoke(!1,S.method_id_RTCRtpReceiver_t.getParameters)}).then(function(I){c.logger.info(d.user_friendly_id()+".getParameters() success"),d.params_=d.param0(I)}).catch(function(I){d.logRemoteInvokeError(I,".getParameters() failed!")}),c.logger.info(this.user_friendly_id()+".getParameters() returning: "+this.params_),_.RtcRtpReceiveParameters.toRTCRtpReceiveParameters(this.params_)},v.prototype.getSynchronizationSources=function(){return c.logger.debug(this.user_friendly_id()+".getSynchronizationSources() called."),this.syncsources_},v}(f);e.RtpReceiver=y},377:function(f,e,p){var V=this&&this.__extends||function(){var m=function(l,t){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var g in h)h.hasOwnProperty(g)&&(u[g]=h[g])},m(l,t)};return function(l,t){function u(){this.constructor=l}m(l,t),l.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),j=this&&this.__read||function(m,l){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var t=typeof Symbol=="function"&&m[Symbol.iterator];if(!t)return m;var u=t.call(m),h,g=[],y;try{for(;(l===void 0||0<l--)&&!(h=u.next()).done;)g.push(h.value)}catch(a){y={error:a}}finally{try{h&&!h.done&&(t=u.return)&&t.call(u)}finally{if(y)throw y.error}}return g};Object.defineProperty(e,"__esModule",{value:!0}),e.RtpTransceiver=e.RtcRtpTransceiverInit=e.RtcRtpTransceiverDirection=void 0;var A=p(658),S=p(550),c=p(851),w=p(589),E=p(484),R;(function(m){m[m.sendrecv=0]="sendrecv",m[m.sendonly=1]="sendonly",m[m.recvonly=2]="recvonly",m[m.inactive=3]="inactive",m[m.stopped=4]="stopped"})(R=e.RtcRtpTransceiverDirection||(e.RtcRtpTransceiverDirection={}));var _=function(){function m(){}return m.toRtcRtpTransceiverDirection=function(l){switch(l){case"inactive":l=R.inactive;break;case"recvonly":l=R.recvonly;break;case"sendonly":l=R.sendonly;break;case"sendrecv":l=R.sendrecv;break;case"stopped":l=R.stopped;break;default:l=R.sendrecv}return l},m.toRTCRtpTransceiverDirection=function(l){switch(l){case R.inactive:l="inactive";break;case R.recvonly:l="recvonly";break;case R.sendonly:l="sendonly";break;case R.sendrecv:l="sendrecv";break;case R.stopped:l="stopped";break;default:l="sendrecv"}return l},m.toRtcRtpTransceiverInit=function(l){c.logger.info("RtcRtpTransceiverInit.toRtcRtpTransceiverInit() in init:"+JSON.stringify(l));var t={};return l&&(l.direction&&(t.direction=m.toRtcRtpTransceiverDirection(l.direction)),l.sendEncodings&&(t.sendEncodings=[],l.sendEncodings.forEach(function(u){return t.sendEncodings.push(E.RtcRtpEncodingParameters.toRtcRtpEncodingParameters(u))})),l.streams&&(t.streams=l.streams)),c.logger.info("RtcRtpTransceiverInit.toRtcRtpTransceiverInit() out init:"+JSON.stringify(t)),t},m}();e.RtcRtpTransceiverInit=_,f=function(m){function l(t,u,h,g,y,a){return t=m.call(this,t,S.class_id_t.RTCRtpTransceiver,u,h)||this,c.logger.info(t.user_friendly_id()+".constructor"),t.unified_=g,t.sender_=new w.RtpSender(t,0,A.ProxyMode.Pseudo,g),t.receiver_=a||new w.RtpReceiver(t,0,A.ProxyMode.Pseudo,g),y?(t.direction_=y,t.currentDirection_=y):(t.direction_=R.sendrecv,t.currentDirection_=R.sendrecv),t}return V(l,m),l.prototype.dumpInfo=function(){c.logger.debug(this.user_friendly_id()+".dumpInfo() [id="+this.mid+"] direction="+_.toRTCRtpTransceiverDirection(this.direction_)+" currentDirection="+_.toRTCRtpTransceiverDirection(this.currentDirection_)),this.sender&&this.sender.dumpInfo(),this.receiver&&this.receiver.dumpInfo()},l.prototype.syncBarrier=function(){var t=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(u,h){t.syncBarrierDeep(u,h)&&t.waitUntilConnected("RtpTransceiver.syncBarrier").then(function(){return Promise.all([t.remoteInvoke(!1,S.method_id_RTCRtpTransceiver_t.mid,""),t.remoteInvoke(!1,S.method_id_RTCRtpTransceiver_t.direction,0),t.remoteInvoke(!1,S.method_id_RTCRtpTransceiver_t.currentDirection,0),t.remoteInvoke(!1,S.method_id_RTCRtpTransceiver_t.sender,{oid:0}),t.remoteInvoke(!1,S.method_id_RTCRtpTransceiver_t.receiver,{oid:0})])}).then(function(g){var y;c.logger.info(t.user_friendly_id()+".syncBarrier remote success."),y=j(g.map(function(v){return t.param0(v)}),5),t.mid_=y[0],t.direction_=y[1],t.currentDirection_=y[2],g=y[3],y=y[4];var a=[];if(g!=null&&g.is_null===!1&&(t.sender_.bind(t,g.oid),a.push(t.sender_.syncBarrier())),y!=null&&y.is_null===!1&&(t.receiver_.bind(t,y.oid),a.push(t.receiver_.syncBarrier())),a.length==0)c.logger.info(t.user_friendly_id()+".syncBarrier success"),t.syncBarrierResolve(t);else return c.logger.info(t.user_friendly_id()+".prop.syncBarrier start"),Promise.all(a)}).then(function(){c.logger.info(t.user_friendly_id()+".syncBarrier success"),t.syncBarrierResolve(t)}).catch(function(g){g=t.logRemoteInvokeError(g,".syncBarrier() failed!"),t.syncBarrierReject(g)})})},Object.defineProperty(l.prototype,"mid",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_mid() called: "+this.mid_),this.mid_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"sender",{get:function(){return this.sender_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"receiver",{get:function(){return this.receiver_},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"direction",{get:function(){return c.logger.info(this.user_friendly_id()+".get_direction() called. "+_.toRTCRtpTransceiverDirection(this.direction_)),_.toRTCRtpTransceiverDirection(this.direction_)},set:function(t){var u=this;c.logger.info(this.user_friendly_id()+".set_direction() called. "+t),this.direction_=_.toRtcRtpTransceiverDirection(t),this.waitUntilConnected("RtpTransceiver.set_direction").then(function(){return u.remoteInvoke(!0,S.method_id_RTCRtpTransceiver_t.direction,_.toRtcRtpTransceiverDirection(t))}).then(function(){c.logger.info(u.user_friendly_id()+".set_direction: success.")}).catch(function(h){u.logRemoteInvokeError(h,".set_direction() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"currentDirection",{get:function(){return c.logger.debug(this.user_friendly_id()+".get_currentDirection() called. "+_.toRTCRtpTransceiverDirection(this.currentDirection_)),_.toRTCRtpTransceiverDirection(this.currentDirection_)},enumerable:!1,configurable:!0}),l.prototype.stop=function(){var t=this;c.logger.info(this.user_friendly_id()+".stop() called."),this.waitUntilConnected("RtpTransceiver.stop").then(function(){return t.remoteInvoke(!0,S.method_id_RTCRtpTransceiver_t.stop)}).then(function(){c.logger.info(t.user_friendly_id()+".stop: success.")}).catch(function(u){t.logRemoteInvokeError(u,".stop() failed!")})},l.prototype.setCodecPreferences=function(t){var u=this;c.logger.info(this.user_friendly_id()+".setCodecPreferences() called."),this.waitUntilConnected("RtpTransceiver.setCodecPreferences").then(function(){return u.remoteInvoke(!0,S.method_id_RTCRtpTransceiver_t.setCodecPreferences,t)}).then(function(){c.logger.info(u.user_friendly_id()+".setCodecPreferences: success.")}).catch(function(h){u.logRemoteInvokeError(h,".setCodecPreferences() failed!")})},l}(A.ProxyObject),e.RtpTransceiver=f},973:function(f,e,p){function V(v,d){return v.find(function(I){return I===d})!==void 0}function j(v,d,I){d/=v.width,I/=v.height;var k=document.createElement("canvas"),D=k.getContext("2d");return k.width=v.width*d,k.height=v.height*I,D.putImageData(v,0,0),(d!=1||I!=1)&&(D.scale(d,I),D.drawImage(k,0,0)),k}function A(v,d,I){return v=j(v,d,I),d=document.createElement("img"),d.src=v.toDataURL(),d}function S(v,d,I,k){return I=typeof I<"u"?I:y.Width,k=typeof k<"u"?k:y.Height,d===!0?A(v,I,k):(d=null,I==v.width&&k===v.height?d=v:(v=j(v,I,k),d=v.getContext("2d").getImageData(0,0,v.width,v.height)),d)}var c=this&&this.__extends||function(){var v=function(d,I){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,D){k.__proto__=D}||function(k,D){for(var F in D)D.hasOwnProperty(F)&&(k[F]=D[F])},v(d,I)};return function(d,I){function k(){this.constructor=d}v(d,I),d.prototype=I===null?Object.create(I):(k.prototype=I.prototype,new k)}}(),w=this&&this.__read||function(v,d){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var I=typeof Symbol=="function"&&v[Symbol.iterator];if(!I)return v;var k=I.call(v),D,F=[],H;try{for(;(d===void 0||0<d--)&&!(D=k.next()).done;)F.push(D.value)}catch(L){H={error:L}}finally{try{D&&!D.done&&(I=k.return)&&I.call(k)}finally{if(H)throw H.error}}return F};Object.defineProperty(e,"__esModule",{value:!0}),e.ScreenSource=e.ScreenSourceVda=e.ScreenSharingVda=e.ScreenSharingRemote=e.ScreenSharing=e.ImageDataRemote=void 0;var E=p(658),R=p(550),_=p(851),m=p(946),l=p(691),t=p(650),u;(function(v){v[v.Legacy=0]="Legacy",v[v.MonitorsAndApps=10]="MonitorsAndApps"})(u||(u={})),f=function(){return function(v,d,I){this.data=v,this.height=d,this.width=I}}(),e.ImageDataRemote=f,f=function(){function v(){this.local_=this.remote_=null}return v.screenSharingInstance=function(d){return v.instance||(v.instance=new v,d&&(v.instance.onscreentopologychanged=d)),v.instance},v.destroyInstance=function(){v.instance&&v.instance.remote_&&v.instance.remote_.release(),v.instance=null},v.prototype.user_friendly_id=function(){return this.constructor.name+"[]"},Object.defineProperty(v.prototype,"onscreentopologychanged",{set:function(d){this.remote_||(this.remote_=new h),this.remote_.onscreentopologychanged=d,this.local_||(this.local_=new g),this.local_.onscreentopologychanged=d},enumerable:!1,configurable:!0}),v.prototype.getWindowsAsync=function(){var d=this;return _.logger.info(this.user_friendly_id()+".getWindowsAsync() called."),this.local_==null&&(this.local_=new g),new Promise(function(I,k){var D=[];d.local_.getWindowsAsync().then(function(F){F&&(D=F),_.logger.info(d.user_friendly_id()+".getWindowsAsync() returning sources"),I(D)}).catch(function(){_.logger.error("ScreenSharing.getWindowsAsync(): rejected"),I(D)})})},v.prototype.getScreensAsync=function(){var d=this;return _.logger.info(this.user_friendly_id()+".getScreensAsync() called."),this.remote_==null&&(this.remote_=new h),new Promise(function(I,k){var D=[];d.remote_.getScreensAsync().then(function(F){F&&(D=F),_.logger.info(d.user_friendly_id()+".getScreensAsync() returning sources"),I(D)}).catch(function(){_.logger.error("ScreenSharing.getScreensAsync(): rejected"),I(D)})})},v.prototype.setActiveSource=function(d,I){var k=this;return _.logger.info(this.user_friendly_id()+".setActiveSource() called. id="+d+" appshare="+I),new Promise(function(D,F){k.remote_.contains(d)?k.remote_.setActive(d).then(function(H){D(H)}).catch(function(){_.logger.error("ScreenSharing.setActiveSource(): rejected"),F()}):I&&k.local_.contains(d)?k.local_.setActive(!0,d).then(function(H){D(H)}).catch(function(){_.logger.error("ScreenSharing.setActiveSource(): rejected"),F()}):(_.logger.info("ScreenSharing.setActiveSource(): legacy screen sharing"),D(""))})},v.prototype.isAppshareActive=function(){return this.local_&&this.local_.lastActive!==-1},v.prototype.stopAppshare=function(){_.logger.info(this.user_friendly_id()+".stopAppshare() called."),this.local_&&this.local_.setActive(!1).then(function(d){_.logger.info("ScreenSharing.stopAppshare(): success, deviceid=",d)}).catch(function(){_.logger.error("ScreenSharing.stopAppshare(): failure or timeout due to nonresponsive WS Agent")})},v.instance=null,v}(),e.ScreenSharing=f;var h=function(v){function d(){var I=v.call(this,null,R.class_id_t.ScreenSharingRemote,0,E.ProxyMode.Local)||this;return _.logger.info(I.user_friendly_id()+".constructor"),I.sources_=[],I}return c(d,v),d.prototype.getSourceById=function(I){return this.sources_.find(function(k){return k.getId()==I})},d.prototype.contains=function(I){return this.getSourceById(I)!==void 0},Object.defineProperty(d.prototype,"onscreentopologychanged",{get:function(){return this.onscreentopologychanged_},set:function(I){var k=this;this.onscreentopologychanged_=I,this.waitUntilConnected(this.user_friendly_id()+".onscreentopologychanged").then(function(){var D=k.registerCallbacks(!1,k.isNullCallback(k.onscreentopologychanged_),R.method_id_VDISharingRemote_t.onscreentopologychanged);return D.then(function(){_.logger.info(k.user_friendly_id()+"onscreentopologychanged event received!!!"),k.onscreentopologychanged_&&k.onscreentopologychanged_()}),k.remoteInvoke(!0,R.method_id_VDISharingRemote_t.onscreentopologychanged,D.success)}).catch(function(D){k.logRemoteInvokeError(D,".set_onscreentopologychanged() failed!")})},enumerable:!1,configurable:!0}),d.prototype.getScreensAsync=function(){var I=this;_.logger.info(this.user_friendly_id()+".getScreensAsync() called.");var k=this.sources_;this.sources_=[];var D=m.getRedirector().vdabufferNoLimit()&&t.RemoteSession.isFeatureVdNoBufferLimitSupported();return new Promise(function(F,H){I.waitUntilConnected(I.user_friendly_id()+".getScreensAsync").then(function(){return I.remoteInvoke(!1,R.method_id_VDISharingRemote_t.getScreensAsync,D)}).then(function(L){var z=[];L.params[0].forEach(function(U){var C=k.find(function(i){return i.object_id()===U.oid});C===void 0&&(_.logger.info(I.user_friendly_id()+" create a ScreenSource with oid:"+U.oid),C=new a(I,U.oid,E.ProxyMode.Remote)),z.push(C.syncBarrier())}),Promise.all(z.map(function(U){return U.then(function(C){return{value:C,status:"fulfilled"}},function(C){return{value:C,status:"rejected"}})})).then(function(U){var C=U.filter(function(i){return i.status==="fulfilled"}).map(function(i){return i.value});I.sources_=C,k.filter(function(i){return!V(C,i)}).forEach(function(i){return i.release()}),F(C)}).catch(function(U){U=I.logRemoteInvokeError(U,".getScreensAsync() failed!"),k.forEach(function(C){C.release()}),H(U)})}).catch(function(L){L=I.logRemoteInvokeError(L,".getScreensAsync() failed!"),k.forEach(function(z){z.release()}),H(L)})})},d.prototype.setActive=function(I){var k=this;return _.logger.info(this.user_friendly_id()+".setActive() called. uniqueid="+I),new Promise(function(D,F){I!=-1?D(k.getSourceById(I).getDeviceId()):F()})},d}(E.ProxyObject);e.ScreenSharingRemote=h;var g=function(){function v(){_.logger.info(this.user_friendly_id()+".constructor"),this.sources_=[],this.lastactive_=-1}return v.prototype.user_friendly_id=function(){return this.constructor.name+"[]"},Object.defineProperty(v.prototype,"onscreentopologychanged",{set:function(d){m.getRedirector().screenshare.setTopologyChangeCB(d)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"lastActive",{get:function(){return this.lastactive_},enumerable:!1,configurable:!0}),v.prototype.getSourceById=function(d){return this.sources_.find(function(I){return I.getId()==d})},v.prototype.contains=function(d){return this.getSourceById(d)!==void 0},v.prototype.getWindowsAsync=function(){var d=this;_.logger.info(this.user_friendly_id()+".getWindowsAsync() called.");var I=this.sources_;return this.sources_=[],new Promise(function(k,D){m.getRedirector().screenshare.getSources(new l.getSourcesReqData(2)).then(function(F){if(F=F.map(function(z){var U=I.find(function(C){return C.equivalent(z)});return U!==void 0?(U.setDescription(z.getDescription()),z.getIcon().then(function(C){U.setIcon(C)}).catch(function(){_.logger.error(d.user_friendly_id()+".getWindowsAsync() failed to retrieve new icon.")}),z.getPreviewAsync().then(function(C){U.setPreview(C)}).catch(function(){_.logger.error(d.user_friendly_id()+".getWindowsAsync() failed to retrieve new preview.")}),U):z}),d.lastactive_!=-1){var H=I.find(function(z){return z.getId()==d.lastactive_}),L=F.find(function(z){return z.getId()==d.lastactive_});H!==void 0&&L===void 0&&F.push(H)}d.sources_=F,k(d.sources_)}).catch(function(){_.logger.error(d.user_friendly_id()+".getWindowsAsync(): rejected"),D()})})},v.prototype.activateSource=function(d,I){var k=this;return new Promise(function(D,F){var H=I?"activate":"deactivate";_.logger.info(k.user_friendly_id()+".activateSource() called. action="+H);var L=new l.setActiveReqData(d.srcid,d.hwnd,d.origin,d.pid,!0,!0,I);m.getRedirector().screenshare.setActive(L).then(function(z){_.logger.info(k.user_friendly_id()+": "+H+" success: srcid="+z.srcid+" deviceid="+z.bufferid),d.deviceid=z.bufferid,D(z.bufferid)}).catch(function(){_.logger.error(k.user_friendly_id()+"failed to "+H+": srcid="+d.srcid+", maybe WS Agent is too slow to respond"),F()})})},v.prototype.setActive=function(d,I){var k=this;return _.logger.info(this.user_friendly_id()+".setActive() called. uniqueid="+I),new Promise(function(D,F){d||(I=k.lastactive_),I!=-1?(d?(I!=k.lastactive_&&k.lastactive_!=-1&&k.activateSource(k.getSourceById(k.lastactive_),!1),k.lastactive_=I):k.lastactive_=-1,k.activateSource(k.getSourceById(I),d).then(function(H){D(d?"RemoteApplication-"+H:H)}).catch(function(){F()})):F()})},v}();e.ScreenSharingVda=g;var y=function(){function v(){}return v.Width=140,v.Height=90,v}();f=function(){function v(d,I,k,D,F,H,L,z,U,C){this.uniqueid_=a.nextId_++,this.srcid_=d,this.deviceid_=I,this.type_=k,this.imagedata_=D,this.icon_=F,this.name_=H,this.hwnd_=L,this.origin_=z,this.caption_=U,this.pid_=C}return v.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.uniqueid_+"]"},Object.defineProperty(v.prototype,"srcid",{get:function(){return this.srcid_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"hwnd",{get:function(){return this.hwnd_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"origin",{get:function(){return this.origin_},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"pid",{get:function(){return this.pid_},enumerable:!1,configurable:!0}),v.prototype.getId=function(){return this.uniqueid_},v.prototype.getDeviceId=function(){return this.deviceid_},Object.defineProperty(v.prototype,"deviceid",{set:function(d){this.deviceid_=d},enumerable:!1,configurable:!0}),v.prototype.getType=function(){return 2},v.prototype.getPreview=function(d,I,k){return _.logger.debug(this.user_friendly_id()+".getPreview() called, width:"+d+" height:"+I+" asImage:"+k),Promise.reject(null)},v.prototype.setPreview=function(d){this.imagedata_=d},v.prototype.getPreviewAsync=function(d,I,k){return _.logger.debug(this.user_friendly_id()+".getPreviewAsync() called, width:"+d+" height:"+I),k===!0?(d=A(this.imagedata_,y.Width,y.Height),Promise.resolve({data:d.src.replace(/^data:image\/(png|jpg);base64,/,"")})):Promise.resolve(this.imagedata_)},v.prototype.getPreviewImage=function(d,I,k){return _.logger.debug(this.user_friendly_id()+".getPreviewImage() called, width:"+I+" height:"+k),Promise.resolve(S(this.imagedata_,d,I,k))},v.prototype.getDescription=function(){return this.name_},v.prototype.setDescription=function(d){this.name_=d},v.prototype.getIcon=function(d,I,k){return k===!0?(d=A(this.icon_,y.Width,y.Height),Promise.resolve({data:d.src.replace(/^data:image\/(png|jpg);base64,/,"")})):Promise.resolve(this.icon_)},v.prototype.getIconImage=function(d,I,k){return _.logger.debug(this.user_friendly_id()+".getIconImage() called, width:"+I+" height:"+k),Promise.resolve(S(this.icon_,d,typeof I<"u"?I:this.icon_.width,typeof k<"u"?k:this.icon_.height))},v.prototype.setIcon=function(d){this.icon_=d},v.prototype.getBounds=function(){return{x:0,y:0,width:0,height:0}},v.prototype.equivalent=function(d){return this.pid_===d.pid_&&this.hwnd_===d.hwnd_},v}(),e.ScreenSourceVda=f;var a=function(v){function d(I,k,D){return I=v.call(this,I,R.class_id_t.ScreenSource,k,D)||this,I.screenshare_=new l.ScreenShareUtil,I.uniqueid_=d.nextId_++,_.logger.info(I.user_friendly_id()+".constructor"),I}return c(d,v),d.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.uniqueid_+"]"},d.prototype.toJSImageData=function(I){var k=atob(I.data.toString()),k=this.screenshare_.str2ab(k),k=new Uint8ClampedArray(k,0,k.byteLength);this.imagedata_=new ImageData(k,I.width,I.height)},d.prototype.syncBarrier=function(){var I=this;return _.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(k,D){I.syncBarrierDeep(k,D)&&I.waitUntilConnected(I.user_friendly_id()+".syncBarrier").then(function(){Promise.all([I.remoteInvoke(!1,R.method_id_ScreenSource_t.srcid,0),I.remoteInvoke(!1,R.method_id_ScreenSource_t.deviceid,""),I.remoteInvoke(!1,R.method_id_ScreenSource_t.type,0),I.remoteInvoke(!1,R.method_id_ScreenSource_t.name,""),I.remoteInvoke(!1,R.method_id_ScreenSource_t.imagedata),I.remoteInvoke(!1,R.method_id_ScreenSource_t.hwnd,""),I.remoteInvoke(!1,R.method_id_ScreenSource_t.origin,0),I.remoteInvoke(!1,R.method_id_ScreenSource_t.caption,""),I.remoteInvoke(!1,R.method_id_ScreenSource_t.pid,0)]).then(function(F){_.logger.info(I.user_friendly_id()+".syncBarrier(): success.");var H;F=w(F.map(function(L){return I.param0(L)}),9),I.srcid_=F[0],I.deviceid_=F[1],I.type_=F[2],I.name_=F[3],H=F[4],I.hwnd_=F[5],I.origin_=F[6],I.caption_=F[7],I.pid_=F[8],I.toJSImageData(H),t.RemoteSession.isFeatureGTCSupported()?I.remoteInvoke(!1,R.method_id_ScreenSource_t.bounds,0).then(function(L){I.bounds_=I.param0(L),I.syncBarrierResolve(I)}).catch(function(L){I.bounds_=void 0,L=I.logRemoteInvokeError(L,".prop.syncBarrier() getBounds failed."),I.syncBarrierReject(L)}):(_.logger.warning(I.user_friendly_id()+".syncBarrier() don't getBounds for GTC not supported"),I.bounds_=void 0,I.syncBarrierResolve(I))}).catch(function(F){F=I.logRemoteInvokeError(F,".prop.syncBarrier() failed."),I.syncBarrierReject(F)})}).catch(function(F){F=I.logRemoteInvokeError(F,".syncBarrier() failed."),I.syncBarrierReject(F)})})},d.prototype.getId=function(){return this.uniqueid_},d.prototype.getDeviceId=function(){return this.deviceid_},d.prototype.getType=function(){return 1},d.prototype.getPreview=function(I,k,D){return _.logger.debug(this.user_friendly_id()+".getPreview() called, width:"+I+" height:"+k+" asImage:"+D),Promise.reject(null)},d.prototype.getPreviewAsync=function(I,k,D){return _.logger.debug(this.user_friendly_id()+".getPreviewAsync() called, width:"+I+" height:"+k),D===!0?(I=A(this.imagedata_,y.Width,y.Height),Promise.resolve({data:I.src.replace(/^data:image\/(png|jpg);base64,/,"")})):Promise.resolve(this.imagedata_)},d.prototype.getPreviewImage=function(I,k,D){return _.logger.debug(this.user_friendly_id()+".getPreviewImage() called, width:"+k+" height:"+D),Promise.resolve(S(this.imagedata_,I,k,D))},d.prototype.getDescription=function(){return this.name_},d.prototype.getIcon=function(I,k){return Promise.resolve(this.imagedata_)},d.prototype.getBounds=function(){return this.bounds_||{x:0,y:0,width:0,height:0}},d.nextId_=u.MonitorsAndApps,d}(E.ProxyObject);e.ScreenSource=a},691:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.ScreenShareUtil=e.Bitmap=e.BitmapInfoHeader=e.BitmapFileHeader=e.setActiveRespData=e.setActiveReqData=e.getSourcesReqData=e.sshare_state=e.sshare_cmd=void 0;var V=p(946),j=p(973),A=p(851),S;(function(l){l[l.Unknown=0]="Unknown",l[l.Cap=1]="Cap",l[l.GetSources=2]="GetSources",l[l.SetActive=3]="SetActive",l[l.TopologyChanged=4]="TopologyChanged"})(S=e.sshare_cmd||(e.sshare_cmd={}));var c;(function(l){l[l.Unknown=0]="Unknown",l[l.Initialized=1]="Initialized",l[l.Error=2]="Error"})(c=e.sshare_state||(e.sshare_state={})),f=function(){return function(l){this.origin=l}}(),e.getSourcesReqData=f,f=function(){return function(l,t,u,h,g,y,a){this.srcid=l,this.hwnd=t,this.origin=u,this.pid=h,this.border=g,this.cursor=y,this.activate=a}}(),e.setActiveReqData=f;var w=function(){return function(l,t,u){this.srcid=l,this.origin=t,this.bufferid=u}}();e.setActiveRespData=w;var E=function(){function l(t,u,h,g,y){this.id_=t,this.resolve_=u,this.reject_=h,this.cmd_=g,this.data_=y,this.sent_=!1,this.timeoutId=void 0}return l.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.id_+"]"},l.prototype.cmdString=function(){return this.cmd_==S.Cap?"Cap":this.cmd_==S.GetSources?"GetSources":this.cmd_==S.SetActive?"SetActive":"Unknown"},l}(),R=function(){return function(){}}();e.BitmapFileHeader=R;var _=function(){return function(){}}();e.BitmapInfoHeader=_;var m=function(){return function(){}}();e.Bitmap=m,f=function(){function l(){this.cmdque_=[]}return l.prototype.reqid=function(){return l.nextId++},l.prototype.user_friendly_id=function(){return this.constructor.name+"[]"},l.prototype.stateString=function(){return l.state_==c.Initialized?"Initialized":l.state_==c.Error?"Error":"Unknown"},l.prototype.reset=function(){l.state_=c.Unknown,this.cmdque_=[]},l.prototype.dispatchCmds=function(){var t=this;l.state_==c.Initialized?this.cmdque_.forEach(function(u){u.sent_==0&&(u.cmd_==S.GetSources?(t.WSSendGetSources(u.id_,u.data_),u.sent_=!0,u.timeoutId=setTimeout(t.abortCmd.bind(t,u.id_),5e3)):u.cmd_==S.SetActive?(t.WSSendSetActive(u.id_,u.data_),u.sent_=!0,u.timeoutId=setTimeout(t.abortCmd.bind(t,u.id_),5e3)):A.logger.warning(u.user_friendly_id()+".dispatchCmds(): invalid cmd: "+u.cmdString()))}):l.state_==c.Error?(this.cmdque_.forEach(function(u){A.logger.warning(u.user_friendly_id()+".dispatchCmds(): purging cmd: "+u.cmdString()),u.reject_()}),this.cmdque_=[]):A.logger.warning(this.user_friendly_id()+".dispatchCmds(): invalid state: "+this.stateString())},l.prototype.abortCmd=function(t){var u=this.cmdque_.findIndex(function(h){return h.id_===t});u!==-1?(u=this.cmdque_.splice(u,1)[0],A.logger.warning(u.user_friendly_id()+NaN+u.cmdString()+"]: aborted due to nonresponsive WS Agent!"),u.cmd_===S.SetActive&&u.data_.activate&&j.ScreenSharing.screenSharingInstance().stopAppshare(),u.reject_()):A.logger.warning(this.user_friendly_id()+".abortCmd(): Cmd not found!")},l.prototype.finalizeCmd=function(t,u,h){for(var g=0;g<this.cmdque_.length;g++){var y=this.cmdque_[g];if(u!=null&&u==y.id_&&y.sent_==1||u==null&&y.sent_==1){clearTimeout(y.timeoutId),A.logger.info(y.user_friendly_id()+".finalizeCmd(): purging cmd: "+y.cmdString()),t?h!=null?y.resolve_(h):y.resolve_():y.reject_(),this.cmdque_.splice(g,1);break}}},l.prototype.onInitialized=function(t){A.logger.info(this.user_friendly_id()+".onInitialized(): init: "+t+" state:"+this.stateString()),l.state_!=c.Initialized&&(l.state_=t?c.Initialized:c.Error),this.dispatchCmds()},l.prototype.onInitComplete=function(){A.logger.info(this.user_friendly_id()+".onInitComplete(): state:"+this.stateString()),l.state_==c.Unknown&&(l.state_=c.Error,A.logger.info(this.user_friendly_id()+".onInitComplete(): items in queue:"+this.cmdque_.length),this.dispatchCmds())},l.prototype.onError=function(t){A.logger.error(this.user_friendly_id()+".onError(): state: "+this.stateString()),l.state_==c.Unknown?(l.state_=c.Error,this.dispatchCmds()):l.state_==c.Initialized&&this.finalizeCmd(!1,t)},l.prototype.ab2str=function(t){return String.fromCharCode.apply(null,new Uint8Array(t))},l.prototype.str2ab=function(t){for(var u=new ArrayBuffer(t.length),h=new Uint8Array(u),g=0,y=t.length;g<y;g++)h[g]=t.charCodeAt(g);return u},l.prototype.getBMP=function(t){var u=new DataView(t),h=new m;return h.fileheader=new R,h.fileheader.bfType=u.getUint16(0,!0),h.fileheader.bfSize=u.getUint32(2,!0),h.fileheader.bfReserved1=u.getUint16(6,!0),h.fileheader.bfReserved2=u.getUint16(8,!0),h.fileheader.bfOffBits=u.getUint32(10,!0),h.infoheader=new _,h.infoheader.biSize=u.getUint32(14,!0),h.infoheader.biWidth=u.getUint32(18,!0),h.infoheader.biHeight=u.getUint32(22,!0),h.infoheader.biPlanes=u.getUint16(26,!0),h.infoheader.biBitCount=u.getUint16(28,!0),h.infoheader.biCompression=u.getUint32(30,!0),h.infoheader.biSizeImage=u.getUint32(34,!0),h.infoheader.biXPelsPerMeter=u.getUint32(38,!0),h.infoheader.biYPelsPerMeter=u.getUint32(42,!0),h.infoheader.biClrUsed=u.getUint32(46,!0),h.infoheader.biClrImportant=u.getUint32(50,!0),u=h.fileheader.bfOffBits,h.stride=4*Math.floor((h.infoheader.biBitCount*h.infoheader.biWidth+31)/32),h.pixels=new Uint8Array(t,u),h},l.prototype.convertToImageData=function(t){var g=document.createElement("canvas").getContext("2d"),u=t.infoheader.biWidth,h=t.infoheader.biHeight,g=g.createImageData(u,h),y=g.data,a=t.pixels;t=t.stride;for(var v=0;v<h;++v)for(var d=0;d<u;++d){var I=4*(d+u*(h-v)),k=4*d+t*v;y[I]=a[k+2],y[I+1]=a[k+1],y[I+2]=a[k],y[I+3]=255}return g},l.prototype.onGetSources=function(t,u){this.sources_=[];var h=this;u.sources.forEach(function(g){var y=g.image,v=atob(y.data),v=h.str2ab(v),v=new Uint8ClampedArray(v,0,v.byteLength),y=new ImageData(v,y.width,y.height),v=g.icon,a=atob(v.data),a=h.str2ab(a),a=new Uint8ClampedArray(a,0,a.byteLength),v=new ImageData(a,v.width,v.height);g=new j.ScreenSourceVda(g.srcid,g.devicdid,g.type,y,v,g.name,g.hwnd,g.origin,g.caption,g.pid),h.sources_.push(g)}),this.finalizeCmd(!0,t,this.sources_)},l.prototype.getSources=function(t){var u=this;return new Promise(function(h,g){if(l.state_!=c.Error){var y=new E(u.reqid(),h,g,S.GetSources,t);u.cmdque_.push(y)}else g();l.state_==c.Initialized&&u.dispatchCmds()})},l.prototype.onSetActive=function(t,u){var h=new w(u.srcid,u.origin,u.bufferid);this.finalizeCmd(!0,t,h)},l.prototype.setActive=function(t){var u=this;return new Promise(function(h,g){if(l.state_!=c.Error){var y=new E(u.reqid(),h,g,S.SetActive,t);u.cmdque_.push(y)}else g();l.state_==c.Initialized&&u.dispatchCmds()})},l.prototype.setTopologyChangeCB=function(t){this.onwindowtopologychanged_=t},l.prototype.onToplogyChanged=function(){this.onwindowtopologychanged_&&this.onwindowtopologychanged_()},l.prototype.WSSendGetSources=function(t,u){try{V.getRedirector().WSSendObject({v:"appsharing",hdr:{command:S.GetSources,id:t},data:{origin:u.origin}})}catch(h){A.logger.error(h)}},l.prototype.WSSendSetActive=function(t,u){try{V.getRedirector().WSSendObject({v:"appsharing",hdr:{command:S.SetActive,id:t},data:{srcid:u.srcid,hwnd:u.hwnd,origin:u.origin,pid:u.pid,border:u.border,cursor:u.cursor,activate:u.activate}})}catch(h){A.logger.error(h)}},l.state_=c.Unknown,l.nextId=0,l}(),e.ScreenShareUtil=f},517:function(f,e){var p=this&&this.__generator||function(c,w){function E(h){return function(g){return R([h,g])}}function R(h){if(m)throw new TypeError("Generator is already executing.");for(;_;)try{if(m=1,l&&(t=h[0]&2?l.return:h[0]?l.throw||((t=l.return)&&t.call(l),0):l.next)&&!(t=t.call(l,h[1])).done)return t;switch(l=0,t&&(h=[h[0]&2,t.value]),h[0]){case 0:case 1:t=h;break;case 4:return _.label++,{value:h[1],done:!1};case 5:_.label++,l=h[1],h=[0];continue;case 7:h=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=0<t.length&&t[t.length-1])&&(h[0]===6||h[0]===2)){_=0;continue}if(h[0]===3&&(!t||h[1]>t[0]&&h[1]<t[3]))_.label=h[1];else if(h[0]===6&&_.label<t[1])_.label=t[1],t=h;else if(t&&_.label<t[2])_.label=t[2],_.ops.push(h);else{t[2]&&_.ops.pop(),_.trys.pop();continue}}h=w.call(c,_)}catch(g){h=[6,g],l=0}finally{m=t=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},m,l,t,u;return P.initSymbol(),P.initSymbol(),P.initSymbolIterator(),u={next:E(0),throw:E(1),return:E(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u},V=this&&this.__values||function(c){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var w=typeof Symbol=="function"&&Symbol.iterator,E=w&&c[w],R=0;if(E)return E.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&R>=c.length&&(c=void 0),{value:c&&c[R++],done:!c}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")},j=this&&this.__read||function(c,w){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var E=typeof Symbol=="function"&&c[Symbol.iterator];if(!E)return c;var R=E.call(c),_,m=[],l;try{for(;(w===void 0||0<w--)&&!(_=R.next()).done;)m.push(_.value)}catch(t){l={error:t}}finally{try{_&&!_.done&&(E=R.return)&&E.call(R)}finally{if(l)throw l.error}}return m};Object.defineProperty(e,"__esModule",{value:!0}),e.CitrixRTCStatsReport=e.Stats=e.StatsReport=void 0;var A=function(){function c(){this.items=[]}return c.fromJSON=function(w){var E,R,_=new c;try{for(var m=V(w),l=m.next();!l.done;l=m.next()){var t=S.fromJSON(l.value);_.items.push(t)}}catch(u){E={error:u}}finally{try{l&&!l.done&&(R=m.return)&&R.call(m)}finally{if(E)throw E.error}}return _},c.prototype.toJSON=function(){return this.items},c.prototype.result=function(){return this.items},c}();e.StatsReport=A;var S=function(){function c(){this.names_=[],this.stat_=new Map,this.id="",this.timestamp=0,this.type=""}return c.fromJSON=function(w){var E=new c;return E.id=w.id||"",E.timestamp=w.timestamp||"",E.type=w.type||"",Object.keys(w).forEach(function(R){R!=="id"&&R!=="timestamp"&&R!=="type"&&(E.names_.push(R),E.stat_.set(R,w[R]))}),E},c.prototype.toJSON=function(){var w,E,R={id:this.id,timestamp:this.timestamp,type:this.type};try{for(var _=V(this.stat_),m=_.next();!m.done;m=_.next()){var l=j(m.value,2);R[l[0]]=l[1]}}catch(t){w={error:t}}finally{try{m&&!m.done&&(E=_.return)&&E.call(_)}finally{if(w)throw w.error}}return R},c.prototype.names=function(){return this.names_},c.prototype.stat=function(w){return this.stat_.get(w)},c}();e.Stats=S,A=function(){function c(w){var E,R;this.statsMap=new Map;try{for(var _=V(w),m=_.next();!m.done;m=_.next()){var l=m.value;this.statsMap.set(l.id,l)}}catch(t){E={error:t}}finally{try{m&&!m.done&&(R=_.return)&&R.call(_)}finally{if(E)throw E.error}}}return c.prototype.entries=function(){return this.statsMap.entries()},c.prototype.forEach=function(w,E){this.statsMap.forEach(w,E)},Object.defineProperty(c.prototype,"size",{get:function(){return this.statsMap.size},enumerable:!1,configurable:!0}),c.prototype.get=function(w){return this.statsMap.get(w)},c.prototype.has=function(w){return this.statsMap.has(w)},c.prototype.keys=function(){return this.statsMap.keys()},c.prototype.values=function(){return this.statsMap.values()},P.initSymbol(),P.initSymbolIterator(),c.prototype[Symbol.iterator]=function(){return p(this,function(w){switch(w.label){case 0:return[5,V(this.statsMap)];case 1:return w.sent(),[2]}})},c}(),e.CitrixRTCStatsReport=A},704:function(f,e,p){var V=this&&this.__extends||function(){var E=function(R,_){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,l){m.__proto__=l}||function(m,l){for(var t in l)l.hasOwnProperty(t)&&(m[t]=l[t])},E(R,_)};return function(R,_){function m(){this.constructor=R}E(R,_),R.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)}}(),j=this&&this.__read||function(E,R){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var _=typeof Symbol=="function"&&E[Symbol.iterator];if(!_)return E;var m=_.call(E),l,t=[],u;try{for(;(R===void 0||0<R--)&&!(l=m.next()).done;)t.push(l.value)}catch(h){u={error:h}}finally{try{l&&!l.done&&(_=m.return)&&_.call(m)}finally{if(u)throw u.error}}return t},A=this&&this.__values||function(E){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var R=typeof Symbol=="function"&&Symbol.iterator,_=R&&E[R],m=0;if(_)return _.call(E);if(E&&typeof E.length=="number")return{next:function(){return E&&m>=E.length&&(E=void 0),{value:E&&E[m++],done:!E}}};throw new TypeError(R?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.StreamResolution=e.RemoteCallConstraints=void 0;var S=p(550),c=p(658),w=p(851);f=function(){return function(){}}(),e.RemoteCallConstraints=f,f=function(E){function R(){var _=E.call(this,null,S.class_id_t.StreamResolution,0,c.ProxyMode.Local)||this;return _.lastSentConstraints_=null,_}return V(R,E),Object.defineProperty(R.prototype,"onupdate",{get:function(){return this.onupdate_},set:function(_){var m=this;this.onupdate_=_,this.waitUntilConnected(this.user_friendly_id()+".onupdate").then(function(){var l=m.registerCallbacks(!1,m.isNullCallback(m.onupdate_),S.method_id_StreamResolution_t.onupdate);return l.then(function(t){t=j(t.params);var u=t[0];t.slice(1),w.logger.info(m.user_friendly_id()+".onupdate",JSON.stringify(u)),m.lastSentConstraints_&&JSON.stringify(m.lastSentConstraints_)==JSON.stringify(u)?w.logger.debug(m.user_friendly_id()+".onupdate constraints unchanged, ignoring"):m.onupdate_&&(R.isValidRemoteConstraints(u)?(m.lastSentConstraints_=u,m.onupdate_(m.toICallConstraints(m.lastSentConstraints_))):w.logger.warning(m.user_friendly_id()+".onupdate invalid RemoteCallConstraints"))}),m.remoteInvoke(!0,S.method_id_StreamResolution_t.onupdate,l.success)}).catch(function(){return w.logger.error(m.user_friendly_id()+".onupdate, could not set listener")})},enumerable:!1,configurable:!0}),R.prototype.toICallConstraints=function(_){var m,l,t={maxParticipantResolutions:null};if(_.max_participant_resolutions_dynamic){t.maxParticipantResolutions={};try{for(var u=A(_.max_participant_resolutions_dynamic),h=u.next();!h.done;h=u.next()){var g=h.value;t.maxParticipantResolutions[g.count]=g.resolution}}catch(y){m={error:y}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(m)throw m.error}}}else _.max_participant_resolutions_static&&(t.maxParticipantResolutions=_.max_participant_resolutions_static);return t.maxIncomingStreams=_.max_incoming_streams,t.maxOutgoingResolution=_.max_outgoing_resolution,t.maxSimulcastLayers=_.max_simulcast_layers,w.logger.info(this.user_friendly_id()+".toICallConstraints: "+JSON.stringify(t)),t},R.isValidRemoteConstraints=function(_){return _!=null&&(_.max_participant_resolutions_dynamic!=null||_.max_participant_resolutions_static!=null)&&_.max_incoming_streams!=null&&_.max_outgoing_resolution!=null&&_.max_simulcast_layers!=null},R.prototype.getCallConstraints=function(){var _=this;return new Promise(function(m,l){_.waitUntilConnected(_.user_friendly_id()+".getCallConstraints").then(function(){return _.remoteInvoke(!1,S.method_id_StreamResolution_t.getCallConstraints)}).then(function(t){t=_.param0(t),w.logger.info(_.user_friendly_id()+".getCallConstraints",JSON.stringify(t)),R.isValidRemoteConstraints(t)?(_.onupdate_&&(_.lastSentConstraints_=t),m(_.toICallConstraints(t))):(w.logger.warning(_.user_friendly_id()+".getCallConstraints invalid RemoteCallConstraints"),l())}).catch(function(){w.logger.error(_.user_friendly_id()+".getCallConstraints promise rejected"),l()})})},R.getDefaultConstraints=function(){var _={maxParticipantResolutions:{1:720,2:720,3:360,more:360},maxIncomingStreams:4,maxOutgoingResolution:720,maxSimulcastLayers:0};return w.logger.info("StreamResolution.getDefaultConstraints: "+JSON.stringify(_)),_},R.prototype.updateStreamResolution=function(){var _=this;this.getCallConstraints().then(function(m){return _.onupdate&&_.onupdate(m)}).catch(function(){return w.logger.error("Failed to get stream resolution information!")})},R}(c.ProxyObject),e.StreamResolution=f},736:function(f,e,p){var V=this&&this.__extends||function(){var m=function(l,t){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var g in h)h.hasOwnProperty(g)&&(u[g]=h[g])},m(l,t)};return function(l,t){function u(){this.constructor=l}m(l,t),l.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),j=this&&this.__read||function(m,l){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var t=typeof Symbol=="function"&&m[Symbol.iterator];if(!t)return m;var u=t.call(m),h,g=[],y;try{for(;(l===void 0||0<l--)&&!(h=u.next()).done;)g.push(h.value)}catch(a){y={error:a}}finally{try{h&&!h.done&&(t=u.return)&&t.call(u)}finally{if(y)throw y.error}}return g};Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteMediaStreamAudioDestinationNode=e.RemoteMediaStreamAudioSourceNode=e.RemoteAudioNode=e.RemoteAudioContext=void 0;var A=p(658),S=p(550),c=p(851),w=p(144),E=p(550);f=function(m){function l(t,u){u===void 0&&(u=A.ProxyMode.Local);var h=m.call(this,null,S.class_id_t.AudioContext,t,u)||this;return c.logger.info(h.user_friendly_id()+": ctor"),h}return V(l,m),l.prototype.close=function(){var t=this;return c.logger.info(this.user_friendly_id()+".close() called."),new Promise(function(u,h){t.waitUntilConnected("RemoteAudioContext.close").then(function(){return t.remoteInvoke(!1,E.method_id_AudioContext_t.close)}).then(function(){c.logger.info(t.user_friendly_id()+".close() successful."),u(),t.release()}).catch(function(g){t.logRemoteInvokeError(g,".close() failed!"),h(),t.release()})})},l.prototype.createMediaStreamSource=function(t){var u=this,h=new R(this,A.ProxyMode.Pseudo,{mediaStream:t});return Promise.all([this.waitUntilConnected("RemoteAudioContext.createMediaStreamSource"),t.waitUntilConnected("RemoteAudioContext.createMediaStreamSource.RemoteStream")]).then(function(){return c.logger.info(u.user_friendly_id()+".createMediaStreamSource id="+t.id+" oid="+t.object_id()+" numberOfTracks="+t.getAudioTracks().length),u.remoteInvoke(!1,E.method_id_AudioContext_t.createMediaStreamSource,{oid:t.object_id()})}).then(function(g){return h.bind(u,u.param0(g).oid),h.syncBarrier()}).then(function(g){c.logger.info(u.user_friendly_id()+".createMediaStreamSource MediaStreamAudioSourceNode successfully created.")}).catch(function(g){u.logRemoteInvokeError(g,".createMediaStreamSource failed!")}),h},l.prototype.createMediaStreamDestination=function(){var t=this,u={streamId:w.RemoteStream.generateIdWithPrefix("AC-"),audioTrackId:w.RemoteStream.generateIdWithPrefix("AC-")},h=w.RemoteMediaTrack.createPseudo(this,u.audioTrackId,"audio",u.audioTrackId),h=w.RemoteStream.createPseudo(this,u.streamId,[h]),g=new _(this,A.ProxyMode.Pseudo,h);return this.waitUntilConnected("RemoteAudioContext.createMediaStreamDestination").then(function(){return t.remoteInvoke(!1,E.method_id_AudioContext_t.createMediaStreamDestination,u)}).then(function(y){return g.bind(t,t.param0(y).oid),g.syncBarrier()}).then(function(y){c.logger.info(t.user_friendly_id()+".createMediaStreamDestination MediaStreamAudioDestinationNode successfully created.")}).catch(function(y){t.logRemoteInvokeError(y,"createMediaStreamDestination failed!")}),g},l.prototype.syncBarrier=function(){var t=this;return c.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(u,h){t.waitUntilConnected("RemoteAudioContext.syncBarrier").then(function(){return Promise.all([t.remoteInvoke(!1,E.method_id_AudioContext_t.sampleRate)])}).then(function(g){c.logger.info(t.user_friendly_id()+".syncBarrier() remote success"),g=j(g.map(function(y){return t.param0(y)}),1),t.sampleRate=g[0],u(t)}).catch(function(g){t.logRemoteInvokeError(g,".syncBarrier failed!"),h()})})},l}(A.ProxyObject),e.RemoteAudioContext=f,f=function(m){function l(t,u,h,g,y,a,v,d){for(t=m.call(this,t,u,h,g,null,[y],d)||this,c.logger.info(t.user_friendly_id()+".constructor base"),t.channelCount=2,t.channelCountMode="explicit",t.channelInterpretation="speakers",t._numberOfInputs=a,t._numberOfOutputs=v,t.outputs_=Array(v),a=0;a<v;a++)t.outputs_[a]=new Map;return t.inputs_=new Map,t}return V(l,m),Object.defineProperty(l.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"numberOfInputs",{get:function(){return this._numberOfInputs},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"numberOfOutputs",{get:function(){return this._numberOfOutputs},enumerable:!1,configurable:!0}),l.prototype.addEventListener=function(t,u,h){c.logger.debug(this.user_friendly_id()+".addEventListener: unimplemented!")},l.prototype.dispatchEvent=function(t){return c.logger.debug(this.user_friendly_id()+".dispatchEvent: unimplemented!"),!1},l.prototype.removeEventListener=function(t,u,h){c.logger.debug(this.user_friendly_id()+".removeEventListener: unimplemented!")},l.prototype.connectionExists=function(t,u,h){return!!(this.outputs_[t].has(u)&&0<=this.outputs_[t].get(u).indexOf(h))},l.prototype.findFreeInput=function(){for(var t=0;t<this._numberOfInputs;++t)if(!this.inputs_.has(t))return t;return-1},l.prototype.connectToInput=function(t,u){return 0>t||!u||this.inputs_.has(t)?!1:(this.inputs_.set(t,u),!0)},l.prototype.disconnectFromInput=function(t){return 0>t?!1:(this.inputs_.delete(t),!0)},l.prototype.disconnectNodeFromInputs=function(t){var u=this;Array.from(this.inputs_.keys()).forEach(function(h){u.inputs_[h]===t&&u.disconnectFromInput(h)})},l.prototype.connectOutput=function(t,u,h){return 0>u||0>t||!h||t>=this.numberOfOutputs?!1:(t=this.outputs_[t],t.has(h)||t.set(h,[]),t.get(h).push(u),!0)},l.prototype.connect=function(t,u,h){var g=this;if(c.logger.info(this.user_friendly_id()+".connect input="+(h||"undefined")+" output="+(u||"undefined")),!(t instanceof l))throw c.logger.error(this.user_friendly_id()+".connect: Connecting to AudioParam unsupported!"),new DOMException("AudioNode connecting to AudioParam is currently NOT supported!","NotSupportedError");var y=u??0;if(0>y||y>=this.numberOfOutputs)throw new RangeError("output parameter out of range!");if(t.context!==this.context)throw new TypeError("The destination node has been created in a different context!");var a=h??t.findFreeInput();if(0>a||a>=t.numberOfInputs)throw new RangeError("input of the destination node out of range!");return this.connectionExists(y,t,a)?(c.logger.info(this.user_friendly_id()+".connect. The specified AudioNode and input combination is already connected to the output specified."),t):(this.connectOutput(y,a,t),t.connectToInput(a,this),Promise.all([this.waitUntilConnected(this.user_friendly_id()+".connect"),t.waitUntilConnected(this.user_friendly_id()+".connect")]).then(function(){return c.logger.info(g.user_friendly_id()+".connect node="+g.object_id()+" output="+y+" destinationNode="+t.object_id()+" input="+a),g.remoteInvokeWithInterfaceId(S.class_id_t.AudioNode,!1,S.method_id_AudioNode_t.connect,{oid:t.object_id()},y,a)}).then(function(){c.logger.info(g.user_friendly_id()+".connect successful.")}).catch(function(v){g.logRemoteInvokeError(v,".connect failed!")}),c.logger.info(this.user_friendly_id()+".connect() returned"),t)},l.prototype.disconnect=function(t,u,h){c.logger.info(this.user_friendly_id()+".disconnect() called"),t===void 0||t instanceof l?t===void 0&&u===void 0&&h===void 0?this.disconnectAll():t===void 0&&h===void 0&&typeof u=="number"?this.disconnectOutput(u):u===void 0&&h===void 0&&t instanceof l?this.disconnectDestinationNode(t):h===void 0&&t instanceof l&&typeof u=="number"?this.disconnectOutputDestinationNode(t,u):t instanceof l&&typeof u=="number"&&typeof h=="number"?this.disconnectSpecific(t,u,h):c.logger.error(this.user_friendly_id()+".disconnect error: incorrect call signature!"):c.logger.info(this.user_friendly_id()+".disconnect: Connecting to AudioParam unsupported!")},l.prototype.disconnectAll=function(){for(var t=this,u=0;u<this.numberOfOutputs;u++)this.outputs_[u].forEach(function(h,g){return g.disconnectNodeFromInputs(t)}),this.outputs_[u]=new Map;this.waitUntilConnected(this.user_friendly_id()+".disconnectAll").then(function(){return t.remoteInvokeWithInterfaceId(S.class_id_t.AudioNode,!1,S.method_id_AudioNode_t.disconnectAll)}).then(function(){c.logger.info(t.user_friendly_id()+".disconnectAll success.")}).catch(function(h){t.logRemoteInvokeError(h,".disconnectAll failed!")})},l.prototype.disconnectOutput=function(t){var u=this;if(0>t||t>=this.numberOfOutputs)throw new RangeError("output parameter out of range!");this.outputs_[t].forEach(function(h,g){return g.disconnectNodeFromInputs(u)}),this.outputs_[t]=new Map,this.waitUntilConnected(this.user_friendly_id()+".disconnectOutput").then(function(){return u.remoteInvokeWithInterfaceId(S.class_id_t.AudioNode,!1,S.method_id_AudioNode_t.disconnectOutput,t)}).then(function(){c.logger.info(u.user_friendly_id()+".disconnectOutput success.")}).catch(function(h){u.logRemoteInvokeError(h,".disconnectOutput failed!")})},l.prototype.disconnectDestinationNode=function(t){for(var u=this,h=0,g=0;g<this.numberOfOutputs;g++){var y=this.outputs_[g];y.has(t)&&(h+=y.get(t).length,y.delete(t),t.disconnectNodeFromInputs(this))}if(h===0)throw new TypeError("No connection to this AudioNode!");this.waitUntilConnected(this.user_friendly_id()+".disconnectDestinationNode").then(function(){return u.remoteInvokeWithInterfaceId(S.class_id_t.AudioNode,!1,S.method_id_AudioNode_t.disconnectDestinationNode,{oid:t.object_id()})}).then(function(){c.logger.info(u.user_friendly_id()+".disconnectDestinationNode success.")}).catch(function(a){u.logRemoteInvokeError(a,".disconnectDestinationNode failed!")})},l.prototype.disconnectOutputDestinationNode=function(t,u){var h=this;if(0>u||u>=this.numberOfOutputs)throw new RangeError("output parameter out of range!");var g=this.outputs_[u].get(t);if(g===void 0||g.length===0)throw new TypeError("No connection to this AudioNode on this given output!");this.outputs_[u].delete(t),t.disconnectNodeFromInputs(this),this.waitUntilConnected(this.user_friendly_id()+".disconectOutputDestinationNode").then(function(){return h.remoteInvokeWithInterfaceId(S.class_id_t.AudioNode,!1,S.method_id_AudioNode_t.disconnectOutputDestinationNode,{oid:t.object_id()},u)}).then(function(){c.logger.info(h.user_friendly_id()+".disconnectOutputDestinationNode success.")}).catch(function(y){h.logRemoteInvokeError(y,".disconnectOutputDestinationNode failed!")})},l.prototype.disconnectSpecific=function(t,u,h){var g=this;if(0>u||u>=this.numberOfOutputs)throw new RangeError("output parameter out of range!");if(0>h||h>=t.numberOfInputs)throw new RangeError("input of the destination node out of range!");if(this.connectionExists(u,t,h)){var y=this.outputs_[u].get(t).indexOf(h);this.outputs_[u].get(t).splice(y,1),t.disconnectFromInput(h),this.waitUntilConnected(this.user_friendly_id()+".disconnect").then(function(){return g.remoteInvokeWithInterfaceId(S.class_id_t.AudioNode,!1,S.method_id_AudioNode_t.disconnect,{oid:t.object_id()},u,h)}).then(function(){c.logger.info(g.user_friendly_id()+".disconnect success.")}).catch(function(a){g.logRemoteInvokeError(a,".disconnect failed!")})}else throw new TypeError("No connection to this AudioNode from the given input on this given output!")},l}(A.ProxyObject),e.RemoteAudioNode=f;var R=function(m){function l(t,u,h){var g=this,y=h.mediaStream.getAudioTracks();if(1>y.length)throw Error("InvalidStateError");return y.sort(function(a,v){return a.id<v.id?-1:a.id>v.id?1:0}),y[0].getChannelCount(),g=m.call(this,t,S.class_id_t.MediaStreamAudioSourceNode,0,u,t,0,1,h)||this,g._context=t,g.inputTrack=y[0],g.mediaStream=h.mediaStream,g}return V(l,m),l.prototype.syncBarrier=function(){var t=this,u=this;return new Promise(function(h,g){u.waitUntilConnected("MediaStreamAudioSourceNode.syncBarrier").then(function(){return t.remoteInvokeWithInterfaceId(S.class_id_t.AudioNode,!1,S.method_id_AudioNode_t.channelCount)}).then(function(y){u.channelCount=u.param0(y),h(u)}).catch(function(y){y=u.logRemoteInvokeError(y,"syncBarrier failed!"),g(y)})})},l}(f);e.RemoteMediaStreamAudioSourceNode=R;var _=function(m){function l(t,u,h,g){g===void 0&&(g={});var y=this,a=2,v="explicit",d="speakers";return g.channelCount!==void 0&&(a=g.channelCount),g.channelCountMode!==void 0&&(v=g.channelCountMode),g.channelInterpretation!==void 0&&(d=g.channelInterpretation),y=m.call(this,t,S.class_id_t.MediaStreamAudioDestinationNode,0,u,t,16,0,{channelCount:a,channelCountMode:v,channelInterpretation:d})||this,y._context=t,y.channelCount=a,y.channelCountMode=v,y.channelInterpretation=d,y.stream=h,y}return V(l,m),l.prototype.syncBarrier=function(){var t=this,u=t.stream;return c.logger.info(this.user_friendly_id(),".syncBarrier "),new Promise(function(h,g){t.waitUntilConnected(t.user_friendly_id()+".syncBarrier.").then(function(){return t.remoteInvoke(!1,E.method_id_MediaStreamAudioDestinationNode_t.stream)}).then(function(y){return u.isPseudo()&&(y=t.param0(y).oid,c.logger.info(`
                            `+t.user_friendly_id()+` remote created MediaStream and associated MediaStreamTrack 
                            for this MediaStreamAudioDestinationNode, stream oid: `+y),u.bind(t,y)),u.syncBarrier()}).then(function(y){y=y.getTracks(),y.length!==1?(c.logger.error(t.user_friendly_id()+" incorrect number of tracks: "+y.length),g()):(y=y[0],y.kind!=="audio"?(c.logger.error(t.user_friendly_id()+" incorrect kind of track: "+y.kind),g()):(y=y.getChannelCount(),y!==t.channelCount?(c.logger.error(t.user_friendly_id()+" incorrect channelCount of track: "+y),g()):h(t)))}).catch(function(y){y=t.logRemoteInvokeError(y,"createStreamAndTrack failed!"),g(y)})})},l}(f);e.RemoteMediaStreamAudioDestinationNode=_},394:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.Telemetry=e.tel_key_CPUTotalmemory=e.tel_key_CPUGpuinfo=e.tel_key_CPUMachineid=e.tel_key_CPUProcessors=e.tel_key_CPUCores=e.tel_key_CPUModel=e.tel_key_CPUSpeed=e.tel_key_OSEdition=e.tel_key_OSDistro=e.tel_key_OSArchitecture=e.tel_key_OSVersion=e.tel_key_OSFamily=e.tel_key_VerHdxRtcEngine=e.tel_key_VerTypeScript=e.tel_key_VerEndpoint=e.tel_key_VerVda=e.tel_key_VerReceiver=e.tel_key_VerWebrtcCodecs=e.tel_key_VerWebrpc=e.tel_key_PerfCallType=e.tel_key_PerfCallState=e.tel_key_PerfCallDirection=e.tel_key_SpeakerDeviceUsed=e.tel_key_VideoDeviceUsed=e.tel_key_AudioDeviceUsed=e.tel_key_CallEstOutgoing=e.tel_key_CallEstIncoming=e.tel_key_ScreensharingCallDuration=e.tel_key_VideoCallDuration=e.tel_key_AudioCallDuration=e.tel_key_ConferenceCallDuration=e.tel_cmd=e.tel_CallType=e.tel_CallDirection=e.tel_CallState=void 0;var V=p(946),j=p(851);(function(c){c[c.unknown=0]="unknown",c[c.active=1]="active",c[c.idle=2]="idle"})(e.tel_CallState||(e.tel_CallState={})),function(c){c[c.unknown=0]="unknown",c[c.incoming=1]="incoming",c[c.outgoing=2]="outgoing"}(e.tel_CallDirection||(e.tel_CallDirection={})),function(c){c[c.unknown=0]="unknown",c[c.audio=1]="audio",c[c.video=2]="video",c[c.multi=3]="multi",c[c.dshare=4]="dshare"}(e.tel_CallType||(e.tel_CallType={}));var A;(function(c){c[c.Unknown=0]="Unknown",c[c.Cap=1]="Cap",c[c.Init=2]="Init",c[c.Data=3]="Data"})(A=e.tel_cmd||(e.tel_cmd={})),e.tel_key_ConferenceCallDuration="ConferenceCallDuration",e.tel_key_AudioCallDuration="AudioCallDuration",e.tel_key_VideoCallDuration="VideoCallDuration",e.tel_key_ScreensharingCallDuration="ScreensharingCallDuration",e.tel_key_CallEstIncoming="CallEstIncoming",e.tel_key_CallEstOutgoing="CallEstOutgoing",e.tel_key_AudioDeviceUsed="AudioDeviceUsed",e.tel_key_VideoDeviceUsed="VideoDeviceUsed",e.tel_key_SpeakerDeviceUsed="SpeakerDeviceUsed",e.tel_key_PerfCallDirection="PerfCallDirection",e.tel_key_PerfCallState="PerfCallState",e.tel_key_PerfCallType="PerfCallType",e.tel_key_VerWebrpc="VerWebrpc",e.tel_key_VerWebrtcCodecs="VerWebrtcCodecs",e.tel_key_VerReceiver="VerReceiver",e.tel_key_VerVda="VerVda",e.tel_key_VerEndpoint="VerEndpoint",e.tel_key_VerTypeScript="VerTypeScript",e.tel_key_VerHdxRtcEngine="VerHdxRtcEngine",e.tel_key_OSFamily="OSFamily",e.tel_key_OSVersion="OSVersion",e.tel_key_OSArchitecture="OSArchitecture",e.tel_key_OSDistro="OSDistro",e.tel_key_OSEdition="OSEdition",e.tel_key_CPUSpeed="CPUSpeed",e.tel_key_CPUModel="CPUModel",e.tel_key_CPUCores="CPUCores",e.tel_key_CPUProcessors="CPUProcessors",e.tel_key_CPUMachineid="CPUMachineid",e.tel_key_CPUGpuinfo="CPUGpuinfo",e.tel_key_CPUTotalmemory="CPUTotalmemory";var S=function(){function c(w,E,R,_){this.cmd=w,this.key=E,this.value=R,this.flags=_}return c.prototype.SendTelemetryData=function(w){w.SendTelemetryData(this.cmd,this.key,this.value,this.flags)},c}();f=function(){function c(){this.id=0,this.deferredData=[]}return c.prototype.reset=function(){this.id=0,this.deferredData=[]},c.prototype.onInitialized=function(w){for(this.id=w;this.deferredData&&0<this.deferredData.length;)this.deferredData.shift().SendTelemetryData(this)},c.prototype.SendTelemetryInit=function(){0<this.id&&this.reset();try{V.getRedirector().WSSendObject({v:"telemetry",hdr:{command:A.Init,id:0},init:{domain:"HDXMM Teams",subdomain:"Teams",feature:"msteams",version:"1.1.1.1"}})}catch(w){j.logger.error(w)}},c.prototype.SendTelemetryData=function(w,E,R,_){if(w!=A.Data)j.logger.warning("invalid telemetry command!");else if(this.id==0)this.deferredData.push(new S(w,E,R,_));else try{V.getRedirector().WSSendObject({v:"telemetry",hdr:{command:w,id:this.id},data:{key:E,value:R,flags:_}})}catch(m){j.logger.error(m)}},c}(),e.Telemetry=f},259:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;var V=p(851);f=function(){function j(){}return j.stringifyArray=function(A){for(var S="[",c=0;c<A.length;++c)c!=0&&(S+=","),S+=this.stringify(A[c]);return S+"]"},j.stringifyObject=function(A){var S="{",c=!0,w;for(w in A)c?c=!1:S+=",",S=S+'"'+w+'":',S=A[w]instanceof Array?S+this.stringifyArray(A[w]):typeof A[w]=="object"?S+this.stringifyObject(A[w]):S+JSON.stringify(A[w]);return S+"}"},j.stringify=function(A){return typeof A=="object"?Object.prototype.toString.call(A)=="[object Array]"?this.stringifyArray(A):this.stringifyObject(A):JSON.stringify(A)},j.GetObjectPropertyDescriptor=function(A,S){for(var c=void 0;A!=Object.prototype&&(c=Object.getOwnPropertyDescriptor(A,S),c===void 0);)A=A.__proto__;return c},j.sendEvent=function(A,S){try{var c=document.createEvent("Event");c.initEvent(S,!0,!0),A.dispatchEvent(c)}catch(w){V.logger.error('sendEvent(): exception dispatching "'+S+'" event: '+w.message)}},j.hasValue=function(A){var S=!1;return A!=null&&(S=!0),S},j.toByteArray=function(A){var S=[];A=new Uint8Array(A instanceof ArrayBuffer?A:A.buffer);for(var c in A)S.push(A[c]);return S},j.toDataView=function(A){return new DataView(A)},j}(),e.Util=f},307:function(f,e,p){var V=this&&this.__awaiter||function(k,D,F,H){function L(z){return z instanceof F?z:new F(function(U){U(z)})}return new(F||(F=Promise))(function(z,U){function C(r){try{s(H.next(r))}catch(o){U(o)}}function i(r){try{s(H.throw(r))}catch(o){U(o)}}function s(r){r.done?z(r.value):L(r.value).then(C,i)}s((H=H.apply(k,D||[])).next())})},j=this&&this.__generator||function(k,D){function F(s){return function(r){return H([s,r])}}function H(s){if(z)throw new TypeError("Generator is already executing.");for(;L;)try{if(z=1,U&&(C=s[0]&2?U.return:s[0]?U.throw||((C=U.return)&&C.call(U),0):U.next)&&!(C=C.call(U,s[1])).done)return C;switch(U=0,C&&(s=[s[0]&2,C.value]),s[0]){case 0:case 1:C=s;break;case 4:return L.label++,{value:s[1],done:!1};case 5:L.label++,U=s[1],s=[0];continue;case 7:s=L.ops.pop(),L.trys.pop();continue;default:if(C=L.trys,!(C=0<C.length&&C[C.length-1])&&(s[0]===6||s[0]===2)){L=0;continue}if(s[0]===3&&(!C||s[1]>C[0]&&s[1]<C[3]))L.label=s[1];else if(s[0]===6&&L.label<C[1])L.label=C[1],C=s;else if(C&&L.label<C[2])L.label=C[2],L.ops.push(s);else{C[2]&&L.ops.pop(),L.trys.pop();continue}}s=D.call(k,L)}catch(r){s=[6,r],U=0}finally{z=C=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}var L={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},z,U,C,i;return P.initSymbol(),P.initSymbol(),P.initSymbolIterator(),i={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i},A=this&&this.__values||function(k){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var D=typeof Symbol=="function"&&Symbol.iterator,F=D&&k[D],H=0;if(F)return F.call(k);if(k&&typeof k.length=="number")return{next:function(){return k&&H>=k.length&&(k=void 0),{value:k&&k[H++],done:!k}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")},S=p(360),c=p(144);p(679);var w=p(945),E=p(368),R=p(851).logger,_=p(650),m=p(973),l=p(247).getGC,t=p(946),u=p(613).E911Service;f=p(550);var h=f.Features,g=f.FEATURE_vda_delete_viewport,y=p(704).StreamResolution,a=p(239).E;f=p(919);var v=f.getHIDInterface,d=f.destroyHIDInterface,I=p(736).RemoteAudioContext;(function(k,D){k.CitrixWebRTC=D()})(typeof self<"u"?self:this,function(){function k(B,q){R.info("VDI Shim createMediaStreamInternal"),U();var X=new c.RemoteStream(null,0,0,B),$=new Promise(function(de,ue){X.syncBarrier().then(function(le){R.info("stream.syncBarrier(): success."),de(le)}).catch(function(le){R.error("stream.syncBarrier(): failed with error: "+JSON.stringify(le)),X.release(),ue()})});return q?$:X}function D(B){te==null&&(te=new E.Frames(!se.isFeatureSupported(h.FEATURE_public_multi_window))),B(te)}function F(B,q){D(function(X){var $=X.findFrame(B);$==null&&($=X.newFrame(B)),q($)})}function H(B,q){D(function(X){X=X.findFrame(B),X!=null&&q(X)})}function L(B){t.getRedirector().SendTelemetryData_Speaker(B)}function z(B,q){if(R.info("VDI Shim fireVMEvent eventName: "+B+", data: "+JSON.stringify(q)),ie)try{B==="vdiE911InfoChanged"?B="vdiE911DataChanged":B==="vdiCallConstraintsChanged"&&(B="vdiStreamConstraintsChanged");var X=Object.assign({event:B},q);R.info("Dispatching VM event:"+JSON.stringify(X)),ie(X)}catch($){R.error("Exception onVMEvent(), eventName:"+B+" message:"+$.message)}}function U(){var B=window.getCitrixWebrtcRedir;B!==void 0?B().then(function(q){R.info("sucesss on connect, getCitrixWebrtcRedir reg value:"+q),q!=="1"||se||(R.info("supported client"),i(ne))}).catch(function(){R.error("Failure to Read Webrtc redir Reg Key"),b()}):(R.warning("window.getCitrixWebrtcRedir() method is not available yet"),b())}function C(B){if(R.info("VDI Event: vdiClientDisconnected"),x(),B===!0&&ae===!1){R.info("VDI Event: vdiClientDisconnected with failure reported"),ae=!0;try{ie({event:"vdiClientDisconnected",reason:"failure",msg:"Websocket Connection Failure"})}catch(q){R.error("onVMEvent(): exception: "+q.message)}}else{ae=!1;try{ie({event:"vdiClientDisconnected",reason:"endpointDisconnected"})}catch(q){R.error("onVMEvent(): exception: "+q.message)}}R.cleanup()}function i(B){R.info("initRemoteSession with vendor:"+B),se||(se=new _.RemoteSession("CitrixWebRTCSDK",B))}function s(){R.info("VDI Event: onVdiClientDisconnectedTimer"),i(ne)}function r(){var B=this;R.info("VDI Shim onVdiClientConnected..."),se?(se.getSessionInfo().then(function(q){return V(B,void 0,void 0,function(){return j(this,function(X){switch(X.label){case 0:return R.info("VDI Shim onVdiClientConnected, client endpoint info:"+JSON.stringify(q)),Y&&Y.isValid()||(Y=new c.RemoteDevices),K&&K.isValid()||(K=new c.NavigatorUserMedia),D(function($){$.reconnect()}),z("vdiClientConnected",{version:q,endpointId:q.endpointId}),[4,K.getCapabilities().then(function($){R.info("VDI Shim onVdiClientConnected, caps = "+JSON.stringify($))}).catch(function(){R.error("VDI Shim onVdiClientConnected, could not get capabilities")})];case 1:return X.sent(),oe||(oe=new u,oe.onupdate=function($){z("vdiE911InfoChanged",$)},oe.updateE911Info()),ce||(z("vdiCallConstraintsChanged",y.getDefaultConstraints()),se!==null&&_.RemoteSession.isFeatureCallConstraintsSupported()&&(ce=new y,ce.onupdate=function($){z("vdiCallConstraintsChanged",$)},ce.updateStreamResolution())),[2]}})})}).catch(function(){R.error("VDI Shim onVdiClientConnected, getSessionInfo failure! Session is not fully connected yet...")}),navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))):R.warning("VDI Shim onVdiClientConnected, remoteSession does not exist")}function o(B){if(B==="1")R.info("Supported client"),t.getRedirector().pingConnectionBegin(!0);else if(B==="0"){R.info("VDI Event: Unsupported client reported");try{ie({event:"vdiClientDisconnected",reason:"endpointUnsupported",msg:"Unsupported endpoint connected"})}catch(q){R.error("onVMEvent(): exception: "+q.message)}}else R.warning("Citrix Webrtc Redir Reg Key value is incorrect")}function b(){Z===!1&&(R.info("starting MS Reg retry..."),Z=!0,T(10))}function T(B){if(0>=B){Z=!1,R.info("VDI Event: Reg Key not Updated after timer reported, Fallback");try{ie({event:"vdiClientDisconnected",reason:"failure",msg:"Citrix Webrtc Redir Reg Key not Present"})}catch(X){R.error("onVMEvent(): exception: "+X.message)}}else{var q=window.getCitrixWebrtcRedir;q!==void 0?q().then(function(X){R.info("CitrixMSTeamsRedir reg value:"+X),X==="0"||X==="1"?(o(X),Z=!1):(R.info("MS Teams Redir Reg key not updated - Start timer"),setTimeout(function(){R.info("Timer waiting for registry to be updated count :"+B),T(--B)},1e3))}).catch(function(){R.error("Failure to Read MS Teams redir Reg Key - Start timer"),setTimeout(function(){R.info("Timer waiting for registry to be updated count :"+B),T(--B)},1e3)}):(R.info("window.getCitrixWebrtcRedir() method is not available yet"),setTimeout(function(){R.info("Timer waiting for registry to be updated count :"+B),T(--B)},1e3))}}function O(B){return n("isFeatureOn"),se?se.isFeatureSupported(B):!1}function x(){R.info("VDI : cleanup"),t.getRedirector().clearReqs(),c.NavigatorUserMedia.resetCapabilities(),Y=K=null,d(),te=null,ee&&ee.release(),se&&se.release(),se=null,m.ScreenSharing.destroyInstance(),oe&&(oe.release(),oe=null),ce&&(ce.release(),ce=null),l().reset(),R.info("VDI : cleanup done")}function N(){return m.ScreenSharing.screenSharingInstance(function(){if(ie)try{ie({event:"vdiScreenTopologyChanged"})}catch(B){R.error("onVMEvent('vdiScreenTopologyChanged'): exception: "+B.message)}})}function n(B){if(!re)throw R.info("VDI Shim "+B+": throwing exception: not initialized!!"),new DOMException("UCSDK is not initialized!!!")}R.setInstanceId("UCSDK");var G=S.PeerConnection,K=null,Q=c.NavigatorUserMedia.getCapabilities,Y=null,te=null,ee=null,ie=null;window.addEventListener("unload",function(B){R.cleanup()});var oe=null,ce=null,ae=!1,se=void 0,Z=!1,re=!1,ne=void 0;return{Features:h,CitrixPeerConnection:G,getUserMedia:function(B,q,X){n("getUserMedia"),U(),R.info("VDI Shim getUserMedia"),K!==null&&K.isValid()||(K=new c.NavigatorUserMedia);var $=c.RemoteMediaStreamConstraints.isConstraintsAudioDeviceIdEmpty(B),de=c.RemoteMediaStreamConstraints.isConstraintsVideoSourceIdEmpty(B);return $||de?new Promise(function(ue,le){Y.enumerateDevices().then(function(pe){return K.webkitGetUserMedia(B,q,X)}).then(function(pe){R.info("webkitGetUserMedia for default was resolved"),ue(pe)}).catch(function(pe){R.info("getUserMedia() for default failed with error:"+JSON.stringify(pe)),le()})}):K.webkitGetUserMedia(B,q,X)},getDisplayMedia:function(B){return n("getDisplayMedia"),U(),R.info("VDI Shim getDisplayMedia"),Y!==null&&Y.isValid()||(Y=new c.RemoteDevices),Y.getDisplayMedia(B)},enumerateDevices:function(){return n("enumerateDevices"),U(),R.info("VDI Shim enumerateDevices"),Y!==null&&Y.isValid()||(Y=new c.RemoteDevices),Y.enumerateDevices()},onWindowClose:function(B,q,X){n("onWindowClose"),R.info("VDI Shim onWindowClose: (handle: "+B+")"),t.getRedirector().getVDAFeatureValue(g)&&D(function($){$.disposeFrame(B)})},setClientAreaOffset:function(B,q,X){n("setClientAreaOffset"),R.info("VDI setClientAreaOffset with xOffset = "+B+", yOffset = "+q+", windowHandle = "+X),U(),F(X,function($){$.setClientAreaOffset(B,q)})},mapVideoElement:function(B,q){n("mapVideoElement"),R.info("VDI New Video Element Created, Creating Mapping to Thin Client DOM"),U(),F(q,function(X){X.newVideoElement(B)})},mapAudioElement:function(B){if(n("mapAudioElement"),R.info("VDI New Audio Element Created, Creating Mapping to VDA"),B.remoteAudioElement!==void 0)R.info("Audio element is already configured!");else{U(),delete B.remoteAudioElement,Object.defineProperty(B,"remoteAudioElement",{writable:!0,configurable:!0,value:null}),B.remoteAudioElement=new w.AudioElement,delete B.sinkId,Object.defineProperty(B,"sinkId",{configurable:!0,get:function(){return B.remoteAudioElement?B.remoteAudioElement.sinkId:void 0},set:function($){R.info("VDI Shim set audio element SinkId value = "+$),B.setSinkId($).then(function(){R.info("VDI Shim set audio element SinkId success")}).catch(function(){R.error("VDI Shim set audio element SinkId failure")})}});var q=B.remoteAudioElement.play;B.play=function(){return R.info("VDI Shim remote audio play"),q.apply(B.remoteAudioElement,arguments)};var X=B.remoteAudioElement.pause;B.pause=function(){return R.info("VDI Shim remote audio pause"),X.apply(B.remoteAudioElement,arguments)},B.setSinkId=function($){R.info("VDI Shim set audio element SinkId value = "+$);var de=B.remoteAudioElement.setSinkId($),ue;return c.enumeratedDevices.forEach(function(le){$===le.deviceId&&(ue=le.label)}),L(ue),de},delete B.srcObject,Object.defineProperty(B,"srcObject",{configurable:!0,get:function(){return B.remoteAudioElement?B.remoteAudioElement.srcObject:void 0},set:function($){R.info("VDI Shim set audio element srcObject "+JSON.stringify($)),B.remoteAudioElement.srcObject=$}})}},disposeVideoElement:function(B,q){n("disposeVideoElement"),R.info("VDI Shim disposeVideoElement: "),H(q,function(X){X.disposeVideoElement(B)})},disposeAudioElement:function(B,q,X){n("disposeAudioElement"),R.info("VDI Shim disposeAudioElement: "),B&&(q=B.remoteAudioElement)&&(q.dispose(),B.remoteAudioElement=void 0)},setVMEventCallback:function(B){var q=this;ie=B,t.getRedirector().isConnected()&&se.getSessionInfo().then(function(X){return V(q,void 0,void 0,function(){return j(this,function($){return R.info("VDI Shim onVdiClientConnected, client endpoint info:"+JSON.stringify(X)),z("vdiClientConnected",{version:X,endpointId:X.endpointId}),[2]})})}),R.info("VDI Event Callback Set")},playNotifyAudio:function(B,q){n("playNotifyAudio"),R.info("VDI Shim Audio playNotifyAudio audioId:"+B+" src:"+q),ee&&ee.playNotifyAudio(B,q)},stopNotifyAudio:function(B,q){n("stopNotifyAudio"),R.info("VDI Shim Audio pauseNotifyAudio audioId:"+B+" src:"+q),ee&&ee.pauseNotifyAudio(B,q)},setSinkId:function(B,q){n("setSinkId"),R.info("VDI Shim Audio setSinkId audioId:"+B+" sinkId:"+q),ee&&ee.setSinkId(B,q)},getLoop:function(B){n("getLoop");var q;return ee&&(q=ee.getLoop(B)),R.info("VDI Shim Audio getLoop audioId:"+B+" loop: "+q),q},setLoop:function(B,q){n("setLoop"),R.info("VDI Shim Audio setLoop audioId:"+B+" bool:"+q),ee&&ee.setLoop(B,q)},addClipRect:function(B,q){n("addClipRect"),R.info("VDI Adding Occlusion "+JSON.stringify(B)),F(q,function(X){X.addOcclusion(B)})},removeClipRect:function(B,q){n("removeClipRect"),R.info("VDI Removing Occlusion "+JSON.stringify(B)),F(q,function(X){X.removeOcclusion(B)})},initLog:function(B,q){R.setMSLogger(B,q),R.info("VDI init logger")},isFeatureOn:O,onConnectionChange:function(B){n("onConnectionChange"),R.info("VDI : onConnectionChange to "+B),B===!1?R.info("Disconnecting from the VDA"):(R.info("Connecting to the VDA"),B=window.getCitrixWebrtcRedir,B!==void 0?B().then(function(q){R.info("Sucesss on connect, CitrixRedir reg value:"+q),q==="0"||q==="1"?o(q):(R.info("MS Teams Redir Reg key not updated yet"),b())}).catch(function(){R.error("Failure to Read MS Teams redir Reg Key"),b()}):(R.warning("window.getCitrixWebrtcRedir() method is not available yet"),b()))},getScreensAsync:function(){n("getScreensAsync"),R.info("VDI Shim getScreensAsync"),U();var B=N();return B.getScreensAsync.apply(B,arguments)},getWindowsAsync:function(){n("getWindowsAsync"),R.info("VDI Shim getWindowsAsync"),U();var B=N();return B.getWindowsAsync.apply(B,arguments)},setScreenSharePanelId:function(B){n("setScreenSharePanelId"),R.info("VDI: setScreenSharePanelId set to "+JSON.stringify(B)),U(),Y!==null&&Y.isValid()||(Y=new c.RemoteDevices),Y.panelid=B},setCodecCapabilities:function(B){return n("setCodecCapabilities"),U(),R.info("VDI Shim setCodecCapabilities"),K!==null&&K.isValid()||(K=new c.NavigatorUserMedia),K.setCodecCapabilities(B)},getE911Data:function(){return n("getE911Data"),oe?oe.getE911Info():null},createMediaStream:function(B){return n("createMediaStream"),R.info("VDI Shim createMediaStream"),k(B,!1)},createMediaStreamAsync:function(B){return n("createMediaStreamAsync"),R.info("VDI Shim createMediaStreamAsync"),k(B,!0)},disposeMediaStream:function(B){var q,X;n("disposeMediaStream"),R.info("VDI Shim disposeMediaStream: ");try{for(var $=A(B),de=$.next();!de.done;de=$.next()){var ue=de.value;ue&&ue.dispose()}}catch(le){q={error:le}}finally{try{de&&!de.done&&(X=$.return)&&X.call($)}finally{if(q)throw q.error}}},getCapabilities:function(B){return n("getCapabilities"),U(),R.info("VDI Shim getCapabilities"),K!==null&&K.isValid()||(K=new c.NavigatorUserMedia,Q=c.NavigatorUserMedia.getCapabilities),Q.apply(K,arguments)},initUCSDK:function(B){if(R.info("VDI Shim initUCSDK vendor:"+B),re)throw R.error("VDI Shim initUCSDK: throwing exception: Already initialized."),new DOMException("UCSDK is already initialized.");var q;if(typeof B=="string"&&(q=B.trim()),q===void 0||q.length===0)throw R.error("VDI Shim initUCSDK: throwing exception: vendor info cannot be empty!!!"),new DOMException("vendor info cannot be empty, please pass vendor info string!!!");ne=q,K=new c.NavigatorUserMedia,Y=new c.RemoteDevices,ee=new a,i(ne),window.onVdiClientDisconnected=C,window.onVdiClientDisconnectedTimer=s,window.onVdiClientConnected=r,re=!0},deinitUCSDK:function(){R.info("VDI Shim deinitUCSDK"),re&&(x(),t.getRedirector().setDeiniting(),t.getRedirector().terminateOptimization(),window.onVdiClientDisconnectedTimer=void 0,ne=window.onVdiClientConnected=void 0,re=!1)},createAudioContext:function(){return n("createAudioContext"),R.info("VDI Shim createAudioContext"),U(),O(h.FEATURE_public_share_system_audio)?new I(0):null},getHid:function(){n("getHid");var B=null;return O(h.FEATURE_public_webhid)&&(B=v()),B}}})},679:function(f,e,p){var V=this&&this.__extends||function(){var g=function(y,a){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,d){v.__proto__=d}||function(v,d){for(var I in d)d.hasOwnProperty(I)&&(v[I]=d[I])},g(y,a)};return function(y,a){function v(){this.constructor=y}g(y,a),y.prototype=a===null?Object.create(a):(v.prototype=a.prototype,new v)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.VideoElement=e.VideoRect=void 0;var j=p(658),A=p(610),S=p(550),c=p(851),w=p(946),E=p(550),R=function(){return function(g,y){this.x=Math.round(g.x)*y.devicePixelRatio,this.y=Math.round(g.y)*y.devicePixelRatio,this.width=Math.round(g.width)*y.devicePixelRatio,this.height=Math.round(g.height)*y.devicePixelRatio}}();e.VideoRect=R;var _;(function(g){g[g.pixels=0]="pixels",g[g.percent=1]="percent"})(_||(_={}));var m=function(){function g(y){this.value=parseInt(y),this.units=this.detectUnits(y)}return g.prototype.detectUnits=function(y){return y.toLowerCase().indexOf("px")===-1?_.pixels:_.percent},g}(),l;(function(g){g[g.fill=0]="fill",g[g.contain=1]="contain",g[g.cover=2]="cover"})(l||(l={}));var t=function(){return function(g,y){this.x=g,this.y=y}}(),u=function(){function g(y,a,v){this.fit=this.convertFit(y),this.position=new t(a,v)}return g.prototype.convertFit=function(y){return y=="fill"?l.fill:y=="contain"?l.contain:y=="cover"?l.cover:l.fill},g}(),h;(function(g){g[g.NotReady=0]="NotReady",g[g.Ready=1]="Ready"})(h||(h={})),f=function(g){function y(a,v){var d=g.call(this,null,S.class_id_t.VideoElement,0,j.ProxyMode.Local)||this;return d.srcObject_=null,d.sinkId_="",d.videoWidth=0,d.videoHeight=0,d.isLoaded=!1,d.connectionState="disconnected",d.styleObserver=null,d.readyState_=h.NotReady,d.deferredVideoActions=[],d.pendingRelease_=!1,d.activeConnectionEvent_=null,d.connectionEventQueue_=[],d.window_=v,d.elementId=a,c.logger.info("VideoElement.constructor (elementid: "+a+")"),d}return V(y,g),y.prototype.dispose=function(){var a=this;c.logger.info("VideoElement.dispose (elementId: "+this.elementId+" oid: "+this.object_id()+")"),this.pendingRelease_=!0,this.srcObject=this.ontimeupdate=this.onloadedmetadata=null,this.waitUntilReady("VideoElement.dispose").then(function(){}).catch(function(){a.pendingRelease_=!1,a.setState("disconnected"),a.onconnectionstatechange=null,a.release()}),this.onReady()},y.prototype.setState=function(a){this.connectionState=a,this.onconnectionstatechange_&&this.onconnectionstatechange_()},Object.defineProperty(y.prototype,"Id",{get:function(){return this.elementId},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"sinkId",{get:function(){return this.sinkId_},set:function(a){var v=this;c.logger.info("VideoElement.sinkId: (id="+a+")"),this.waitUntilConnected("VideoElement.sinkId").then(function(){return a!=null?v.remoteInvoke(!0,S.method_id_VideoElement_t.sinkId,a):new Promise(function(d){return d(void 0)})}).then(function(){c.logger.info("videoElement: setting state to ready. (oid: "+v.object_id()+")"),v.sinkId_=a,v.readyState_=h.Ready,v.onReady()}).catch(function(d){v.logRemoteInvokeError(d,".set_sinkId() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(a){if(c.logger.info(this.user_friendly_id()+".srcObject: set srcObject... this.srcObject:"+this.srcObject+" obj:"+a),this.srcObject_!==a){var v=w.getRedirector().getFeatureValue(E.FEATURE_ms_teams_1911);this.srcObject_!==null&&(a===null&&v&&this.disconnect(),v||this.disconnect(),this.isLoaded=!1),this.srcObject_=a,this.srcObject_!==null&&this.connectTo(this.srcObject_)}},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onconnectionstatechange",{get:function(){return this.onconnectionstatechange_},set:function(a){c.logger.info(this.user_friendly_id()+".set_onconnectionstatechange() called."),this.onconnectionstatechange_=a},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onloadedmetadata",{set:function(a){c.logger.info(this.user_friendly_id()+".set_onloadedmetadata() called."),this.onloadedmetadata_=a},enumerable:!1,configurable:!0}),y.prototype.setupOnVideoFrameChanged=function(){var a=this,v=this.registerCallbacks(!1,!1,S.method_id_VideoElement_t.onvideoframechanged);v.then(function(d){c.logger.info(a.user_friendly_id()+".onvideoframechanged",d.params),a.videoWidth=d.params[0]||0,a.videoHeight=d.params[1]||0,a.isLoaded||(a.isLoaded=!0,a.onloadedmetadata_&&a.onloadedmetadata_())}),this.remoteInvoke(!0,S.method_id_VideoElement_t.onvideoframechanged,v.success)},y.prototype.processConnectionEvent=function(){var a=this;if(this.connectionEventQueue_.length!==0&&!this.activeConnectionEvent_){var v=this.connectionEventQueue_.pop();v.operation=="connectTo"?this.activeConnectionEvent_=this.connectToAsync(v.param):v.operation=="disconnect"&&(this.activeConnectionEvent_=this.disconnectAsync()),this.activeConnectionEvent_.then(function(){a.activeConnectionEvent_=void 0,a.processConnectionEvent()}).catch(function(){c.logger.error(a.user_friendly_id()+" : Failed to handle connection event! "),a.activeConnectionEvent_=void 0,a.processConnectionEvent()})}},y.prototype.connectTo=function(a){this.connectionEventQueue_.push({operation:"connectTo",param:a}),this.processConnectionEvent()},y.prototype.disconnect=function(){this.connectionEventQueue_.push({operation:"disconnect",param:null}),this.processConnectionEvent()},y.prototype.connectToAsync=function(a){var v=this;return new Promise(function(d,I){c.logger.info(v.user_friendly_id()+".connectTo: connect media stream with id = "+a.id+", clone_id = "+a.clone_state.clone_id),v.streamId_=a.id,v.waitUntilReady("VideoElement.connectTo").then(function(){return a.waitUntilConnected("MediaStream.connectTo")}).then(function(){return v.setupOnVideoFrameChanged(),a.clone_state.synchronize(a)}).then(function(k){c.logger.info(v.user_friendly_id()+".connectTo: remote invoking");var D=v.registerCallbacks(!0,!1,S.method_id_VideoElement_t.connectTo);return Promise.all([v.remoteInvokeEx(!1,S.method_id_VideoElement_t.connectTo,[k],D.success,D.fail),D.prom()])}).then(function(k){c.logger.info(v.user_friendly_id()+".connectTo: remote media stream is connected!"),v.setState("connected"),v.watch(),v.updateTimer=setInterval(function(){v.ontimeupdate&&v.ontimeupdate()},250),(k=v.window_.document.getElementById(v.elementId))&&v.updateStyle(k),d()}).catch(function(k){v.logRemoteInvokeError(k,".connectTo: failed to connect!"),I()})})},y.prototype.disconnectAsync=function(){var a=this;return new Promise(function(v,d){c.logger.info(a.user_friendly_id()+".disconnect: disconnecting stream : "+a.streamId_),a.unwatch(),a.waitUntilReady("VideoElement.disconnect").then(function(){a.updateTimer&&clearInterval(a.updateTimer);var I=a.registerCallbacks(!1,!0,S.method_id_VideoElement_t.onvideoframechanged);return a.remoteInvoke(!0,S.method_id_VideoElement_t.onvideoframechanged,I.success),a.remoteInvoke(!1,S.method_id_VideoElement_t.disconnect)}).then(function(){c.logger.info(a.user_friendly_id()+".disconnect: remote media stream is disconnected!"),a.setState("disconnected"),a.pendingRelease_==1&&(a.pendingRelease_=!1,a.onconnectionstatechange=null,a.release()),v()}).catch(function(I){a.logRemoteInvokeError(I,".disconnect: failed to connect!"),d()})})},y.prototype.setFrame=function(a){var v=this;c.logger.info(this.user_friendly_id()+".setFrame: set video frame to",a.x,a.y,a.width,a.height),this.waitUntilReady("VideoElement.setFrame").then(function(){var d=new R(a,v.window_);return v.remoteInvoke(!1,S.method_id_VideoElement_t.setFrame,d)}).then(function(){c.logger.info(v.user_friendly_id()+".setFrame: success!")}).catch(function(d){v.logRemoteInvokeError(d,".setFrame: failed to connect!")})},y.prototype.addClipRect=function(a){var v=this;c.logger.info(this.user_friendly_id()+".addClipRect: ",JSON.stringify(a)),this.waitUntilReady("VideoElement.addClipRect").then(function(){var d=new R(a,v.window_);return v.remoteInvoke(!1,S.method_id_VideoElement_t.addClipRect,d)}).catch(function(d){v.logRemoteInvokeError(d,".addClipRect failed!")})},y.prototype.removeClipRect=function(a){var v=this;c.logger.info(this.user_friendly_id()+".removeClipRect: ",JSON.stringify(a)),this.waitUntilReady("VideoElement.removeClipRect").then(function(){var d=new R(a,v.window_);return v.remoteInvoke(!1,S.method_id_VideoElement_t.removeClipRect,d)}).catch(function(d){v.logRemoteInvokeError(d,".removeClipRect failed!")})},y.prototype.watch=function(){var a=this;if(w.getRedirector().getFeatureValue(E.FEATURE_ms_teams_video_placement)){var v=this.window_.document.getElementById(this.elementId);v&&(this.unwatch(),this.styleObserver=new MutationObserver(function(d){d.forEach(function(I){I.attributeName=="style"?I.oldValue.indexOf("background-color")==-1&&a.updateStyle(I.target):a.elementId=I.target.id})}),this.styleObserver.observe(v,{attributes:!0,attributeOldValue:!0,attributeFilter:["style","id"]}))}},y.prototype.unwatch=function(){this.styleObserver&&(this.styleObserver.disconnect(),this.styleObserver=null)},y.prototype.updateStyle=function(a){if(this.connectionState=="connected"){var v=this.window_.getComputedStyle(a).getPropertyValue("object-fit"),d=this.window_.getComputedStyle(a).getPropertyValue("object-position").split(" ");a=new m(d[0]),d=new m(d[1]),this.placement=new u(v,a,d)}else c.logger.warning(this.user_friendly_id()+".updateStyle: video element is not connected")},Object.defineProperty(y.prototype,"placement",{get:function(){return this.placement_},set:function(a){var v=this;w.getRedirector().getFeatureValue(E.FEATURE_ms_teams_video_placement)?this.waitUntilReady("VideoElement.placement").then(function(){return v.remoteInvoke(!0,S.method_id_VideoElement_t.placement,a)}).then(function(){v.placement_=a}).catch(function(d){v.logRemoteInvokeError(d,".placement setter: failed to connect!")}):c.logger.warning(this.user_friendly_id()+".placement: video placement feature is not supported on a client")},enumerable:!1,configurable:!0}),y.prototype.waitUntilReady=function(a){var v=this;return new Promise(function(d,I){c.logger.info("VideoElement.waitUntilReady(): readyState="+v.readyState_+". (oid: "+v.object_id()+")"),v.readyState_==h.Ready?d():(c.logger.info('videoElement.waitUntilReady(): deferring action "'+a+'". (oid: '+v.object_id()+")"),v.deferredVideoActions.push(new A.deferred_action(d,I,a)))})},y.prototype.onReady=function(){for(;this.deferredVideoActions&&0<this.deferredVideoActions.length;)this.deferredVideoActions.shift().post(this.readyState_==h.Ready)},y}(j.ProxyObject),e.VideoElement=f},919:function(f,e,p){function V(){return k||(k=new I),k}var j=this&&this.__extends||function(){var U=function(C,i){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,r){s.__proto__=r}||function(s,r){for(var o in r)r.hasOwnProperty(o)&&(s[o]=r[o])},U(C,i)};return function(C,i){function s(){this.constructor=C}U(C,i),C.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),A=this&&this.__values||function(U){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var C=typeof Symbol=="function"&&Symbol.iterator,i=C&&U[C],s=0;if(i)return i.call(U);if(U&&typeof U.length=="number")return{next:function(){return U&&s>=U.length&&(U=void 0),{value:U&&U[s++],done:!U}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")},S=this&&this.__read||function(U,C){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var i=typeof Symbol=="function"&&U[Symbol.iterator];if(!i)return U;var s=i.call(U),r,o=[],b;try{for(;(C===void 0||0<C--)&&!(r=s.next()).done;)o.push(r.value)}catch(T){b={error:T}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(b)throw b.error}}return o};Object.defineProperty(e,"__esModule",{value:!0}),e.HidInputReportEvent=e.HidConnectionEventInternal=e.HidConnectionEvent=e.destroyHIDInterface=e.getHIDInterface=e.HidInterface=e.HidDevice=e.HidCollectionInfo=e.HidReportInfo=e.HidReportItem=e.NumberBoundsUtil=e.JS_NUMBER_TYPE=e.JS_NUMBER_LEN=e.JS_NUMBER_MASK=e.HidDeviceRequestOptions=e.HIDUnitSystem=void 0;var c=p(550),w=p(658),E=p(259),R=p(851),_=function(U){return U!=null?Uint32Array.from(Int32Array.of(U))[0]:U};(function(U){U[U.none=0]="none",U[U.si_linear=1]="si_linear",U[U.si_rotation=2]="si_rotation",U[U.english_linear=3]="english_linear",U[U.english_rotation=4]="english_rotation",U[U.vendor_defined=5]="vendor_defined",U[U.reserved=6]="reserved"})(e.HIDUnitSystem||(e.HIDUnitSystem={}));var m=function(){function U(){}return U.validate=function(C){var i=new U;if(typeof C!="object")throw TypeError("Filter is not object. Filter = "+C);if(this.validateField("vendorId",C,i),this.validateField("productId",C,i),this.validateField("usagePage",C,i),this.validateField("usage",C,i),i.productId!=null&&i.vendorId==null)throw TypeError("productId is present but the venderId is not.");if(i.usage!=null&&i.usagePage==null)throw TypeError("usage is present but the usagePage is not.");var s=Object.keys(i);if(Object.keys(C).forEach(function(r){s.indexOf(r)==-1&&R.logger.warning("HidDeviceFilter unexpected field will be ignored. Field = "+r)}),s.length==0)throw TypeError("HIDDeviceFilter must have at least one expected field.");return i},U.validateField=function(C,i,s){if(i=i[C],i!==void 0)if(typeof i=="number")s[C]=i;else throw TypeError(C+" is not a number")},U}(),l=function(){function U(){this.filters=[]}return U.validate=function(C){var i,s,r,o;R.logger.info("HidDeviceRequestOptions.validate() called with options = "+JSON.stringify(C));var b=new U;try{var T=C.filters;if(T==null)throw TypeError("filters field is missing.");if(!Array.isArray(T))throw TypeError("filters field is not an array.");try{for(var O=A(T),x=O.next();!x.done;x=O.next()){var N=m.validate(x.value);b.filters.push(N)}}catch(te){i={error:te}}finally{try{x&&!x.done&&(s=O.return)&&s.call(O)}finally{if(i)throw i.error}}var n=C.exclusionFilters;if(n){if(!Array.isArray(n))throw TypeError("exclusionFilters field is not an array.");b.exclusionFilters=[];try{for(var G=A(n),K=G.next();!K.done;K=G.next()){var Q=m.validate(K.value);b.exclusionFilters.push(Q)}}catch(te){r={error:te}}finally{try{K&&!K.done&&(o=G.return)&&o.call(G)}finally{if(r)throw r.error}}}var Y=Object.keys(b);Object.keys(C).forEach(function(te){Y.indexOf(te)==-1&&R.logger.warning("HidDeviceRequestOptions unexpected field will be ignored. Field = "+te)})}catch(te){return R.logger.error("HidDeviceRequestOptions parsing error. error = "+te.message),null}return b},U}();e.HidDeviceRequestOptions=l;var t;(function(U){U[U.byte=127]="byte",U[U.octet=255]="octet",U[U.short=32767]="short",U[U.ushort=65535]="ushort",U[U.long=2147483647]="long",U[U.ulong=4294967295]="ulong"})(t=e.JS_NUMBER_MASK||(e.JS_NUMBER_MASK={}));var u;(function(U){U[U.byte=7]="byte",U[U.octet=8]="octet",U[U.short=15]="short",U[U.ushort=16]="ushort",U[U.long=31]="long",U[U.ulong=32]="ulong"})(u=e.JS_NUMBER_LEN||(e.JS_NUMBER_LEN={}));var h;(function(U){U[U.byte=0]="byte",U[U.octet=1]="octet",U[U.short=2]="short",U[U.ushort=3]="ushort",U[U.long=4]="long",U[U.ulong=5]="ulong"})(h=e.JS_NUMBER_TYPE||(e.JS_NUMBER_TYPE={}));var g=function(){function U(){}return U.unsigned_bitwise_and_op=function(C,i,s){for(var r="",o=0;o<s;o++)r=(C>>o&i>>o&1).toString()+r;return+("0b"+r)},U.to_byte=function(C){return(0>C?-1:1)*(t.byte&Math.abs(C))},U.to_octet=function(C){return U.unsigned_bitwise_and_op(t.octet,C,u.octet)},U.to_short=function(C){return(0>C?-1:1)*(t.short&Math.abs(C))},U.to_ushort=function(C){return U.unsigned_bitwise_and_op(t.ushort,C,u.ushort)},U.to_long=function(C){return(0>C?-1:1)*(t.long&Math.abs(C))},U.to_ulong=function(C){return U.unsigned_bitwise_and_op(t.ulong,C,u.ulong)},U.validate_number=function(C,i){if(i!=null){var s=0,r=!0;switch(C){case h.byte:s=U.to_byte(i);break;case h.octet:s=U.to_octet(i);break;case h.short:s=U.to_short(i);break;case h.ushort:s=U.to_ushort(i);break;case h.long:s=U.to_long(i);break;case h.ulong:s=U.to_ulong(i);break;default:R.logger.error("NumberBoundsUtil.validate_number() invalid number type!")}return s!=i&&(r=!1,R.logger.error("NumberBoundsUtil.validate() validate_number overflow! v:"+i.toString(16)+" modified:"+s.toString(16))),[s,r]}return i===void 0?[void 0,!0]:[void 0,!1]},U}();e.NumberBoundsUtil=g;var y=function(){function U(){}return U.validate=function(C){var i,s=[],r=!0;if(C){if(C.isRange)C.usages=void 0,r=!0,i=_(C.usageMinimum),i=S(g.validate_number(h.ulong,i),2),C.usageMinimum=i[0],(r=i[1])&&C.usageMinimum!==void 0||s.push("usageMinimum"),r=!0,i=_(C.usageMaximum),i=S(g.validate_number(h.ulong,i),2),C.usageMaximum=i[0],(r=i[1])&&C.usageMaximum!==void 0||s.push("usageMinimum");else{C.usageMinimum=void 0,C.usageMaximum=void 0;var r=!0,o=[];C.usages!==void 0&&C.usages.forEach(function(T){var O;T=_(T),T=S(g.validate_number(h.ulong,T),2),O=T[0],r=T[1],o.push(O),r||s.push("usages")}),C.usages=0<o.length?o:void 0}r=!0,i=S(g.validate_number(h.ushort,C.reportSize),2),C.reportSize=i[0],(r=i[1])||s.push("reportSize"),r=!0,i=S(g.validate_number(h.ushort,C.reportCount),2),C.reportCount=i[0],(r=i[1])||s.push("reportCount"),r=!0,i=S(g.validate_number(h.byte,C.unitExponent),2),C.unitExponent=i[0],(r=i[1])||s.push("unitExponent"),r=!0,i=S(g.validate_number(h.byte,C.unitFactorLengthExponent),2),C.unitFactorLengthExponent=i[0],(r=i[1])||s.push("unitFactorLengthExponent"),r=!0,i=S(g.validate_number(h.byte,C.unitFactorMassExponent),2),C.unitFactorMassExponent=i[0],(r=i[1])||s.push("unitFactorMassExponent"),r=!0,i=S(g.validate_number(h.byte,C.unitFactorTimeExponent),2),C.unitFactorTimeExponent=i[0],(r=i[1])||s.push("unitFactorTimeExponent"),r=!0,i=S(g.validate_number(h.byte,C.unitFactorTemperatureExponent),2),C.unitFactorTemperatureExponent=i[0],(r=i[1])||s.push("unitFactorTemperatureExponent"),r=!0,i=S(g.validate_number(h.byte,C.unitFactorCurrentExponent),2),C.unitFactorCurrentExponent=i[0],(r=i[1])||s.push("unitFactorCurrentExponent"),r=!0,i=S(g.validate_number(h.byte,C.unitFactorLuminousIntensityExponent),2),C.unitFactorLuminousIntensityExponent=i[0],(r=i[1])||s.push("unitFactorLuminousIntensityExponent"),r=!0,i=S(g.validate_number(h.long,C.logicalMinimum),2),C.logicalMinimum=i[0],(r=i[1])||s.push("logicalMinimum"),r=!0,i=S(g.validate_number(h.long,C.logicalMaximum),2),C.logicalMaximum=i[0],(r=i[1])||s.push("logicalMaximum"),r=!0,i=S(g.validate_number(h.long,C.physicalMinimum),2),C.physicalMinimum=i[0],(r=i[1])||s.push("physicalMinimum"),r=!0,i=S(g.validate_number(h.long,C.physicalMaximum),2),C.physicalMaximum=i[0],(r=i[1])||s.push("physicalMaximum")}return 0<s.length&&(r=!1,R.logger.error("HidReportItem.validate() overflows:"+s)),[C,r]},U}();e.HidReportItem=y;var a=function(){function U(){}return U.validate=function(C){var i,s=[],r=!0;if(C&&(r=!0,i=S(g.validate_number(h.octet,C.reportId),2),C.reportId=i[0],(r=i[1])||s.push("reportId"),r=!0,C.items!==void 0)){var o=[];C.items.forEach(function(b){var T;b=S(y.validate(b),2),T=b[0],r=b[1],o.push(T),r||s.push("items")}),C.items=o}return 0<s.length&&(r=!1,R.logger.error("HidReportInfo.validate() overflows:"+s)),[C,r]},U}();e.HidReportInfo=a;var v=function(){function U(){}return U.validate=function(C){var i,s=[],r=!0;if(C){if(r=!0,i=S(g.validate_number(h.ushort,C.usagePage),2),C.usagePage=i[0],(r=i[1])||s.push("usagePage"),r=!0,i=S(g.validate_number(h.ushort,C.usage),2),C.usage=i[0],(r=i[1])||s.push("usage"),r=!0,i=S(g.validate_number(h.ushort,C.type),2),C.type=i[0],(r=i[1])||s.push("type"),r=!0,C.children!==void 0){var o=[];C.children.forEach(function(x){var N;x=S(U.validate(x),2),N=x[0],r=x[1],o.push(N),r||s.push("children")}),C.children=o}if(r=!0,C.inputReports!==void 0){var b=[];C.inputReports.forEach(function(x){var N;x=S(a.validate(x),2),N=x[0],r=x[1],b.push(N),r||s.push("inputReports")}),C.inputReports=b}if(r=!0,C.outputReports!==void 0){var T=[];C.outputReports.forEach(function(x){var N;x=S(a.validate(x),2),N=x[0],r=x[1],T.push(N),r||s.push("outputReports")}),C.outputReports=T}if(r=!0,C.featureReports!==void 0){var O=[];C.featureReports.forEach(function(x){var N;x=S(a.validate(x),2),N=x[0],r=x[1],O.push(N),r||s.push("featureReports")}),C.featureReports=O}}return 0<s.length&&(r=!1,R.logger.error("HidCollectionInfo.validate() overflows:"+s)),[C,r]},U}();e.HidCollectionInfo=v;var d=function(U){function C(i,s){var r=U.call(this,i,c.class_id_t.WebHidDevice,s,w.ProxyMode.Remote)||this;return r.setupOnCollectionsAddedCallback(),r}return j(C,U),C.prototype.syncBarrier=function(){var i=this;return R.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(s,r){i.waitUntilConnected(i.user_friendly_id()+".syncBarrier").then(function(){return Promise.all([i.remoteInvoke(!1,c.method_id_WebHidDevice_t.opened,!1),i.remoteInvoke(!1,c.method_id_WebHidDevice_t.vendorId,0),i.remoteInvoke(!1,c.method_id_WebHidDevice_t.productId,0),i.remoteInvoke(!1,c.method_id_WebHidDevice_t.productName,""),i.remoteInvoke(!1,c.method_id_WebHidDevice_t.collections,{}),i.remoteInvoke(!1,c.method_id_WebHidDevice_t.compositeId,"")])}).then(function(o){var b,T,O;R.logger.info(i.user_friendly_id()+".syncBarrier remote success.");var x;o=S(o.map(function(Q){return i.param0(Q)}),6),i.opened_=o[0],i.vendorId_=o[1],i.productId_=o[2],i.productName_=o[3],x=o[4],i.compositeId_=o[5],o=!0;var N=[];try{for(var n=A(x),G=n.next();!G.done;G=n.next()){var K=x=void 0;O=S(v.validate(G.value),2),x=O[0],(K=O[1])?N.push(x):o=!1}}catch(Q){b={error:Q}}finally{try{G&&!G.done&&(T=n.return)&&T.call(n)}finally{if(b)throw b.error}}i.collections_=N,o||R.logger.warning(i.user_friendly_id()+"collections received from endpoint got truncated!!!"),s(i)}).catch(function(o){o=i.logRemoteInvokeError(o,".syncBarrier() failed!"),r(o)})})},C.prototype.syncBarrierForStateAttributes=function(){var i=this;return R.logger.info(this.user_friendly_id()+".syncBarrierForStateAttributes() called."),new Promise(function(s,r){i.waitUntilConnected(i.user_friendly_id()+".syncBarrierForStateAttributes").then(function(){return Promise.all([i.remoteInvoke(!1,c.method_id_WebHidDevice_t.opened,!1)])}).then(function(o){R.logger.info(i.user_friendly_id()+".syncBarrierForStateAttributes remote success."),o=S(o.map(function(b){return i.param0(b)}),1),i.opened_=o[0],s(i)}).catch(function(o){o=i.logRemoteInvokeError(o,".syncBarrierForStateAttributes() failed!"),r(o)})})},C.prototype.copyStateAttributes=function(i){this.opened_=i.opened},Object.defineProperty(C.prototype,"opened",{get:function(){return this.opened_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"vendorId",{get:function(){return this.vendorId_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"productId",{get:function(){return this.productId_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"productName",{get:function(){return this.productName_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"collections",{get:function(){return this.collections_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"oninputreport",{get:function(){return this.oninputreport_},set:function(i){var s=this;this.oninputreport_=i,this.waitUntilConnected(this.user_friendly_id()+".oninputreport").then(function(){var r=s.registerCallbacks(!1,s.isNullCallback(s.oninputreport_),c.method_id_WebHidDevice_t.oninputreport);return r.then(function(o){var b=new L(s,s.param0(o).oid,"inputreport");b.useMinimalLogging=!0,b.syncBarrier().then(function(T){if(s.oninputreport_&&T&&T.isValid()){var O=new H(T.device,T.reportId,T.data,T.type);s.oninputreport_(O)}T.release()}).catch(function(){b.release()})}),s.remoteInvoke(!0,c.method_id_WebHidDevice_t.oninputreport,r.success)}).catch(function(r){s.logRemoteInvokeError(r,"set_oninputreport() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"groupId",{get:function(){return this.compositeId_},enumerable:!1,configurable:!0}),C.prototype.open=function(){var i=this;return R.logger.info(this.user_friendly_id()+".open() called."),new Promise(function(s,r){i.waitUntilConnected(i.user_friendly_id()+".open").then(function(){var o=i.registerCallbacks(!0,!1,c.method_id_WebHidDevice_t.open);return i.remoteInvoke(!1,c.method_id_WebHidDevice_t.open,o.success,o.fail),o.prom()}).then(function(){return R.logger.info(i.user_friendly_id()+".open(): remote success!"),i.syncBarrierForStateAttributes()}).then(function(){R.logger.info(i.user_friendly_id()+".open(): syncBarrierForStateAttributes success!"),s()}).catch(function(o){o=i.logRemoteInvokeError(o,".open() failed."),r(o)})})},C.prototype.close=function(){var i=this;return R.logger.info(this.user_friendly_id()+".close() called."),new Promise(function(s,r){i.waitUntilConnected(i.user_friendly_id()+".close").then(function(){var o=i.registerCallbacks(!0,!1,c.method_id_WebHidDevice_t.close);return i.remoteInvoke(!1,c.method_id_WebHidDevice_t.close,o.success,o.fail),o.prom()}).then(function(){return R.logger.info(i.user_friendly_id()+".close(): remote success!"),i.syncBarrierForStateAttributes()}).then(function(){R.logger.info(i.user_friendly_id()+".close(): syncBarrierForStateAttributes success!"),s()}).catch(function(o){o=i.logRemoteInvokeError(o,".close() failed."),r(o)})})},C.prototype.forget=function(){var i=this;return R.logger.info(this.user_friendly_id()+".forget() called."),new Promise(function(s,r){i.waitUntilConnected(i.user_friendly_id()+".forget").then(function(){var o=i.registerCallbacks(!0,!1,c.method_id_WebHidDevice_t.forget);return i.remoteInvoke(!1,c.method_id_WebHidDevice_t.forget,o.success,o.fail),o.prom()}).then(function(){return R.logger.info(i.user_friendly_id()+".forget(): remote success!"),i.syncBarrierForStateAttributes()}).then(function(){R.logger.info(i.user_friendly_id()+".forget(): syncBarrierForStateAttributes success!"),s()}).catch(function(o){o=i.logRemoteInvokeError(o,".forget() failed."),r(o)})})},C.prototype.sendReport=function(i,s){var r=this;return R.logger.info(this.user_friendly_id()+".sendReport() called for reportId = "+i),new Promise(function(o,b){C.validateReportId(i)?r.waitUntilConnected(r.user_friendly_id()+".sendReport").then(function(){var T=r.registerCallbacks(!0,!1,c.method_id_WebHidDevice_t.sendReport);return r.remoteInvoke(!1,c.method_id_WebHidDevice_t.sendReport,T.success,T.fail,i,E.Util.toByteArray(s)),T.prom()}).then(function(){R.logger.info(r.user_friendly_id()+".sendReport(): remote success!"),o()}).catch(function(T){T=r.logRemoteInvokeError(T,".sendReport() failed."),b(T)}):b(new TypeError("reportId is not an 8-bit integer."))})},C.prototype.sendFeatureReport=function(i,s){var r=this;return R.logger.info(this.user_friendly_id()+".sendFeatureReport() called for reportId = "+i),new Promise(function(o,b){C.validateReportId(i)?r.waitUntilConnected(r.user_friendly_id()+".sendFeatureReport").then(function(){var T=r.registerCallbacks(!0,!1,c.method_id_WebHidDevice_t.sendFeatureReport);return r.remoteInvoke(!1,c.method_id_WebHidDevice_t.sendFeatureReport,T.success,T.fail,i,E.Util.toByteArray(s)),T.prom()}).then(function(){R.logger.info(r.user_friendly_id()+".sendFeatureReport(): remote success!"),o()}).catch(function(T){T=r.logRemoteInvokeError(T,".sendFeatureReport() failed."),b(T)}):b(new TypeError("reportId is not an 8-bit integer."))})},C.prototype.receiveFeatureReport=function(i){var s=this;return R.logger.info(this.user_friendly_id()+".receiveFeatureReport() called for reportId = "+i),new Promise(function(r,o){C.validateReportId(i)?s.waitUntilConnected(s.user_friendly_id()+".receiveFeatureReport").then(function(){var b=s.registerCallbacks(!0,!1,c.method_id_WebHidDevice_t.receiveFeatureReport);return s.remoteInvoke(!1,c.method_id_WebHidDevice_t.receiveFeatureReport,b.success,b.fail,i),b.prom()}).then(function(b){R.logger.info(s.user_friendly_id()+".receiveFeatureReport(): remote success!"),b=s.param0(b),b=new Uint8Array(b),r(E.Util.toDataView(b.buffer))}).catch(function(b){b=s.logRemoteInvokeError(b,".receiveFeatureReport() failed."),o(b)}):o(new TypeError("reportId is not an 8-bit integer."))})},C.validateReportId=function(i){return!!(Number.isInteger(i)&&0<=i&&255>=i)},C.prototype.findCollection=function(i,s){return this.collections_.find(function(r){return r.usagePage===i&&r.usage===s})},C.prototype.addCollections=function(i){var s=this;i.forEach(function(r){R.logger.info(s.user_friendly_id()+".addCollections adding collection for Page = "+r.usagePage+", Usage = "+r.usage),s.findCollection(r.usagePage,r.usage)===void 0&&s.collections_.push(r)})},C.prototype.setupOnCollectionsAddedCallback=function(){var i=this;this.waitUntilConnected(this.user_friendly_id()+".onCollectionsAdded").then(function(){var s=i.registerCallbacks(!1,!1,c.method_id_WebHidDevice_t.onCollectionsAdded);return s.then(function(r){var o=new z(i,i.param0(r).oid);o.syncBarrier().then(function(b){b.device&&b.collections&&b.device.addCollections(b.collections),b.release()}).catch(function(){o.release()})}),i.remoteInvoke(!0,c.method_id_WebHidDevice_t.onCollectionsAdded,s.success)}).catch(function(s){i.logRemoteInvokeError(s,"set_oninputreport() failed!")})},C}(w.ProxyObject);e.HidDevice=d;var I=function(U){function C(){var i=U.call(this,null,c.class_id_t.WebHidInterface,0,w.ProxyMode.Local)||this;return i.devices_=[],i}return j(C,U),C.prototype.findDeviceByOId=function(i){return this.devices_.find(function(s){return s.object_id()===i})},C.prototype.addDevice=function(i){if(i){var s=this.devices_.find(function(r){return r.object_id()===i.object_id()});if(s)return s.copyStateAttributes(i),s;this.devices_.push(i)}return i},C.prototype.removeDevice=function(i){var s=-1;this.devices_.forEach(function(r,o){r.object_id()===i&&(s=o)}),0<=s&&this.devices_.splice(s,1)},Object.defineProperty(C.prototype,"onconnect",{get:function(){return this.onconnect_},set:function(i){var s=this;this.onconnect_=i,this.waitUntilConnected(this.user_friendly_id()+".onconnect_").then(function(){var r=s.registerCallbacks(!1,s.isNullCallback(s.onconnect_),c.method_id_WebHidInterface_t.onconnect);return r.then(function(o){R.logger.info(s.user_friendly_id()+".onconnect callback received!!!");var b=new F(s,s.param0(o).oid,"connect");b.syncBarrier().then(function(T){if(R.logger.info(s.user_friendly_id()+".onconnect .syncBarrier() success"),T.device&&s.onconnect_){R.logger.info(s.user_friendly_id()+".onconnect notified!!! "+T.device.productName);var O=new D(T.device,T.type);s.onconnect_(O)}T.release()}).catch(function(){b.release()})}),s.remoteInvoke(!0,c.method_id_WebHidInterface_t.onconnect,r.success)}).catch(function(r){s.logRemoteInvokeError(r,"set_onconnect() failed!")})},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"ondisconnect",{get:function(){return this.ondisconnect_},set:function(i){var s=this;this.ondisconnect_=i,this.waitUntilConnected(this.user_friendly_id()+".ondisconnect_").then(function(){var r=s.registerCallbacks(!1,s.isNullCallback(s.ondisconnect_),c.method_id_WebHidInterface_t.ondisconnect);return r.then(function(o){R.logger.info(s.user_friendly_id()+".ondisconnect callback received!!!");var b=new F(s,s.param0(o).oid,"disconnect");b.syncBarrier().then(function(T){if(R.logger.info(s.user_friendly_id()+".ondisconnect .syncBarrier() success"),s.removeDevice(T.device.object_id()),s.ondisconnect_){R.logger.info(s.user_friendly_id()+".ondisconnect notified!!! "+T.device.productName);var O=new D(T.device,T.type);s.ondisconnect_(O)}T.release()}).catch(function(){b.release()})}),s.remoteInvoke(!0,c.method_id_WebHidInterface_t.ondisconnect,r.success)}).catch(function(r){s.logRemoteInvokeError(r,"set_ondisconnect() failed!")})},enumerable:!1,configurable:!0}),C.prototype.getDevices=function(){var i=this;return R.logger.info(this.user_friendly_id()+".getDevices() called."),new Promise(function(s,r){var o;i.waitUntilConnected(i.user_friendly_id()+".getDevices").then(function(){return o=i.registerCallbacks(!0,!1,c.method_id_WebHidInterface_t.getDevices),i.remoteInvoke(!1,c.method_id_WebHidInterface_t.getDevices,o.success,o.fail)}).then(function(){return o.prom()}).then(function(b){R.logger.info(i.user_friendly_id()+".getDevices remote success");var T=[],O=[],x=[];b.params[0].forEach(function(N){var n=i.findDeviceByOId(N.oid);n===void 0&&(n=new d(i,N.oid),O.push(n),x.push(n.syncBarrier())),T.push(n)}),Promise.all(x).then(function(){R.logger.info(i.user_friendly_id()+".getDevices: returning devices with ids ["+T.map(function(N){return N.object_id()})+"]"),O.forEach(function(N){i.addDevice(N)}),s(T)}).catch(function(N){i.logRemoteInvokeError(N,".prop.getDevices() failed."),O.forEach(function(n){n.release()}),T=[],s(T)})}).catch(function(b){i.logRemoteInvokeError(b,".getDevices() failed."),s([])})})},Object.defineProperty(C.prototype,"devices",{get:function(){return this.devices_},enumerable:!1,configurable:!0}),C.prototype.requestDevice=function(i){var s=this;return R.logger.info(this.user_friendly_id()+".requestDevice() called with options = "+JSON.stringify(i)),new Promise(function(r,o){var b=l.validate(i);if(b){var T;s.waitUntilConnected(s.user_friendly_id()+".requestDevice").then(function(){return T=s.registerCallbacks(!0,!1,c.method_id_WebHidInterface_t.requestDevice),s.remoteInvoke(!1,c.method_id_WebHidInterface_t.requestDevice,b,T.success,T.fail)}).then(function(){return T.prom()}).then(function(x){R.logger.info(s.user_friendly_id()+".requestDevice remote success");var N=[],n=[],G=[];x.params[0].forEach(function(K){var Q=s.findDeviceByOId(K.oid);Q===void 0&&(Q=new d(s,K.oid),n.push(Q),G.push(Q.syncBarrier())),N.push(Q)}),Promise.all(G).then(function(){R.logger.info(s.user_friendly_id()+".requestDevice: returning devices with ids ["+N.map(function(K){return K.object_id()})+"]"),n.forEach(function(K){s.addDevice(K)}),r(N)}).catch(function(K){s.logRemoteInvokeError(K,".prop.requestDevice() failed."),n.forEach(function(Q){Q.release()}),N=[],r(N)})}).catch(function(x){s.logRemoteInvokeError(x,".requestDevice() failed."),r([])})}else{var O=new TypeError("Invalid HIDDeviceRequestOptions");s.logRemoteInvokeError(O,".requestDevice() failed."),o(O)}})},C.prototype.getHIDDeviceByGroupId=function(i){return this.devices_.find(function(s){return s.groupId===i})},C}(w.ProxyObject);e.HidInterface=I;var k=null;e.getHIDInterface=V,e.destroyHIDInterface=function(){k&&(k.release(),k=null)};var D=function(){function U(C,i){this.type_=i,this.device_=C}return Object.defineProperty(U.prototype,"type",{get:function(){return this.type_},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"device",{get:function(){return this.device_},enumerable:!1,configurable:!0}),U}();e.HidConnectionEvent=D;var F=function(U){function C(i,s,r){return i=U.call(this,i,c.class_id_t.WebHidConnectionEvent,s,w.ProxyMode.Remote)||this,i.type_=r,i}return j(C,U),C.prototype.syncBarrier=function(){var i=this;return R.logger.info(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(s,r){var o;i.waitUntilConnected(i.user_friendly_id()+".syncBarrier").then(function(){return i.remoteInvoke(!1,c.method_id_WebHidConnectionEvent_t.device,{oid:0})}).then(function(b){return R.logger.info(i.user_friendly_id()+".syncBarrier() remote success."),o=k.findDeviceByOId(i.param0(b).oid),o===void 0?(o=new d(k,i.param0(b).oid),V().addDevice(o),o.syncBarrier()):o.syncBarrierForStateAttributes()}).then(function(b){R.logger.info(i.user_friendly_id()+".syncBarrier() success."),i.device_=b,s(i)}).catch(function(b){b=i.logRemoteInvokeError(b,".syncBarrier() failed!"),o!==void 0&&o.release(),r(b)})})},Object.defineProperty(C.prototype,"type",{get:function(){return this.type_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"device",{get:function(){return this.device_},enumerable:!1,configurable:!0}),C}(w.ProxyObject);e.HidConnectionEventInternal=F;var H=function(){function U(C,i,s,r){this.device_=C,this.reportId_=i,this.data_=s,this.type_=r}return Object.defineProperty(U.prototype,"type",{get:function(){return this.type_},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"device",{get:function(){return this.device_},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"reportId",{get:function(){return this.reportId_},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"data",{get:function(){return this.data_},enumerable:!1,configurable:!0}),U}();e.HidInputReportEvent=H;var L=function(U){function C(i,s,r){return i=U.call(this,i,c.class_id_t.WebHidInputReportEvent,s,w.ProxyMode.Remote)||this,i.type_=r,i}return j(C,U),C.prototype.syncBarrier=function(){var i=this;return new Promise(function(s,r){i.waitUntilConnected(i.user_friendly_id()+".syncBarrier").then(function(){return Promise.all([i.remoteInvoke(!1,c.method_id_WebHidInputReportEvent_t.device,{oid:0}),i.remoteInvoke(!1,c.method_id_WebHidInputReportEvent_t.reportId,0),i.remoteInvoke(!1,c.method_id_WebHidInputReportEvent_t.data,[])])}).then(function(o){var b;b=S(o.map(function(T){return i.param0(T)}),3),o=b[0],i.reportId_=b[1],b=new Uint8Array(b[2]),i.data_=E.Util.toDataView(b.buffer),o!=null&&o.is_null===!1?(i.device_=k.findDeviceByOId(o.oid),s(i)):r()}).catch(function(o){o=i.logRemoteInvokeError(o,".syncBarrier() failed!"),r(o)})})},Object.defineProperty(C.prototype,"type",{get:function(){return this.type_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"device",{get:function(){return this.device_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"reportId",{get:function(){return this.reportId_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"data",{get:function(){return this.data_},enumerable:!1,configurable:!0}),C.prototype.isValid=function(){return this.device!=null&&this.reportId!=null&&this.data!=null&&this.type!=null},C}(w.ProxyObject),z=function(U){function C(i,s){return U.call(this,i,c.class_id_t.WebHidCollectionsAddedEvent,s,w.ProxyMode.Remote)||this}return j(C,U),C.prototype.syncBarrier=function(){var i=this;return new Promise(function(s,r){i.waitUntilConnected(i.user_friendly_id()+".syncBarrier").then(function(){return Promise.all([i.remoteInvoke(!1,c.method_id_WebHidCollectionsAddedEvent_t.device,{oid:0}),i.remoteInvoke(!1,c.method_id_WebHidCollectionsAddedEvent_t.collections,[])])}).then(function(o){var b;b=S(o.map(function(T){return i.param0(T)}),2),o=b[0],b=b[1],o!=null&&o.is_null===!1&&o.oid&&(i.device_=k.findDeviceByOId(o.oid)),i.collections_=b,s(i)}).catch(function(o){o=i.logRemoteInvokeError(o,".syncBarrier() failed!"),r(o)})})},Object.defineProperty(C.prototype,"device",{get:function(){return this.device_},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"collections",{get:function(){return this.collections_},enumerable:!1,configurable:!0}),C}(w.ProxyObject)},269:function(f,e){Object.defineProperty(e,"__esModule",{value:!0}),e.HardwareInfo=e.MemoryInfo=e.GPUInfo=e.GPU=e.CPUInfo=e.WebrpcClassLibInfo=e.WebrpcClassInfo=e.WebrpcMethodInfo=e.EndpointId=e.OSInfo=e.WebrpcFeatureInfo=e.FeatureData=e.VersionData=e.FEATURE_unsupported=e.FEATURE_ms_teams_redirection=void 0,e.FEATURE_ms_teams_redirection="ms_teams_redirection",e.FEATURE_unsupported="unsupported";var p=function(){return function(V,j,A,S){this.major=V,this.minor=j,this.revision=A,this.build=S}}();e.VersionData=p,p=function(){return function(){}}(),e.FeatureData=p,p=function(){return function(V,j){this.fature=V,this.version=j}}(),e.WebrpcFeatureInfo=p,p=function(){return function(V,j,A,S,c){this.family=V,this.version=j,this.architecture=A,this.distro=S,this.edition=c}}(),e.OSInfo=p,p=function(){return function(V,j){this.machine_id=V,this.user_id=j}}(),e.EndpointId=p,p=function(){return function(V,j,A,S,c){c===void 0&&(c=e.FEATURE_ms_teams_redirection),this.iid=V,this.mid=j,this.name=A,this.isprop=S,this.feature=c}}(),e.WebrpcMethodInfo=p,p=function(){return function(V,j,A){this.id=V,this.name=j,this.methods=A}}(),e.WebrpcClassInfo=p,p=function(){return function(V,j){this.name=V,this.classes=j}}(),e.WebrpcClassLibInfo=p,p=function(){return function(V,j){this.cpumodel=V,this.numberofprocessors=j}}(),e.CPUInfo=p,p=function(){return function(V,j){this.name=V,this.driver=j}}(),e.GPU=p,p=function(){return function(V){this.gpus=V}}(),e.GPUInfo=p,p=function(){return function(V){this.totalmemory=V}}(),e.MemoryInfo=p,p=function(){return function(V,j,A){this.cpu_info=V,this.gpu_info=j,this.memory_info=A}}(),e.HardwareInfo=p},550:function(f,e,p){var V=this&&this.__createBinding||(Object.create?function(S,c,w,E){E===void 0&&(E=w),Object.defineProperty(S,E,{enumerable:!0,get:function(){return c[w]}})}:function(S,c,w,E){E===void 0&&(E=w),S[E]=c[w]});f=this&&this.__exportStar||function(S,c){for(var w in S)w==="default"||c.hasOwnProperty(w)||V(c,S,w)};var j=this&&this.__values||function(S){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var c=typeof Symbol=="function"&&Symbol.iterator,w=c&&S[c],E=0;if(w)return w.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&E>=S.length&&(S=void 0),{value:S&&S[E++],done:!S}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.WebrpcClassLibInfoUtil=void 0;var A=p(187);f(p(187),e),p=function(){function S(){}return S.getInterfaceByid=function(c){var w,E;try{for(var R=j(A.class_lib_info.classes),_=R.next();!_.done;_=R.next()){var m=_.value;if(m.id==c)return m}}catch(l){w={error:l}}finally{try{_&&!_.done&&(E=R.return)&&E.call(R)}finally{if(w)throw w.error}}return null},S.getMethodByid=function(c,w){var E,R,_=this.getInterfaceByid(c);if(_!=null)try{for(var m=j(_.methods),l=m.next();!l.done;l=m.next()){var t=l.value;if(t.mid==w)return t}}catch(u){E={error:u}}finally{try{l&&!l.done&&(R=m.return)&&R.call(m)}finally{if(E)throw E.error}}return null},S.getMethodFeatureByid=function(c,w){var E,R,_=this.getInterfaceByid(c);if(_!=null)try{for(var m=j(_.methods),l=m.next();!l.done;l=m.next()){var t=l.value;if(t.mid==w)return t.feature}}catch(u){E={error:u}}finally{try{l&&!l.done&&(R=m.return)&&R.call(m)}finally{if(E)throw E.error}}return null},S.composeClassInfoData=function(c){var w,E,R,_;if(c=c.hdr,c==null)return"*** Invalid packet: Couldn't find hdr object ***";var m=c.proc;if(m==null)return"";c=m.iid,m=m.methodid;try{for(var l=j(A.class_lib_info.classes),t=l.next();!t.done;t=l.next()){var u=t.value;if(u.id==c)try{for(var h=(R=void 0,j(u.methods)),g=h.next();!g.done;g=h.next()){var y=g.value;if(y.mid==m)return u.name+"::"+y.name}}catch(a){R={error:a}}finally{try{g&&!g.done&&(_=h.return)&&_.call(h)}finally{if(R)throw R.error}}}}catch(a){w={error:a}}finally{try{t&&!t.done&&(E=l.return)&&E.call(l)}finally{if(w)throw w.error}}return""},S}(),e.WebrpcClassLibInfoUtil=p},187:function(f,e,p){Object.defineProperty(e,"__esModule",{value:!0}),e.class_lib_info=e.method_id_WebHidCollectionsAddedEvent_t=e.method_id_WebHidInputReportEvent_t=e.method_id_WebHidConnectionEvent_t=e.method_id_WebHidDevice_t=e.method_id_WebHidInterface_t=e.method_id_MediaStreamAudioDestinationNode_t=e.method_id_MediaStreamAudioSourceNode_t=e.method_id_AudioNode_t=e.method_id_AudioContext_t=e.mehtod_id_VideoEffect_t=e.method_id_StreamResolution_t=e.method_id_RTCSctpTransport_t=e.method_id_RTCDataChannel_t=e.method_id_E911Service_t=e.method_id_ScreenSource_t=e.method_id_VDISharingRemote_t=e.method_id_RTCRtpTransceiver_t=e.method_id_RTCIceCandidatePair_t=e.method_id_RTCDTMFToneChangeEvent_t=e.method_id_RTCDTMFSender_t=e.method_id_RTCIceTransport_t=e.method_id_RTCDtlsTransport_t=e.method_id_RTCRtpSender_t=e.method_id_RTCRtpReceiver_t=e.method_id_AudioElement_t=e.method_id_VideoElement_t=e.method_id_MediaStreamEvent_t=e.method_id_RTCIceCandidateEvent_t=e.method_id_RTCIceCandidate_t=e.method_id_NavigatorUserMedia_t=e.method_id_MediaStream_t=e.method_id_MediaStreamTrack_t=e.method_id_RTCSessionDescription_t=e.method_id_MediaDeviceInfo_t=e.method_id_MediaDevices_t=e.method_id_RTCPeerConnection_t=e.method_id_EngineControl_t=e.class_id_t=e.vdaFeatureNameMap=e.featureNameMap=e.Features=e.FEATURE_ms_teams_sender_stats_fix=e.FEATURE_ms_teams_webhid=e.FEATURE_ms_teams_enumerate_devices_v2=e.FEATURE_ms_teams_track_clone_with_id=e.FEATURE_ms_teams_audio_notifications_loop=e.FEATURE_ms_teams_share_system_audio=e.FEATURE_ms_teams_stream_active_status=e.FEATURE_ms_teams_hardware_info=e.FEATURE_ms_teams_secondary_audio_notifications=e.FEATURE_ms_teams_stream_resolution=e.FEATURE_ms_teams_client_info=e.FEATURE_ms_teams_no_vd_buffer_limit=e.FEATURE_ms_teams_data_channel=e.FEATURE_ms_teams_webrtc_1dot0=e.FEATURE_ms_teams_multi_window=e.FEATURE_ms_teams_gtc=e.FEATURE_ms_teams_e911=e.FEATURE_ms_teams_codec_capability=e.FEATURE_ms_teams_app_sharing=e.FEATURE_ms_teams_monitor_sharing=e.FEATURE_ms_teams_video_placement=e.FEATURE_ms_teams_dtmf=e.FEATURE_ms_teams_device_group_id=e.FEATURE_ms_teams_remote_audio_notifications=e.FEATURE_ms_teams_endpoint_id=e.FEATURE_ms_teams_osinfo=e.FEATURE_ms_teams_mstrack_constraints=e.FEATURE_ms_teams_1912=e.FEATURE_ms_teams_pstn=e.FEATURE_ms_teams_1911=e.FEATURE_ms_teams_common_media_constraints=e.FEATURE_ms_teams_speaking_indicator=e.FEATURE_ms_teams_desktop_sharing=e.FEATURE_vda_delete_viewport=e.FEATURE_vda_multi_window=e.FEATURE_vda_app_sharing=e.FEATURE_vda_service_no_buffer_limit=e.HDXMS_VERSION=e.BUILD_TYPE_SDK=void 0,f=p(269);var V=p(269);Object.defineProperty(e,"VersionData",{enumerable:!0,get:function(){return V.VersionData}}),Object.defineProperty(e,"FeatureData",{enumerable:!0,get:function(){return V.FeatureData}}),Object.defineProperty(e,"OSInfo",{enumerable:!0,get:function(){return V.OSInfo}}),Object.defineProperty(e,"EndpointId",{enumerable:!0,get:function(){return V.EndpointId}}),Object.defineProperty(e,"HardwareInfo",{enumerable:!0,get:function(){return V.HardwareInfo}}),e.BUILD_TYPE_SDK=!0,e.HDXMS_VERSION="4.0.2",e.FEATURE_vda_service_no_buffer_limit="wsservice_no_buffer_limit",e.FEATURE_vda_app_sharing="webrtc_app_sharing",e.FEATURE_vda_multi_window="webrtc_multi_window",e.FEATURE_vda_delete_viewport="overlay_delete_viewport",e.FEATURE_ms_teams_desktop_sharing="ms_teams_desktop_sharing",e.FEATURE_ms_teams_speaking_indicator="ms_teams_speaking_indicator",e.FEATURE_ms_teams_common_media_constraints="ms_teams_common_media_constraints",e.FEATURE_ms_teams_1911="ms_teams_1911",e.FEATURE_ms_teams_pstn="ms_teams_pstn",e.FEATURE_ms_teams_1912="ms_teams_1912",e.FEATURE_ms_teams_mstrack_constraints="ms_teams_mstrack_constraints",e.FEATURE_ms_teams_osinfo="ms_teams_osinfo",e.FEATURE_ms_teams_endpoint_id="ms_teams_endpoint_id",e.FEATURE_ms_teams_remote_audio_notifications="ms_teams_remote_audio_notifications",e.FEATURE_ms_teams_device_group_id="ms_teams_device_group_id",e.FEATURE_ms_teams_dtmf="ms_teams_dtmf",e.FEATURE_ms_teams_video_placement="ms_teams_video_placement",e.FEATURE_ms_teams_monitor_sharing="ms_teams_multi_monitor_sharing",e.FEATURE_ms_teams_app_sharing="ms_teams_app_sharing",e.FEATURE_ms_teams_codec_capability="ms_teams_codec_capability",e.FEATURE_ms_teams_e911="ms_teams_e911",e.FEATURE_ms_teams_gtc="ms_teams_gtc",e.FEATURE_ms_teams_multi_window="ms_teams_multi_windows",e.FEATURE_ms_teams_webrtc_1dot0="ms_teams_webrtc_1.0",e.FEATURE_ms_teams_data_channel="ms_teams_data_channel",e.FEATURE_ms_teams_no_vd_buffer_limit="ms_teams_no_vd_buffer_limit",e.FEATURE_ms_teams_client_info="ms_teams_client_info",e.FEATURE_ms_teams_stream_resolution="ms_teams_stream_resolution",e.FEATURE_ms_teams_secondary_audio_notifications="ms_teams_secondary_audio_notifications",e.FEATURE_ms_teams_hardware_info="ms_teams_hardware_info",e.FEATURE_ms_teams_stream_active_status="ms_teams_stream_active_status",e.FEATURE_ms_teams_share_system_audio="ms_teams_share_system_audio",e.FEATURE_ms_teams_audio_notifications_loop="ms_teams_audio_notifications_loop",e.FEATURE_ms_teams_track_clone_with_id="ms_teams_track_clone_with_id",e.FEATURE_ms_teams_enumerate_devices_v2="ms_teams_enumerate_devices_v2",e.FEATURE_ms_teams_webhid="ms_teams_web_hid",e.FEATURE_ms_teams_sender_stats_fix="ms_teams_sender_stats_fix",new f.WebrpcFeatureInfo(f.FEATURE_ms_teams_redirection,new f.VersionData(1,1,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_desktop_sharing,new f.VersionData(1,2,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_speaking_indicator,new f.VersionData(1,2,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_common_media_constraints,new f.VersionData(1,4,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_1911,new f.VersionData(1,4,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_1912,new f.VersionData(1,5,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_mstrack_constraints,new f.VersionData(1,6,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_pstn,new f.VersionData(1,6,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_osinfo,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_endpoint_id,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_remote_audio_notifications,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_device_group_id,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_codec_capability,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_dtmf,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_video_placement,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_monitor_sharing,new f.VersionData(1,7,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_app_sharing,new f.VersionData(1,8,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_webrtc_1dot0,new f.VersionData(1,8,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_data_channel,new f.VersionData(1,8,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_e911,new f.VersionData(1,13,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_multi_window,new f.VersionData(1,14,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_client_info,new f.VersionData(1,19,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_stream_resolution,new f.VersionData(1,25,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_secondary_audio_notifications,new f.VersionData(1,21,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_hardware_info,new f.VersionData(1,35,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_stream_active_status,new f.VersionData(1,32,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_audio_notifications_loop,new f.VersionData(1,33,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_track_clone_with_id,new f.VersionData(1,33,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_enumerate_devices_v2,new f.VersionData(1,35,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_webhid,new f.VersionData(1,37,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_sender_stats_fix,new f.VersionData(1,36,0,0)),new f.WebrpcFeatureInfo(e.FEATURE_ms_teams_share_system_audio,new f.VersionData(1,37,0,0)),p=function(){function n(){}return n.FEATURE_public_screenshare="screenshare",n.FEATURE_public_redirection="redirection",n.FEATURE_public_speaking_indicator="speaking_indicator",n.FEATURE_public_pstn="pstn",n.FEATURE_public_osinfo="osinfo",n.FEATURE_public_endpoint_id="endpointid",n.FEATURE_public_remote_audio_notifications="remoteaudionotifications",n.FEATURE_public_device_group_id="compositedevices",n.FEATURE_public_dtmf="dtmf",n.FEATURE_public_monitor_sharing="multimonitorscreenshare",n.FEATURE_public_app_sharing="appshare",n.FEATURE_public_codec_capability="codec_capability",n.FEATURE_public_e911="e911",n.FEATURE_public_gtc="givecontrol",n.FEATURE_public_webrtc1dot0="webrtc1.0",n.FEATURE_public_data_channel="datachannel",n.FEATURE_public_vdnobuflimit="vdnobuflimit",n.FEATURE_public_multi_window="multiwindow",n.FEATURE_public_secondary_audio_notifications="secondaryringer",n.FEATURE_public_stream_resolution="streamresolution",n.FEATURE_public_track_clone_with_id="track_clone_with_id",n.FEATURE_public_webhid="webhid",n.FEATURE_public_sender_stats_fix="sender_stats_fix",n.FEATURE_public_audio_notification_loop="loop",n.FEATURE_public_share_system_audio="sharesystemaudio",n}(),e.Features=p,e.featureNameMap={},e.featureNameMap[p.FEATURE_public_screenshare]=[e.FEATURE_ms_teams_desktop_sharing],e.featureNameMap[p.FEATURE_public_redirection]=[f.FEATURE_ms_teams_redirection],e.featureNameMap[p.FEATURE_public_speaking_indicator]=[e.FEATURE_ms_teams_speaking_indicator],e.featureNameMap[p.FEATURE_public_pstn]=[e.FEATURE_ms_teams_pstn],e.featureNameMap[p.FEATURE_public_osinfo]=[e.FEATURE_ms_teams_osinfo],e.featureNameMap[p.FEATURE_public_endpoint_id]=[e.FEATURE_ms_teams_endpoint_id],e.featureNameMap[p.FEATURE_public_remote_audio_notifications]=[e.FEATURE_ms_teams_remote_audio_notifications,e.FEATURE_ms_teams_secondary_audio_notifications],e.featureNameMap[p.FEATURE_public_device_group_id]=[e.FEATURE_ms_teams_device_group_id],e.featureNameMap[p.FEATURE_public_dtmf]=[e.FEATURE_ms_teams_dtmf],e.featureNameMap[p.FEATURE_public_monitor_sharing]=[e.FEATURE_ms_teams_monitor_sharing],e.featureNameMap[p.FEATURE_public_app_sharing]=[e.FEATURE_ms_teams_app_sharing],e.featureNameMap[p.FEATURE_public_codec_capability]=[e.FEATURE_ms_teams_codec_capability],e.featureNameMap[p.FEATURE_public_e911]=[e.FEATURE_ms_teams_e911],e.featureNameMap[p.FEATURE_public_gtc]=[e.FEATURE_ms_teams_gtc],e.featureNameMap[p.FEATURE_public_webrtc1dot0]=[e.FEATURE_ms_teams_webrtc_1dot0],e.featureNameMap[p.FEATURE_public_multi_window]=[e.FEATURE_ms_teams_multi_window],e.featureNameMap[p.FEATURE_public_data_channel]=[e.FEATURE_ms_teams_data_channel],e.featureNameMap[p.FEATURE_public_vdnobuflimit]=[e.FEATURE_ms_teams_no_vd_buffer_limit],e.featureNameMap[p.FEATURE_public_secondary_audio_notifications]=[e.FEATURE_ms_teams_remote_audio_notifications,e.FEATURE_ms_teams_secondary_audio_notifications],e.featureNameMap[p.FEATURE_public_stream_resolution]=[e.FEATURE_ms_teams_stream_resolution],e.featureNameMap[p.FEATURE_public_track_clone_with_id]=[e.FEATURE_ms_teams_track_clone_with_id],e.featureNameMap[p.FEATURE_public_webhid]=[e.FEATURE_ms_teams_webhid],e.featureNameMap[p.FEATURE_public_sender_stats_fix]=[e.FEATURE_ms_teams_sender_stats_fix],e.featureNameMap[p.FEATURE_public_audio_notification_loop]=[e.FEATURE_ms_teams_audio_notifications_loop],e.featureNameMap[p.FEATURE_public_share_system_audio]=[e.FEATURE_ms_teams_share_system_audio],e.vdaFeatureNameMap={},e.vdaFeatureNameMap[p.FEATURE_public_multi_window]=[e.FEATURE_vda_multi_window],e.vdaFeatureNameMap[p.FEATURE_public_app_sharing]=[e.FEATURE_vda_app_sharing],function(n){n[n.EngineControl=0]="EngineControl",n[n.RTCPeerConnection=1]="RTCPeerConnection",n[n.RTCSessionDescription=2]="RTCSessionDescription",n[n.RTCIceCandidate=3]="RTCIceCandidate",n[n.RTCIceCandidateEvent=4]="RTCIceCandidateEvent",n[n.MediaDevices=5]="MediaDevices",n[n.MediaDeviceInfo=6]="MediaDeviceInfo",n[n.MediaStreamTrack=7]="MediaStreamTrack",n[n.MediaStreamEvent=8]="MediaStreamEvent",n[n.MediaStream=9]="MediaStream",n[n.NavigatorUserMedia=10]="NavigatorUserMedia",n[n.VideoElement=11]="VideoElement",n[n.AudioElement=12]="AudioElement",n[n.RTCRtpReceiver=13]="RTCRtpReceiver",n[n.RTCRtpSender=14]="RTCRtpSender",n[n.RTCDtlsTransport=15]="RTCDtlsTransport",n[n.RTCIceTransport=16]="RTCIceTransport",n[n.RTCDTMFSender=17]="RTCDTMFSender",n[n.RTCDTMFToneChangeEvent=18]="RTCDTMFToneChangeEvent",n[n.RTCIceCandidatePair=19]="RTCIceCandidatePair",n[n.RTCRtpTransceiver=20]="RTCRtpTransceiver",n[n.ScreenSharingRemote=21]="ScreenSharingRemote",n[n.ScreenSource=22]="ScreenSource",n[n.E911Service=23]="E911Service",n[n.reserved2=24]="reserved2",n[n.RTCDataChannel=25]="RTCDataChannel",n[n.RTCSctpTransport=26]="RTCSctpTransport",n[n.StreamResolution=27]="StreamResolution",n[n.VideoEffect=28]="VideoEffect",n[n.AudioContext=29]="AudioContext",n[n.MediaStreamAudioSourceNode=30]="MediaStreamAudioSourceNode",n[n.MediaStreamAudioDestinationNode=31]="MediaStreamAudioDestinationNode",n[n.AudioNode=32]="AudioNode",n[n.WebHidInterface=33]="WebHidInterface",n[n.WebHidDevice=34]="WebHidDevice",n[n.WebHidConnectionEvent=35]="WebHidConnectionEvent",n[n.WebHidInputReportEvent=36]="WebHidInputReportEvent",n[n.WebHidCollectionsAddedEvent=37]="WebHidCollectionsAddedEvent"}(p=e.class_id_t||(e.class_id_t={}));var j;(function(n){n[n.ctor=0]="ctor",n[n.version=1]="version",n[n.feature_flags=2]="feature_flags",n[n.version_info=3]="version_info",n[n.osinfo=4]="osinfo",n[n.endpoint_id=5]="endpoint_id",n[n.set_client_info=6]="set_client_info",n[n.hardware_info=7]="hardware_info"})(j=e.method_id_EngineControl_t||(e.method_id_EngineControl_t={}));var A;(function(n){n[n.ctor=0]="ctor",n[n.localDescription=1]="localDescription",n[n.remoteDescription=2]="remoteDescription",n[n.readyState=3]="readyState",n[n.iceState=4]="iceState",n[n.localStreams=5]="localStreams",n[n.remoteStreams=6]="remoteStreams",n[n.createOffer=7]="createOffer",n[n.createAnswer=8]="createAnswer",n[n.setLocalDescription=9]="setLocalDescription",n[n.setRemoteDescription=10]="setRemoteDescription",n[n.updateIce=11]="updateIce",n[n.addIceCandidate=12]="addIceCandidate",n[n.addStream=13]="addStream",n[n.removeStream=14]="removeStream",n[n.close=15]="close",n[n.iceConnectionState=16]="iceConnectionState",n[n.iceGatheringState=17]="iceGatheringState",n[n.signalingState=18]="signalingState",n[n.onaddstream=19]="onaddstream",n[n.onicecandidate=20]="onicecandidate",n[n.oniceconnectionstatechange=21]="oniceconnectionstatechange",n[n.onicegatheringstatechange=22]="onicegatheringstatechange",n[n.onsignalingstatechange=23]="onsignalingstatechange",n[n.onnegotiationneeded=24]="onnegotiationneeded",n[n.onremovestream=25]="onremovestream",n[n.getStats=26]="getStats",n[n.getReceivers=27]="getReceivers",n[n.getSenders=28]="getSenders",n[n.addTrack=29]="addTrack",n[n.removeTrack=30]="removeTrack",n[n.ontrack=31]="ontrack",n[n.setLocalDescription_v2=32]="setLocalDescription_v2",n[n.setRemoteDescription_v2=33]="setRemoteDescription_v2",n[n.addTransceiverWithTrack=34]="addTransceiverWithTrack",n[n.addTransceiverWithKind=35]="addTransceiverWithKind",n[n.getTransceivers=36]="getTransceivers",n[n.onconnectionstatechange=37]="onconnectionstatechange",n[n.sctp=38]="sctp",n[n.ondatachannel=39]="ondatachannel",n[n.createDataChannel=40]="createDataChannel",n[n.getStats_v2=41]="getStats_v2"})(A=e.method_id_RTCPeerConnection_t||(e.method_id_RTCPeerConnection_t={}));var S;(function(n){n[n.ctor=0]="ctor",n[n.enumerateDevices=1]="enumerateDevices",n[n.getDisplayMedia=2]="getDisplayMedia",n[n.ondevicechange=3]="ondevicechange",n[n.enumerateDevicesV2=4]="enumerateDevicesV2"})(S=e.method_id_MediaDevices_t||(e.method_id_MediaDevices_t={}));var c;(function(n){n[n.ctor=0]="ctor",n[n.deviceId=1]="deviceId",n[n.kind=2]="kind",n[n.label=3]="label",n[n.groupId=4]="groupId"})(c=e.method_id_MediaDeviceInfo_t||(e.method_id_MediaDeviceInfo_t={}));var w;(function(n){n[n.ctor=0]="ctor",n[n.type=1]="type",n[n.sdp=2]="sdp"})(w=e.method_id_RTCSessionDescription_t||(e.method_id_RTCSessionDescription_t={}));var E;(function(n){n[n.ctor=0]="ctor",n[n.kind=1]="kind",n[n.id=2]="id",n[n.label=3]="label",n[n.enabled=4]="enabled",n[n.muted=5]="muted",n[n.readyState=6]="readyState",n[n.onended=7]="onended",n[n.onmute=8]="onmute",n[n.onunmute=9]="onunmute",n[n.clone=10]="clone",n[n.stop=11]="stop",n[n.getCapabilities=12]="getCapabilities",n[n.getSettings=13]="getSettings",n[n.applyConstraints=14]="applyConstraints",n[n.getConstraints=15]="getConstraints"})(E=e.method_id_MediaStreamTrack_t||(e.method_id_MediaStreamTrack_t={}));var R;(function(n){n[n.ctor=0]="ctor",n[n.id=1]="id",n[n.getAudioTracks=2]="getAudioTracks",n[n.getVideoTracks=3]="getVideoTracks",n[n.getTracks=4]="getTracks",n[n.getTrackById=5]="getTrackById",n[n.addTrack=6]="addTrack",n[n.removeTrack=7]="removeTrack",n[n.clone=8]="clone",n[n.active=9]="active"})(R=e.method_id_MediaStream_t||(e.method_id_MediaStream_t={}));var _;(function(n){n[n.ctor=0]="ctor",n[n.getUserMedia=1]="getUserMedia",n[n.setCodecCapabilities=2]="setCodecCapabilities",n[n.getCapabilities=3]="getCapabilities"})(_=e.method_id_NavigatorUserMedia_t||(e.method_id_NavigatorUserMedia_t={}));var m;(function(n){n[n.ctor=0]="ctor",n[n.candidate=1]="candidate",n[n.sdpMid=2]="sdpMid",n[n.sdpMLineIndex=3]="sdpMLineIndex"})(m=e.method_id_RTCIceCandidate_t||(e.method_id_RTCIceCandidate_t={}));var l;(function(n){n[n.ctor=0]="ctor",n[n.candidate=1]="candidate"})(l=e.method_id_RTCIceCandidateEvent_t||(e.method_id_RTCIceCandidateEvent_t={}));var t;(function(n){n[n.ctor=0]="ctor",n[n.stream=1]="stream"})(t=e.method_id_MediaStreamEvent_t||(e.method_id_MediaStreamEvent_t={}));var u;(function(n){n[n.ctor=0]="ctor",n[n.sinkId=1]="sinkId",n[n.connectTo=2]="connectTo",n[n.disconnect=3]="disconnect",n[n.setFrame=4]="setFrame",n[n.addClipRect=5]="addClipRect",n[n.removeClipRect=6]="removeClipRect",n[n.onerror=7]="onerror",n[n.onvideoframechanged=8]="onvideoframechanged",n[n.placement=9]="placement"})(u=e.method_id_VideoElement_t||(e.method_id_VideoElement_t={}));var h;(function(n){n[n.ctor=0]="ctor",n[n.sinkId=1]="sinkId",n[n.srcObject=2]="srcObject",n[n.src=3]="src",n[n.play=4]="play",n[n.pause=5]="pause",n[n.loop=6]="loop"})(h=e.method_id_AudioElement_t||(e.method_id_AudioElement_t={}));var g;(function(n){n[n.ctor=0]="ctor",n[n.track=1]="track",n[n.getContributingSources=2]="getContributingSources",n[n.getSynchronizationSources=3]="getSynchronizationSources",n[n.transport=4]="transport",n[n.rtcpTransport=5]="rtcpTransport",n[n.getCapabilities=6]="getCapabilities",n[n.getParameters=7]="getParameters",n[n.getStats=8]="getStats",n[n.getCapabilities_v2=9]="getCapabilities_v2"})(g=e.method_id_RTCRtpReceiver_t||(e.method_id_RTCRtpReceiver_t={}));var y;(function(n){n[n.ctor=0]="ctor",n[n.track=1]="track",n[n.transport=2]="transport",n[n.rtcpTransport=3]="rtcpTransport",n[n.dtmf=4]="dtmf",n[n.getCapabilities=5]="getCapabilities",n[n.getParameters=6]="getParameters",n[n.setParameters=7]="setParameters",n[n.replaceTrack=8]="replaceTrack",n[n.getStats=9]="getStats",n[n.setStreams=10]="setStreams",n[n.getCapabilities_v2=11]="getCapabilities_v2"})(y=e.method_id_RTCRtpSender_t||(e.method_id_RTCRtpSender_t={}));var a;(function(n){n[n.ctor=0]="ctor",n[n.transport=1]="transport",n[n.state=2]="state",n[n.getRemoteCertificates=3]="getRemoteCertificates",n[n.onstatechange=4]="onstatechange",n[n.onerror=5]="onerror"})(a=e.method_id_RTCDtlsTransport_t||(e.method_id_RTCDtlsTransport_t={}));var v;(function(n){n[n.ctor=0]="ctor",n[n.role=1]="role",n[n.component=2]="component",n[n.state=3]="state",n[n.gatheringState=4]="gatheringState",n[n.localcandidates=5]="localcandidates",n[n.remotecandidates=6]="remotecandidates",n[n.onstatechange=7]="onstatechange",n[n.ongatheringstatechange=8]="ongatheringstatechange",n[n.onselectedcandidatepairchange=9]="onselectedcandidatepairchange"})(v=e.method_id_RTCIceTransport_t||(e.method_id_RTCIceTransport_t={}));var d;(function(n){n[n.ctor=0]="ctor",n[n.insertDTMF=1]="insertDTMF",n[n.ontonechange=2]="ontonechange",n[n.canInsertDTMF=3]="canInsertDTMF",n[n.toneBuffer=4]="toneBuffer"})(d=e.method_id_RTCDTMFSender_t||(e.method_id_RTCDTMFSender_t={}));var I;(function(n){n[n.ctor=0]="ctor",n[n.tone=1]="tone",n[n.tone_buffer=2]="tone_buffer"})(I=e.method_id_RTCDTMFToneChangeEvent_t||(e.method_id_RTCDTMFToneChangeEvent_t={}));var k;(function(n){n[n.ctor=0]="ctor",n[n.local=1]="local",n[n.remote=2]="remote"})(k=e.method_id_RTCIceCandidatePair_t||(e.method_id_RTCIceCandidatePair_t={}));var D;(function(n){n[n.ctor=0]="ctor",n[n.mid=1]="mid",n[n.sender=2]="sender",n[n.receiver=3]="receiver",n[n.direction=4]="direction",n[n.currentDirection=5]="currentDirection",n[n.stop=6]="stop",n[n.setCodecPreferences=7]="setCodecPreferences"})(D=e.method_id_RTCRtpTransceiver_t||(e.method_id_RTCRtpTransceiver_t={}));var F;(function(n){n[n.ctor=0]="ctor",n[n.getScreensAsync=1]="getScreensAsync",n[n.onscreentopologychanged=2]="onscreentopologychanged"})(F=e.method_id_VDISharingRemote_t||(e.method_id_VDISharingRemote_t={}));var H;(function(n){n[n.ctor=0]="ctor",n[n.srcid=1]="srcid",n[n.deviceid=2]="deviceid",n[n.type=3]="type",n[n.name=4]="name",n[n.imagedata=5]="imagedata",n[n.hwnd=6]="hwnd",n[n.origin=7]="origin",n[n.caption=8]="caption",n[n.pid=9]="pid",n[n.bounds=10]="bounds"})(H=e.method_id_ScreenSource_t||(e.method_id_ScreenSource_t={}));var L;(function(n){n[n.ctor=0]="ctor",n[n.getE911Info=1]="getE911Info",n[n.onupdate=2]="onupdate"})(L=e.method_id_E911Service_t||(e.method_id_E911Service_t={}));var z;(function(n){n[n.ctor=0]="ctor",n[n.label=1]="label",n[n.ordered=2]="ordered",n[n.maxPacketLifeTime=3]="maxPacketLifeTime",n[n.maxRetransmits=4]="maxRetransmits",n[n.protocol=5]="protocol",n[n.negotiated=6]="negotiated",n[n.id=7]="id",n[n.readyState=8]="readyState",n[n.bufferedAmount=9]="bufferedAmount",n[n.bufferedAmountLowThreshold=10]="bufferedAmountLowThreshold",n[n.onopen=11]="onopen",n[n.onbufferedamountlow=12]="onbufferedamountlow",n[n.onerror=13]="onerror",n[n.onclosing=14]="onclosing",n[n.onclose=15]="onclose",n[n.onmessage=16]="onmessage",n[n.close=17]="close",n[n.send_text=18]="send_text",n[n.send_binary=19]="send_binary"})(z=e.method_id_RTCDataChannel_t||(e.method_id_RTCDataChannel_t={}));var U;(function(n){n[n.ctor=0]="ctor",n[n.transport=1]="transport",n[n.state=2]="state",n[n.maxMessageSize=3]="maxMessageSize",n[n.maxChannels=4]="maxChannels",n[n.onstatechange=5]="onstatechange"})(U=e.method_id_RTCSctpTransport_t||(e.method_id_RTCSctpTransport_t={}));var C;(function(n){n[n.ctor=0]="ctor",n[n.getCallConstraints=1]="getCallConstraints",n[n.onupdate=2]="onupdate"})(C=e.method_id_StreamResolution_t||(e.method_id_StreamResolution_t={})),function(n){n[n.ctor=0]="ctor",n[n.sendMessageDeviceVideoEffectsAsync=1]="sendMessageDeviceVideoEffectsAsync",n[n.sendMessageDeviceVideoEffectsAsync_v2=2]="sendMessageDeviceVideoEffectsAsync_v2"}(e.mehtod_id_VideoEffect_t||(e.mehtod_id_VideoEffect_t={}));var i;(function(n){n[n.ctor=0]="ctor",n[n.sampleRate=1]="sampleRate",n[n.close=2]="close",n[n.createMediaStreamSource=3]="createMediaStreamSource",n[n.createMediaStreamDestination=4]="createMediaStreamDestination"})(i=e.method_id_AudioContext_t||(e.method_id_AudioContext_t={}));var s;(function(n){n[n.ctor=0]="ctor",n[n.connect=1]="connect",n[n.disconnectAll=2]="disconnectAll",n[n.disconnectOutput=3]="disconnectOutput",n[n.disconnectDestinationNode=4]="disconnectDestinationNode",n[n.disconnectOutputDestinationNode=5]="disconnectOutputDestinationNode",n[n.disconnect=6]="disconnect",n[n.numberOfInputs=7]="numberOfInputs",n[n.numberOfOutputs=8]="numberOfOutputs",n[n.channelCount=9]="channelCount"})(s=e.method_id_AudioNode_t||(e.method_id_AudioNode_t={}));var r;(function(n){n[n.ctor=0]="ctor",n[n.mediaStream=1]="mediaStream"})(r=e.method_id_MediaStreamAudioSourceNode_t||(e.method_id_MediaStreamAudioSourceNode_t={}));var o;(function(n){n[n.ctor=0]="ctor",n[n.stream=1]="stream"})(o=e.method_id_MediaStreamAudioDestinationNode_t||(e.method_id_MediaStreamAudioDestinationNode_t={}));var b;(function(n){n[n.ctor=0]="ctor",n[n.onconnect=1]="onconnect",n[n.ondisconnect=2]="ondisconnect",n[n.getDevices=3]="getDevices",n[n.requestDevice=4]="requestDevice"})(b=e.method_id_WebHidInterface_t||(e.method_id_WebHidInterface_t={}));var T;(function(n){n[n.ctor=0]="ctor",n[n.opened=1]="opened",n[n.vendorId=2]="vendorId",n[n.productId=3]="productId",n[n.productName=4]="productName",n[n.collections=5]="collections",n[n.oninputreport=6]="oninputreport",n[n.open=7]="open",n[n.close=8]="close",n[n.forget=9]="forget",n[n.sendReport=10]="sendReport",n[n.sendFeatureReport=11]="sendFeatureReport",n[n.receiveFeatureReport=12]="receiveFeatureReport",n[n.compositeId=13]="compositeId",n[n.onCollectionsAdded=14]="onCollectionsAdded"})(T=e.method_id_WebHidDevice_t||(e.method_id_WebHidDevice_t={}));var O;(function(n){n[n.ctor=0]="ctor",n[n.device=1]="device"})(O=e.method_id_WebHidConnectionEvent_t||(e.method_id_WebHidConnectionEvent_t={}));var x;(function(n){n[n.ctor=0]="ctor",n[n.device=1]="device",n[n.reportId=2]="reportId",n[n.data=3]="data"})(x=e.method_id_WebHidInputReportEvent_t||(e.method_id_WebHidInputReportEvent_t={}));var N;(function(n){n[n.ctor=0]="ctor",n[n.device=1]="device",n[n.collections=2]="collections"})(N=e.method_id_WebHidCollectionsAddedEvent_t||(e.method_id_WebHidCollectionsAddedEvent_t={})),e.class_lib_info=new f.WebrpcClassLibInfo("webrpc_class_library",[new f.WebrpcClassInfo(p.EngineControl,"EngineControl",[new f.WebrpcMethodInfo(p.EngineControl,j.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.EngineControl,j.version,"version",!0),new f.WebrpcMethodInfo(p.EngineControl,j.feature_flags,"feature_flags",!0),new f.WebrpcMethodInfo(p.EngineControl,j.version_info,"version_info",!0,e.FEATURE_ms_teams_desktop_sharing),new f.WebrpcMethodInfo(p.EngineControl,j.osinfo,"osinfo",!0,e.FEATURE_ms_teams_osinfo),new f.WebrpcMethodInfo(p.EngineControl,j.endpoint_id,"endpoint_id",!0,e.FEATURE_ms_teams_endpoint_id),new f.WebrpcMethodInfo(p.EngineControl,j.set_client_info,"set_client_info",!1,e.FEATURE_ms_teams_client_info),new f.WebrpcMethodInfo(p.EngineControl,j.hardware_info,"hardware_info",!0,e.FEATURE_ms_teams_hardware_info)]),new f.WebrpcClassInfo(p.RTCPeerConnection,"RTCPeerConnection",[new f.WebrpcMethodInfo(p.RTCPeerConnection,A.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.localDescription,"localDescription",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.remoteDescription,"remoteDescription",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.readyState,"readyState",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.iceState,"iceState",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.localStreams,"localStreams",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.remoteStreams,"remoteStreams",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.createOffer,"createOffer",!1),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.createAnswer,"createAnswer",!1),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.setLocalDescription,"setLocalDescription",!1),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.setRemoteDescription,"setRemoteDescription",!1),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.updateIce,"updateIce",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.addIceCandidate,"addIceCandidate",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.addStream,"addStream",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.removeStream,"removeStream",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.close,"close",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.iceConnectionState,"iceConnectionState",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.iceGatheringState,"iceGatheringState",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.signalingState,"signalingState",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.onaddstream,"onaddstream",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.onicecandidate,"onicecandidate",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.oniceconnectionstatechange,"oniceconnectionstatechange",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.onicegatheringstatechange,"onicegatheringstatechange",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.onsignalingstatechange,"onsignalingstatechange",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.onnegotiationneeded,"onnegotiationneeded",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.onremovestream,"onremovestream",!0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.getStats,"getStats",!1),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.getReceivers,"getReceivers",!1,e.FEATURE_ms_teams_speaking_indicator),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.getSenders,"getSenders",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.addTrack,"addTrack",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.removeTrack,"removeTrack",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.ontrack,"ontrack",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.setLocalDescription_v2,"setLocalDescription_v2",!1,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.setRemoteDescription_v2,"setRemoteDescription_v2",!1,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.addTransceiverWithTrack,"addTransceiverWithTrack",!1,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.addTransceiverWithKind,"addTransceiverWithKind",!1,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.getTransceivers,"getTransceivers",!1,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.onconnectionstatechange,"onconnectionstatechange",!0,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.sctp,"sctp",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.ondatachannel,"ondatachannel",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.createDataChannel,"createDataChannel",!1,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCPeerConnection,A.getStats_v2,"getStats_v2",!1,e.FEATURE_ms_teams_webrtc_1dot0)]),new f.WebrpcClassInfo(p.RTCSessionDescription,"RTCSessionDescription",[new f.WebrpcMethodInfo(p.RTCSessionDescription,w.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.RTCSessionDescription,w.type,"type",!0),new f.WebrpcMethodInfo(p.RTCSessionDescription,w.sdp,"sdp",!0)]),new f.WebrpcClassInfo(p.RTCIceCandidate,"RTCIceCandidate",[new f.WebrpcMethodInfo(p.RTCIceCandidate,m.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.RTCIceCandidate,m.candidate,"candidate",!0),new f.WebrpcMethodInfo(p.RTCIceCandidate,m.sdpMid,"sdpMid",!0),new f.WebrpcMethodInfo(p.RTCIceCandidate,m.sdpMLineIndex,"sdpMLineIndex",!0)]),new f.WebrpcClassInfo(p.RTCIceCandidateEvent,"RTCIceCandidateEvent",[new f.WebrpcMethodInfo(p.RTCIceCandidateEvent,l.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.RTCIceCandidateEvent,l.candidate,"candidate",!0)]),new f.WebrpcClassInfo(p.MediaDevices,"MediaDevices",[new f.WebrpcMethodInfo(p.MediaDevices,S.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.MediaDevices,S.enumerateDevices,"enumerateDevices",!1),new f.WebrpcMethodInfo(p.MediaDevices,S.getDisplayMedia,"getDisplayMedia",!1,e.FEATURE_ms_teams_desktop_sharing),new f.WebrpcMethodInfo(p.MediaDevices,S.ondevicechange,"ondevicechange",!0,e.FEATURE_ms_teams_speaking_indicator),new f.WebrpcMethodInfo(p.MediaDevices,S.enumerateDevicesV2,"enuerateDevicesV2",!1,e.FEATURE_ms_teams_enumerate_devices_v2)]),new f.WebrpcClassInfo(p.MediaDeviceInfo,"MediaDeviceInfo",[new f.WebrpcMethodInfo(p.MediaDeviceInfo,c.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.MediaDeviceInfo,c.deviceId,"deviceId",!0),new f.WebrpcMethodInfo(p.MediaDeviceInfo,c.kind,"kind",!0),new f.WebrpcMethodInfo(p.MediaDeviceInfo,c.label,"label",!0),new f.WebrpcMethodInfo(p.MediaDeviceInfo,c.groupId,"groupId",!0)]),new f.WebrpcClassInfo(p.MediaStreamTrack,"MediaStreamTrack",[new f.WebrpcMethodInfo(p.MediaStreamTrack,E.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.clone,"clone",!1),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.stop,"stop",!1),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.getCapabilities,"getCapabilities",!1),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.getSettings,"getSettings",!1),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.applyConstraints,"applyConstraints",!1,e.FEATURE_ms_teams_desktop_sharing),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.kind,"kind",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.id,"id",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.label,"label",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.enabled,"enabled",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.muted,"muted",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.readyState,"readyState",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.onended,"onended",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.onmute,"onmute",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.onunmute,"onunmute",!0),new f.WebrpcMethodInfo(p.MediaStreamTrack,E.getConstraints,"getConstraints",!1,e.FEATURE_ms_teams_mstrack_constraints)]),new f.WebrpcClassInfo(p.MediaStream,"MediaStream",[new f.WebrpcMethodInfo(p.MediaStream,R.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.MediaStream,R.id,"id",!0),new f.WebrpcMethodInfo(p.MediaStream,R.getAudioTracks,"getAudioTracks",!1),new f.WebrpcMethodInfo(p.MediaStream,R.getVideoTracks,"getVideoTracks",!1),new f.WebrpcMethodInfo(p.MediaStream,R.getTracks,"getTracks",!1),new f.WebrpcMethodInfo(p.MediaStream,R.getTrackById,"getTrackById",!1),new f.WebrpcMethodInfo(p.MediaStream,R.addTrack,"addTrack",!1),new f.WebrpcMethodInfo(p.MediaStream,R.removeTrack,"removeTrack",!1),new f.WebrpcMethodInfo(p.MediaStream,R.clone,"clone",!0),new f.WebrpcMethodInfo(p.MediaStream,R.active,"active",!0)]),new f.WebrpcClassInfo(p.NavigatorUserMedia,"NavigatorUserMedia",[new f.WebrpcMethodInfo(p.NavigatorUserMedia,_.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.NavigatorUserMedia,_.getUserMedia,"getUserMedia",!1),new f.WebrpcMethodInfo(p.NavigatorUserMedia,_.setCodecCapabilities,"setCodecCapabilities",!1,e.FEATURE_ms_teams_codec_capability),new f.WebrpcMethodInfo(p.NavigatorUserMedia,_.getCapabilities,"getRtpCapabilities",!1,e.FEATURE_ms_teams_webrtc_1dot0)]),new f.WebrpcClassInfo(p.MediaStreamEvent,"MediaStreamEvent",[new f.WebrpcMethodInfo(p.MediaStreamEvent,t.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.MediaStreamEvent,t.stream,"stream",!0)]),new f.WebrpcClassInfo(p.VideoElement,"VideoElement",[new f.WebrpcMethodInfo(p.VideoElement,u.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.VideoElement,u.sinkId,"sinkId",!0),new f.WebrpcMethodInfo(p.VideoElement,u.connectTo,"connectTo",!1),new f.WebrpcMethodInfo(p.VideoElement,u.disconnect,"disconnect",!1),new f.WebrpcMethodInfo(p.VideoElement,u.setFrame,"setFrame",!1),new f.WebrpcMethodInfo(p.VideoElement,u.addClipRect,"addClipRect",!1),new f.WebrpcMethodInfo(p.VideoElement,u.removeClipRect,"removeClipRect",!1),new f.WebrpcMethodInfo(p.VideoElement,u.onerror,"onerror",!0),new f.WebrpcMethodInfo(p.VideoElement,u.onvideoframechanged,"onvideoframechanged",!0),new f.WebrpcMethodInfo(p.VideoElement,u.placement,"placement",!0,e.FEATURE_ms_teams_video_placement)]),new f.WebrpcClassInfo(p.AudioElement,"AudioElement",[new f.WebrpcMethodInfo(p.AudioElement,h.ctor,"ctor",!1),new f.WebrpcMethodInfo(p.AudioElement,h.sinkId,"sinkId",!0),new f.WebrpcMethodInfo(p.AudioElement,h.srcObject,"srcObject",!0),new f.WebrpcMethodInfo(p.AudioElement,h.src,"src",!0),new f.WebrpcMethodInfo(p.AudioElement,h.play,"play",!1),new f.WebrpcMethodInfo(p.AudioElement,h.pause,"pause",!1),new f.WebrpcMethodInfo(p.AudioElement,h.loop,"loop",!0,e.FEATURE_ms_teams_audio_notifications_loop)]),new f.WebrpcClassInfo(p.RTCRtpReceiver,"RTCRtpReceiver",[new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.ctor,"ctor",!1,e.FEATURE_ms_teams_speaking_indicator),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.track,"track",!0,e.FEATURE_ms_teams_speaking_indicator),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.getContributingSources,"getContributingSources",!1,e.FEATURE_ms_teams_speaking_indicator),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.getSynchronizationSources,"getSynchronizationSources",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.transport,"transport",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.rtcpTransport,"rtcptransport",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.getCapabilities,"getCapabilities",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.getParameters,"getParameters",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.getStats,"getStats",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpReceiver,g.getCapabilities_v2,"getCapabilities_v2",!1,e.FEATURE_ms_teams_webrtc_1dot0)]),new f.WebrpcClassInfo(p.RTCRtpSender,"RTCRtpSender",[new f.WebrpcMethodInfo(p.RTCRtpSender,y.ctor,"ctor",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.track,"track",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.transport,"transport",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.rtcpTransport,"rtcpTransport",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.dtmf,"dtmf",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.getCapabilities,"getCapabilities",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.getParameters,"getParameters",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.setParameters,"setParameters",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.replaceTrack,"replaceTrack",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.getStats,"getStats",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.setStreams,"setStreams",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCRtpSender,y.getCapabilities_v2,"getCapabilities_v2",!1,e.FEATURE_ms_teams_webrtc_1dot0)]),new f.WebrpcClassInfo(p.RTCDtlsTransport,"RTCDtlsTransport",[new f.WebrpcMethodInfo(p.RTCDtlsTransport,a.ctor,"ctor",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDtlsTransport,a.transport,"transport",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDtlsTransport,a.state,"state",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDtlsTransport,a.getRemoteCertificates,"getRemoteCertificates",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDtlsTransport,a.onstatechange,"onstatechange",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDtlsTransport,a.onerror,"onerror",!0,e.FEATURE_ms_teams_pstn)]),new f.WebrpcClassInfo(p.RTCIceTransport,"RTCIceTransport",[new f.WebrpcMethodInfo(p.RTCIceTransport,v.ctor,"ctor",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.role,"role",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.component,"component",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.state,"state",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.gatheringState,"gatheringState",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.localcandidates,"localcandidates",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.remotecandidates,"remotecandidates",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.onstatechange,"onstatechange",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.ongatheringstatechange,"ongatheringstatechange",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceTransport,v.onselectedcandidatepairchange,"onselectedcandidatepairchange",!0,e.FEATURE_ms_teams_pstn)]),new f.WebrpcClassInfo(p.RTCDTMFSender,"RTCDTMFSender",[new f.WebrpcMethodInfo(p.RTCDTMFSender,d.ctor,"ctor",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDTMFSender,d.insertDTMF,"insertDTMF",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDTMFSender,d.ontonechange,"ontonechange",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDTMFSender,d.canInsertDTMF,"canInsertDTMF",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDTMFSender,d.toneBuffer,"toneBuffer",!0,e.FEATURE_ms_teams_pstn)]),new f.WebrpcClassInfo(p.RTCDTMFToneChangeEvent,"RTCDTMFToneChangeEvent",[new f.WebrpcMethodInfo(p.RTCDTMFToneChangeEvent,I.ctor,"ctor",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDTMFToneChangeEvent,I.tone,"tone",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCDTMFToneChangeEvent,I.tone_buffer,"tone_buffer",!0,e.FEATURE_ms_teams_pstn)]),new f.WebrpcClassInfo(p.RTCIceCandidatePair,"RTCIceCandidatePair",[new f.WebrpcMethodInfo(p.RTCIceCandidatePair,k.ctor,"ctor",!1,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceCandidatePair,k.local,"local",!0,e.FEATURE_ms_teams_pstn),new f.WebrpcMethodInfo(p.RTCIceCandidatePair,k.remote,"remote",!0,e.FEATURE_ms_teams_pstn)]),new f.WebrpcClassInfo(p.RTCRtpTransceiver,"RTCRtpTransceiver",[new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.ctor,"ctor",!1,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.mid,"mid",!0,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.sender,"sender",!0,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.receiver,"receiver",!0,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.direction,"direction",!0,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.currentDirection,"currentDirection",!0,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.stop,"stop",!1,e.FEATURE_ms_teams_webrtc_1dot0),new f.WebrpcMethodInfo(p.RTCRtpTransceiver,D.setCodecPreferences,"setCodecPreferences",!1,e.FEATURE_ms_teams_webrtc_1dot0)]),new f.WebrpcClassInfo(p.ScreenSharingRemote,"ScreenSharingRemote",[new f.WebrpcMethodInfo(p.ScreenSharingRemote,F.ctor,"ctor",!1,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSharingRemote,F.getScreensAsync,"getScreensAsync",!1,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSharingRemote,F.onscreentopologychanged,"onscreentopologychanged",!0,e.FEATURE_ms_teams_monitor_sharing)]),new f.WebrpcClassInfo(p.ScreenSource,"ScreenSource",[new f.WebrpcMethodInfo(p.ScreenSource,H.ctor,"ctor",!1,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.srcid,"srcid",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.deviceid,"deviceid",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.type,"type",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.name,"name",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.imagedata,"imagedata",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.hwnd,"hwnd",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.origin,"origin",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.caption,"caption",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.pid,"pid",!0,e.FEATURE_ms_teams_monitor_sharing),new f.WebrpcMethodInfo(p.ScreenSource,H.bounds,"bounds",!0,e.FEATURE_ms_teams_gtc)]),new f.WebrpcClassInfo(p.E911Service,"E911Service",[new f.WebrpcMethodInfo(p.E911Service,L.ctor,"ctor",!1,e.FEATURE_ms_teams_e911),new f.WebrpcMethodInfo(p.E911Service,L.getE911Info,"getE911Info",!1,e.FEATURE_ms_teams_e911),new f.WebrpcMethodInfo(p.E911Service,L.onupdate,"onupdate",!0,e.FEATURE_ms_teams_e911)]),new f.WebrpcClassInfo(p.RTCDataChannel,"RTCDataChannel",[new f.WebrpcMethodInfo(p.RTCDataChannel,z.ctor,"ctor",!1,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.label,"label",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.ordered,"ordered",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.maxPacketLifeTime,"maxPacketLifeTime",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.maxRetransmits,"maxRetransmits",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.protocol,"protocol",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.negotiated,"negotiated",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.id,"id",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.readyState,"readyState",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.bufferedAmount,"bufferedAmount",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.bufferedAmountLowThreshold,"bufferedAmountLowThreshold",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.onopen,"onopen",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.onbufferedamountlow,"onbufferedamountlow",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.onerror,"onerror",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.onclosing,"onclosing",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.onclose,"onclose",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.onmessage,"onmessage",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.close,"close",!1,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.send_text,"send_text",!1,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCDataChannel,z.send_binary,"send_binary",!1,e.FEATURE_ms_teams_data_channel)]),new f.WebrpcClassInfo(p.RTCSctpTransport,"RTCSctpTransport",[new f.WebrpcMethodInfo(p.RTCSctpTransport,U.ctor,"ctor",!1,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCSctpTransport,U.transport,"transport",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCSctpTransport,U.state,"state",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCSctpTransport,U.maxMessageSize,"maxMessageSize",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCSctpTransport,U.maxChannels,"maxChannels",!0,e.FEATURE_ms_teams_data_channel),new f.WebrpcMethodInfo(p.RTCSctpTransport,U.onstatechange,"onstatechange",!0,e.FEATURE_ms_teams_data_channel)]),new f.WebrpcClassInfo(p.StreamResolution,"StreamResolution",[new f.WebrpcMethodInfo(p.StreamResolution,C.ctor,"ctor",!1,e.FEATURE_ms_teams_stream_resolution),new f.WebrpcMethodInfo(p.StreamResolution,C.getCallConstraints,"getCallConstraints",!1,e.FEATURE_ms_teams_stream_resolution),new f.WebrpcMethodInfo(p.StreamResolution,C.onupdate,"onupdate",!0,e.FEATURE_ms_teams_stream_resolution)]),new f.WebrpcClassInfo(p.AudioContext,"AudioContext",[new f.WebrpcMethodInfo(p.AudioContext,i.ctor,"ctor",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioContext,i.sampleRate,"sampleRate",!0,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioContext,i.close,"close",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioContext,i.createMediaStreamSource,"createMediaStreamSource",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioContext,i.createMediaStreamDestination,"createMediaStreamDestination",!1,e.FEATURE_ms_teams_share_system_audio)]),new f.WebrpcClassInfo(p.AudioNode,"AudioNode",[new f.WebrpcMethodInfo(p.AudioNode,s.ctor,"ctor",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.connect,"connect",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.disconnectAll,"disconnectAll",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.disconnectOutput,"disconnectOutput",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.disconnectDestinationNode,"disconnectDestinationNode",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.disconnectOutputDestinationNode,"disconnectDestinationNode",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.disconnect,"disconnect",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.numberOfInputs,"numberOfInputs",!0,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.numberOfOutputs,"numberOfOutputs",!0,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.AudioNode,s.channelCount,"channelCount",!0,e.FEATURE_ms_teams_share_system_audio)]),new f.WebrpcClassInfo(p.MediaStreamAudioSourceNode,"MediaStreamAudioSourceNode",[new f.WebrpcMethodInfo(p.MediaStreamAudioSourceNode,r.ctor,"ctor",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.MediaStreamAudioSourceNode,r.mediaStream,"mediaStream",!0,e.FEATURE_ms_teams_share_system_audio)]),new f.WebrpcClassInfo(p.MediaStreamAudioDestinationNode,"MediaStreamAudioDestinationNode",[new f.WebrpcMethodInfo(p.MediaStreamAudioDestinationNode,o.ctor,"ctor",!1,e.FEATURE_ms_teams_share_system_audio),new f.WebrpcMethodInfo(p.MediaStreamAudioDestinationNode,o.stream,"stream",!0,e.FEATURE_ms_teams_share_system_audio)]),new f.WebrpcClassInfo(p.WebHidInterface,"WebHidInterface",[new f.WebrpcMethodInfo(p.WebHidInterface,b.ctor,"ctor",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidInterface,b.onconnect,"onconnect",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidInterface,b.ondisconnect,"ondisconnect",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidInterface,b.getDevices,"getDevices",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidInterface,b.requestDevice,"requestDevice",!1,e.FEATURE_ms_teams_webhid)]),new f.WebrpcClassInfo(p.WebHidDevice,"WebHidDevice",[new f.WebrpcMethodInfo(p.WebHidDevice,T.ctor,"ctor",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.opened,"opened",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.vendorId,"vendorId",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.productId,"productId",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.productName,"productName",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.collections,"collections",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.oninputreport,"oninputreport",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.open,"open",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.close,"close",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.forget,"forget",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.sendReport,"sendReport",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.sendFeatureReport,"sendFeatureReport",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.receiveFeatureReport,"receiveFeatureReport",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.compositeId,"compositeId",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidDevice,T.onCollectionsAdded,"onCollectionsAdded",!0,e.FEATURE_ms_teams_webhid)]),new f.WebrpcClassInfo(p.WebHidConnectionEvent,"WebHidConnectionEvent",[new f.WebrpcMethodInfo(p.WebHidConnectionEvent,O.ctor,"ctor",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidConnectionEvent,O.device,"device",!0,e.FEATURE_ms_teams_webhid)]),new f.WebrpcClassInfo(p.WebHidInputReportEvent,"WebHidInputReportEvent",[new f.WebrpcMethodInfo(p.WebHidInputReportEvent,x.ctor,"ctor",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidInputReportEvent,x.device,"device",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidInputReportEvent,x.reportId,"reportId",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidInputReportEvent,x.data,"data",!0,e.FEATURE_ms_teams_webhid)]),new f.WebrpcClassInfo(p.WebHidCollectionsAddedEvent,"WebHidCollectionsAddedEvent",[new f.WebrpcMethodInfo(p.WebHidCollectionsAddedEvent,N.ctor,"ctor",!1,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidCollectionsAddedEvent,N.device,"device",!0,e.FEATURE_ms_teams_webhid),new f.WebrpcMethodInfo(p.WebHidCollectionsAddedEvent,N.collections,"collections",!0,e.FEATURE_ms_teams_webhid)])])},545:function(f,e,p){var V=this&&this.__read||function(c,w){P.initSymbol(),P.initSymbol(),P.initSymbolIterator();var E=typeof Symbol=="function"&&c[Symbol.iterator];if(!E)return c;var R=E.call(c),_,m=[],l;try{for(;(w===void 0||0<w--)&&!(_=R.next()).done;)m.push(_.value)}catch(t){l={error:t}}finally{try{_&&!_.done&&(E=R.return)&&E.call(R)}finally{if(l)throw l.error}}return m},j=this&&this.__spread||function(){for(var c=[],w=0;w<arguments.length;w++)c=c.concat(V(arguments[w]));return c};Object.defineProperty(e,"__esModule",{value:!0}),e.WsJsonUtil=e.ws_msg_type_t=void 0;var A=p(550),S;(function(c){c[c.req=0]="req",c[c.reply=1]="reply",c[c.event_req=2]="event_req",c[c.event_reply=3]="event_reply"})(S=e.ws_msg_type_t||(e.ws_msg_type_t={})),f=function(){function c(){}return c.createMessageByid=function(w,E,R,_,m,l){for(var t=[],u=6;u<arguments.length;u++)t[u-6]=arguments[u];return(u=A.WebrpcClassLibInfoUtil.getMethodByid(_,m))&&u.isprop||(w=!1),this.createMessage.apply(this,j([R,w,E,_,m,l],t))},c.createMessage=function(w,E,R,_,m,l){for(var t=[],u=6;u<arguments.length;u++)t[u-6]=arguments[u];return{v:"webrtc",hdr:{version:this._version,msg_type:this.getMsgType(w),modifier:E,destroy:R,proc:{iid:_,methodid:m}},objref:{oid:l},params:j(t)}},c.getMsgType=function(w){var E="";switch(w){default:E="req";break;case S.reply:E="reply";break;case S.event_req:E="event-req";break;case S.event_reply:E="event-reply"}return E},c._version=1,c}(),e.WsJsonUtil=f}},J={};return M(307)}()})}(_e)),_e.exports}ge();const ye=window.CitrixWebRTC;console.log("Citrix UCSdk loaded:",ye)});
